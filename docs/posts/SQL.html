<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-07-07">

<title>ThomasHSimm – sql</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//posts/Picture3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ThomasHSimm</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ThomasHSimm"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ThomasHSimm"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><p><img src="../posts/header2.png" height="200"></p>



<section id="basics-sql" class="level1">
<h1>Basics SQL</h1>
<blockquote class="blockquote">
<p>SQL basics</p>
</blockquote>
</section>
<section id="statements-and-syntax" class="level1">
<h1>Statements and syntax</h1>
<p>Analysis will use the data above- from the open source Chinook Database. This can be accessed via https://mode.com/sql-tutorial/introduction-to-sql/</p>
<p><img src="https://ucde-rey.s3.amazonaws.com/DSV1015/ChinookDatabaseSchema.png" class="img-fluid"></p>
<section id="select-from" class="level2">
<h2 class="anchored" data-anchor-id="select-from">Select, From</h2>
<p>The general syntax of SELECT statments is:</p>
<p><code>select FirstName, LastName from Employees ;</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Andrew</td>
<td>Adams</td>
</tr>
<tr class="even">
<td>Nancy</td>
<td>Edwards</td>
</tr>
<tr class="odd">
<td>Jane</td>
<td>Peacock</td>
</tr>
<tr class="even">
<td>Margaret</td>
<td>Park</td>
</tr>
<tr class="odd">
<td>Steve</td>
<td>Johnson</td>
</tr>
<tr class="even">
<td>Michael</td>
<td>Mitchell</td>
</tr>
<tr class="odd">
<td>Robert</td>
<td>King</td>
</tr>
<tr class="even">
<td>Laura</td>
<td>Callahan</td>
</tr>
</tbody>
</table>
<p>To retrieve all columns from the Employees table we could use “*” instead of specifying individual column names:</p>
<p><code>select * from Employees ;</code></p>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 5%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>EmployeeId</th>
<th>LastName</th>
<th>FirstName</th>
<th>Title</th>
<th>ReportsTo</th>
<th>BirthDate</th>
<th>HireDate</th>
<th>Address</th>
<th>City</th>
<th>State</th>
<th>Country</th>
<th>PostalCode</th>
<th>Phone</th>
<th>Fax</th>
<th>Email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Adams</td>
<td>Andrew</td>
<td>General Manager</td>
<td>None</td>
<td>1962-02-18 00:00:00</td>
<td>2002-08-14 00:00:00</td>
<td>11120 Jasper Ave NW</td>
<td>Edmonton</td>
<td>AB</td>
<td>Canada</td>
<td>T5K 2N1</td>
<td>+1 (780) 428-9482</td>
<td>+1 (780) 428-3457</td>
<td>andrew@chinookcorp.com</td>
</tr>
<tr class="even">
<td>2</td>
<td>Edwards</td>
<td>Nancy</td>
<td>Sales Manager</td>
<td>1</td>
<td>1958-12-08 00:00:00</td>
<td>2002-05-01 00:00:00</td>
<td>825 8 Ave SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 2T3</td>
<td>+1 (403) 262-3443</td>
<td>+1 (403) 262-3322</td>
<td>nancy@chinookcorp.com</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Peacock</td>
<td>Jane</td>
<td>Sales Support Agent</td>
<td>2</td>
<td>1973-08-29 00:00:00</td>
<td>2002-04-01 00:00:00</td>
<td>1111 6 Ave SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 5M5</td>
<td>+1 (403) 262-3443</td>
<td>+1 (403) 262-6712</td>
<td>jane@chinookcorp.com</td>
</tr>
<tr class="even">
<td>4</td>
<td>Park</td>
<td>Margaret</td>
<td>Sales Support Agent</td>
<td>2</td>
<td>1947-09-19 00:00:00</td>
<td>2003-05-03 00:00:00</td>
<td>683 10 Street SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 5G3</td>
<td>+1 (403) 263-4423</td>
<td>+1 (403) 263-4289</td>
<td>margaret@chinookcorp.com</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Johnson</td>
<td>Steve</td>
<td>Sales Support Agent</td>
<td>2</td>
<td>1965-03-03 00:00:00</td>
<td>2003-10-17 00:00:00</td>
<td>7727B 41 Ave</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T3B 1Y7</td>
<td>1 (780) 836-9987</td>
<td>1 (780) 836-9543</td>
<td>steve@chinookcorp.com</td>
</tr>
<tr class="even">
<td>6</td>
<td>Mitchell</td>
<td>Michael</td>
<td>IT Manager</td>
<td>1</td>
<td>1973-07-01 00:00:00</td>
<td>2003-10-17 00:00:00</td>
<td>5827 Bowness Road NW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T3B 0C5</td>
<td>+1 (403) 246-9887</td>
<td>+1 (403) 246-9899</td>
<td>michael@chinookcorp.com</td>
</tr>
<tr class="odd">
<td>7</td>
<td>King</td>
<td>Robert</td>
<td>IT Staff</td>
<td>6</td>
<td>1970-05-29 00:00:00</td>
<td>2004-01-02 00:00:00</td>
<td>590 Columbia Boulevard West</td>
<td>Lethbridge</td>
<td>AB</td>
<td>Canada</td>
<td>T1K 5N8</td>
<td>+1 (403) 456-9986</td>
<td>+1 (403) 456-8485</td>
<td>robert@chinookcorp.com</td>
</tr>
<tr class="even">
<td>8</td>
<td>Callahan</td>
<td>Laura</td>
<td>IT Staff</td>
<td>6</td>
<td>1968-01-09 00:00:00</td>
<td>2004-03-04 00:00:00</td>
<td>923 7 ST NW</td>
<td>Lethbridge</td>
<td>AB</td>
<td>Canada</td>
<td>T1H 1Y8</td>
<td>+1 (403) 467-3351</td>
<td>+1 (403) 467-8772</td>
<td>laura@chinookcorp.com</td>
</tr>
</tbody>
</table>
</section>
<section id="where" class="level2">
<h2 class="anchored" data-anchor-id="where">Where</h2>
<p>The WHERE clause can be added to your query to filter results or get specific rows of data. To retrieve data for all rows in the Employees table where the ID is less than 5:</p>
<p><code>select * from Employees where EmployeeID &lt; 5 ;</code></p>
<table class="table">
<colgroup>
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>EmployeeId</th>
<th>LastName</th>
<th>FirstName</th>
<th>Title</th>
<th>ReportsTo</th>
<th>BirthDate</th>
<th>HireDate</th>
<th>Address</th>
<th>City</th>
<th>State</th>
<th>Country</th>
<th>PostalCode</th>
<th>Phone</th>
<th>Fax</th>
<th>Email</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Adams</td>
<td>Andrew</td>
<td>General Manager</td>
<td>None</td>
<td>1962-02-18 00:00:00</td>
<td>2002-08-14 00:00:00</td>
<td>11120 Jasper Ave NW</td>
<td>Edmonton</td>
<td>AB</td>
<td>Canada</td>
<td>T5K 2N1</td>
<td>+1 (780) 428-9482</td>
<td>+1 (780) 428-3457</td>
<td>andrew@chinookcorp.com</td>
</tr>
<tr class="even">
<td>2</td>
<td>Edwards</td>
<td>Nancy</td>
<td>Sales Manager</td>
<td>1</td>
<td>1958-12-08 00:00:00</td>
<td>2002-05-01 00:00:00</td>
<td>825 8 Ave SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 2T3</td>
<td>+1 (403) 262-3443</td>
<td>+1 (403) 262-3322</td>
<td>nancy@chinookcorp.com</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Peacock</td>
<td>Jane</td>
<td>Sales Support Agent</td>
<td>2</td>
<td>1973-08-29 00:00:00</td>
<td>2002-04-01 00:00:00</td>
<td>1111 6 Ave SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 5M5</td>
<td>+1 (403) 262-3443</td>
<td>+1 (403) 262-6712</td>
<td>jane@chinookcorp.com</td>
</tr>
<tr class="even">
<td>4</td>
<td>Park</td>
<td>Margaret</td>
<td>Sales Support Agent</td>
<td>2</td>
<td>1947-09-19 00:00:00</td>
<td>2003-05-03 00:00:00</td>
<td>683 10 Street SW</td>
<td>Calgary</td>
<td>AB</td>
<td>Canada</td>
<td>T2P 5G3</td>
<td>+1 (403) 263-4423</td>
<td>+1 (403) 263-4289</td>
<td>margaret@chinookcorp.com</td>
</tr>
</tbody>
</table>
<p>In case of character based columns the values of the predicates in the where clause need to be enclosed in single quotes. To retrieve the data for the Employees names with First Name “Jane” we would issue:</p>
<p><code>select LastName, FirstName from Employees where FirstName = 'Jane';</code></p>
<table class="table">
<thead>
<tr class="header">
<th>LastName</th>
<th>FirstName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Peacock</td>
<td>Jane</td>
</tr>
</tbody>
</table>
</section>
<section id="in-or-not" class="level2">
<h2 class="anchored" data-anchor-id="in-or-not">In, Or, Not</h2>
<p><code>In</code> is used when we want to specify a range of conditions.</p>
<p>For example, find values of employees with last name Adams or Park</p>
<p><code>select FirstName, LastName from Employees</code></p>
<p><code>where LastName In ('Adams','Park');</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Andrew</td>
<td>Adams</td>
</tr>
<tr class="even">
<td>Margaret</td>
<td>Park</td>
</tr>
</tbody>
</table>
<p>Can do a similar thing with the <code>OR</code> operator. When using <code>OR</code> it is often helpful to use with brackets ()</p>
<p><code>select FirstName, LastName from Employees</code></p>
<p><code>where (LastName = 'Adams' OR LastName ='Park');</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Andrew</td>
<td>Adams</td>
</tr>
<tr class="even">
<td>Margaret</td>
<td>Park</td>
</tr>
</tbody>
</table>
<p>Why the order matters and use of ()</p>
<p><code>select FirstName, LastName from Employees</code></p>
<p><code>where LastName = 'Adams' OR LastName ='Park'</code></p>
<p><code>and reportsto=2;</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Andrew</td>
<td>Adams</td>
</tr>
<tr class="even">
<td>Margaret</td>
<td>Park</td>
</tr>
</tbody>
</table>
<p><code>select FirstName, LastName from Employees</code></p>
<p><code>where (LastName = 'Adams' OR LastName ='Park')</code></p>
<p><code>and reportsto=2;</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Margaret</td>
<td>Park</td>
</tr>
</tbody>
</table>
<p>This is because SQL processes <code>AND</code> before <code>OR</code></p>
<p><code>In</code> benefits over <code>or</code> - Long list of options - In is faster - Don’t have to consider order with IN - Can contain another <code>select</code></p>
<p>The not command is represented as <code>&lt;&gt;</code></p>
<p>for example select the titles not beginning with c</p>
<p><code>select title from albums</code></p>
<p><code>where substr(title,1,1) &lt;&gt; 'C'</code></p>
<table class="table">
<thead>
<tr class="header">
<th>Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>For Those About To Rock We Salute You</td>
</tr>
<tr class="even">
<td>Balls to the Wall</td>
</tr>
<tr class="odd">
<td>Restless and Wild</td>
</tr>
<tr class="even">
<td>Let There Be Rock</td>
</tr>
<tr class="odd">
<td>Big Ones</td>
</tr>
<tr class="even">
<td>Jagged Little Pill</td>
</tr>
<tr class="odd">
<td>Facelift</td>
</tr>
<tr class="even">
<td>Warner 25 Anos</td>
</tr>
<tr class="odd">
<td>Plays Metallica By Four Cellos</td>
</tr>
<tr class="even">
<td>Audioslave</td>
</tr>
</tbody>
</table>
<p>If it is used with <code>IN</code> then we use NOT</p>
<p>for example cities names not starting with a vowel</p>
<p><code>select distinct city from station</code></p>
<p><code>where substr(city,1,1) not in ('a','e','i','o','u')</code></p>
<table class="table">
<thead>
<tr class="header">
<th>City</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Kissee Mills</td>
</tr>
<tr class="even">
<td>Loma Mar</td>
</tr>
<tr class="odd">
<td>Sandy Hook</td>
</tr>
<tr class="even">
<td>Tipton</td>
</tr>
<tr class="odd">
<td>Turner</td>
</tr>
<tr class="even">
<td>Slidell</td>
</tr>
<tr class="odd">
<td>Negreet</td>
</tr>
</tbody>
</table>
</section>
<section id="distinct" class="level2">
<h2 class="anchored" data-anchor-id="distinct">Distinct</h2>
<p>Find unique values</p>
<p><code>select distinct artistid from albums</code></p>
<table class="table">
<thead>
<tr class="header">
<th>AlbumId</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
</tr>
<tr class="even">
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
</tr>
<tr class="even">
<td>6</td>
</tr>
<tr class="odd">
<td>7</td>
</tr>
<tr class="even">
<td>8</td>
</tr>
<tr class="odd">
<td>9</td>
</tr>
<tr class="even">
<td>10</td>
</tr>
</tbody>
</table>
</section>
<section id="wildcards" class="level2">
<h2 class="anchored" data-anchor-id="wildcards">Wildcards</h2>
<p>To find parts within a string can use the <code>%</code> wildcard</p>
<p><code>_</code> works in a similar way but matches a single character (not supported by DB2)</p>
<table class="table">
<colgroup>
<col style="width: 57%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Wildcard</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>‘%ly’</td>
<td>Find all strings ending ‘ly’</td>
</tr>
<tr class="even">
<td>‘To%’</td>
<td>Find all strings starting ‘To’</td>
</tr>
<tr class="odd">
<td>‘t%<span class="citation" data-cites="gmail.com">@gmail.com</span>’</td>
<td>Find all gmail address strings starting ‘t’</td>
</tr>
<tr class="even">
<td>’_ill’</td>
<td>Find all strings ending ill with one other chaharacter <br> e.g.&nbsp;Kill, Bill</td>
</tr>
</tbody>
</table>
<p>Implementation, to implement use <code>where</code> and <code>like</code>.</p>
<p>Find Names ending in t</p>
<p><code>select FirstName, LastName from Employees</code></p>
<p><code>where FirstName like '%t';</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Margaret</td>
<td>Park</td>
</tr>
<tr class="even">
<td>Robert</td>
<td>King</td>
</tr>
</tbody>
</table>
<p>Downsides of wildcards:</p>
<ul>
<li>Takes longer to run (particularly at end of pattern</li>
<li>Better to use another operator e.g.&nbsp;=,&gt;,&lt;</li>
</ul>
</section>
<section id="order-data" class="level2">
<h2 class="anchored" data-anchor-id="order-data">Order Data</h2>
<p><code>order by</code> - take name of 1 or more columns - Can use a column not retrieved - The last clause in a statement - Can use a number to represent column number - Add dsc or asc after column name to order acending or descending</p>
<p>Order employee names by last name ascending then last name descending</p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Andrew</td>
<td>Adams</td>
</tr>
<tr class="even">
<td>Laura</td>
<td>Callahan</td>
</tr>
<tr class="odd">
<td>Nancy</td>
<td>Edwards</td>
</tr>
<tr class="even">
<td>Steve</td>
<td>Johnson</td>
</tr>
<tr class="odd">
<td>Robert</td>
<td>King</td>
</tr>
<tr class="even">
<td>Michael</td>
<td>Mitchell</td>
</tr>
<tr class="odd">
<td>Margaret</td>
<td>Park</td>
</tr>
<tr class="even">
<td>Jane</td>
<td>Peacock</td>
</tr>
</tbody>
</table>
</section>
<section id="aggregate-functions" class="level2">
<h2 class="anchored" data-anchor-id="aggregate-functions">Aggregate Functions</h2>
<ul>
<li><code>average</code> average of a column (<code>avg</code>)</li>
<li><code>count</code> counts number of values</li>
<li><code>min</code> finds the minimum value</li>
<li><code>max</code> finds the maximum value</li>
<li><code>sum</code> sums the column values</li>
</ul>
<p><code>select count(trackid) from tracks</code></p>
<p><code>where albumid = 10</code></p>
<table class="table">
<thead>
<tr class="header">
<th>count(trackid)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14</td>
</tr>
</tbody>
</table>
</section>
<section id="group-by-and-having" class="level2">
<h2 class="anchored" data-anchor-id="group-by-and-having">Group by and Having</h2>
<p>Do the same command as above but with group by, instead of <code>where</code> need to use <code>having</code> after the group by statement</p>
<p><code>where</code> filters before data is grouped and <code>having</code> after data is grouped</p>
<p><code>select count(trackid) from tracks</code></p>
<p><code>group by albumid</code></p>
<p><code>having albumid = 10</code></p>
<table class="table">
<thead>
<tr class="header">
<th>count(trackid)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14</td>
</tr>
</tbody>
</table>
<p>or could get the number of tracks in all albums</p>
<p><code>select count(trackid) from tracks</code></p>
<p><code>group by albumid</code></p>
<table class="table">
<thead>
<tr class="header">
<th>count(trackid)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>10</td>
</tr>
<tr class="even">
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
</tr>
<tr class="even">
<td>8</td>
</tr>
<tr class="odd">
<td>15</td>
</tr>
<tr class="even">
<td>13</td>
</tr>
<tr class="odd">
<td>12</td>
</tr>
<tr class="even">
<td>14</td>
</tr>
<tr class="odd">
<td>8</td>
</tr>
<tr class="even">
<td>14</td>
</tr>
</tbody>
</table>
</section>
<section id="windowing" class="level2">
<h2 class="anchored" data-anchor-id="windowing">Windowing</h2>
<ul>
<li><p>A window function performs a calculation across a set of table rows that are somehow related to the current row.</p></li>
<li><p>Comparable to the type of calculation that can be done with an aggregate function.</p></li>
<li><p>Unlike regular aggregate functions, windowing does not cause rows to become grouped into a single output row — the rows retain their separate identities.</p></li>
<li><p>Behind the scenes, the window function is able to access more than just the current row of the query result.</p>
<p>https://www.postgresql.org/docs/9.1/tutorial-window.html</p></li>
</ul>
<p>For example, compare each song track’s length to the average salength for each composer</p>
<p><code>select composer, name,</code></p>
<p><code>milliseconds/(1000*60)                                    AS track_length,</code></p>
<p><code>avg(milliseconds/(1000*60)) over (partition by composer)  AS avg_track_length</code></p>
<p><code>from ah_uyekita.chinook_track</code></p>
<table class="table">
<thead>
<tr class="header">
<th>composer</th>
<th>name</th>
<th>track_length</th>
<th>avg_track_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Aaron Copland</td>
<td>Fanfare for the Common Man</td>
<td>3.3011</td>
<td>3.3011</td>
</tr>
<tr class="even">
<td>Aaron Goldberg</td>
<td>OAM’s Blues</td>
<td>4.4489</td>
<td>4.4489</td>
</tr>
<tr class="odd">
<td>A.Bouchard/J.Bouchard/S.Pearlman</td>
<td>Astronomy</td>
<td>6.6255</td>
<td>6.6255</td>
</tr>
<tr class="even">
<td>AC/DC</td>
<td>Let There Be Rock</td>
<td>6.1109</td>
<td>5.1110</td>
</tr>
<tr class="odd">
<td>AC/DC</td>
<td>Overdose</td>
<td>6.1553 5.1110</td>
<td></td>
</tr>
<tr class="even">
<td>AC/DC</td>
<td>Problem Child</td>
<td>5.4173</td>
<td>5.1110</td>
</tr>
<tr class="odd">
<td>AC/DC</td>
<td>Bad Boy Boogie</td>
<td>4.4621</td>
<td>5.1110</td>
</tr>
<tr class="even">
<td>AC/DC</td>
<td>Go Down</td>
<td>5.5197</td>
<td>5.1110</td>
</tr>
</tbody>
</table>
<section id="window-functions" class="level3">
<h3 class="anchored" data-anchor-id="window-functions">Window functions</h3>
<ul>
<li><code>CUME_DIST</code> Calculate the cumulative distribution of a value in a set of values</li>
<li><code>DENSE_RANK</code> Assign a rank value to each row within a partition of a result, with no gaps in rank values.</li>
<li><code>FIRST_VALUE</code> Get the value of the first row in an ordered partition of a result set.</li>
<li><code>LAG</code> Provide access to a row at a given physical offset that comes before the current row.</li>
<li><code>LAST_VALUE</code> Get the value of the last row in an ordered partition of a result set.</li>
<li><code>LEAD</code> Provide access to a row at a given physical offset that follows the current row.</li>
<li><code>NTILE</code> Distribute rows of an ordered partition into a number of groups or buckets</li>
<li><code>PERCENT_RANK</code> Calculate the percent rank of a value in a set of values.</li>
<li><code>RANK</code> Assign a rank value to each row within a partition of a result set</li>
<li><code>ROW_NUMBER</code> Assign a unique sequential integer to rows within a partition of a result set, the first row starts from 1.</li>
</ul>
<p>https://www.sqlservertutorial.net/sql-server-window-functions/</p>
</section>
</section>
<section id="subqueries" class="level2">
<h2 class="anchored" data-anchor-id="subqueries">Subqueries</h2>
<p>These are queries within other queries Which merge data from multiple sources together</p>
<p>get customerid and city when their invoice total is more than 20</p>
<p><code>select CustomerID, City</code></p>
<p><code>from customers</code></p>
<p><code>where customerid in (select customerid</code></p>
<p><code>from invoices</code></p>
<p><code>where total&gt;20)</code></p>
<table class="table">
<thead>
<tr class="header">
<th>CustomerId</th>
<th>City</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>Prague</td>
</tr>
<tr class="even">
<td>26</td>
<td>Fort Worth</td>
</tr>
<tr class="odd">
<td>45</td>
<td>Budapest</td>
</tr>
<tr class="even">
<td>46</td>
<td>Dublin</td>
</tr>
</tbody>
</table>
<p>How many albums does the band LEd Zeppelin have?</p>
<p><code>select count(*)</code></p>
<p><code>from albums</code></p>
<p><code>where artistid IN</code></p>
<p><code>(select artistid</code></p>
<p><code>from artists</code></p>
<p><code>where Name ='Led Zeppelin')</code></p>
<table class="table">
<thead>
<tr class="header">
<th>count(*)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14</td>
</tr>
</tbody>
</table>
<p>Or what are the name of the tracks for the artist Audioslave?</p>
<p><code>select Name</code></p>
<p><code>from tracks</code></p>
<p><code>where albumid IN</code></p>
<p><code>(select albumid</code></p>
<p><code>from albums</code></p>
<p><code>where artistid IN</code></p>
<p><code>(select artistid</code></p>
<p><code>from artists</code></p>
<p><code>where Name ='Audioslave'))</code></p>
<table class="table">
<thead>
<tr class="header">
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cochise</td>
</tr>
<tr class="even">
<td>Show Me How to Live</td>
</tr>
<tr class="odd">
<td>Gasoline</td>
</tr>
<tr class="even">
<td>What You Are</td>
</tr>
<tr class="odd">
<td>Like a Stone</td>
</tr>
<tr class="even">
<td>Set It Off</td>
</tr>
<tr class="odd">
<td>Shadow on the Sun</td>
</tr>
<tr class="even">
<td>I am the Highway</td>
</tr>
<tr class="odd">
<td>Exploder</td>
</tr>
<tr class="even">
<td>Hypnotize</td>
</tr>
</tbody>
</table>
</section>
<section id="joins" class="level2">
<h2 class="anchored" data-anchor-id="joins">Joins</h2>
<ul>
<li>efficient storage</li>
<li>easier manipulation</li>
<li>greater scalability</li>
<li>logically models a process</li>
<li>tables are related through common values or keys</li>
<li>data retrival from multiple tables in one query</li>
<li>only persist for the duration of the query</li>
</ul>
<section id="cartesian-cross-joins" class="level3">
<h3 class="anchored" data-anchor-id="cartesian-cross-joins">Cartesian cross joins</h3>
<ul>
<li>each row from first table joins with all rows from the other table</li>
<li>output size of joins in A multiplied rows in B</li>
<li>computationally taxing</li>
<li>rarely used</li>
<li></li>
</ul>
<p><code>select a.title, ar.name from albums as a</code></p>
<p><code>cross join artists as ar</code></p>
<p><code>order by a.title</code></p>
<table class="table">
<thead>
<tr class="header">
<th>Title</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>…And Justice For All</td>
<td>AC/DC</td>
</tr>
<tr class="even">
<td>…And Justice For All</td>
<td>Accept</td>
</tr>
</tbody>
</table>
<p>total rows = 95425</p>
<p>total rows of albums = 347</p>
<p>total rows of artists = 275</p>
</section>
<section id="inner-join" class="level3">
<h3 class="anchored" data-anchor-id="inner-join">Inner join</h3>
<ul>
<li>select records that have matching values in both tables</li>
<li>Use <code>on</code> to select what joining on</li>
<li>joining more table affects database performance</li>
<li>Can join multiple tables- no limit</li>
</ul>
<p><img src="ghtop_images/innerjoin.png" class="img-fluid"></p>
<p>For example get the artist name and title of each album. N.B. albums has columns AlbumID, Title and ArtistID only</p>
<p><code>select artists.Name, albums.Title</code></p>
<p><code>from artists</code></p>
<p><code>INNER JOIN albums</code></p>
<p><code>on artists.artistid = albums.artistID</code></p>
<table class="table">
<thead>
<tr class="header">
<th>Name</th>
<th>Title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AC/DC</td>
<td>For Those About To Rock We Salute You</td>
</tr>
<tr class="even">
<td>AC/DC</td>
<td>Let There Be Rock</td>
</tr>
<tr class="odd">
<td>Accept</td>
<td>Balls to the Wall</td>
</tr>
<tr class="even">
<td>Accept</td>
<td>Restless and Wild</td>
</tr>
<tr class="odd">
<td>Aerosmith</td>
<td>Big Ones</td>
</tr>
<tr class="even">
<td>Alanis Morissette</td>
<td>Jagged Little Pill</td>
</tr>
<tr class="odd">
<td>Alice In Chains</td>
<td>Facelift</td>
</tr>
<tr class="even">
<td>Antônio Carlos Jobim</td>
<td>Warner 25 Anos</td>
</tr>
<tr class="odd">
<td>Antônio Carlos Jobim</td>
<td>Chill: Brazil (Disc 2)</td>
</tr>
<tr class="even">
<td>Apocalyptica</td>
<td>Plays Metallica By Four Cellos</td>
</tr>
</tbody>
</table>
<p>Or as a multiple join</p>
<p><code>SELECT o.orderId, c.CompanyName, e.LastName</code></p>
<p><code>FROM ((orders o INNER JOIN customers c ON o.customerID = c.CustomerID)</code></p>
<p>`INNER JOIN employees e ON o.EmployeeID = e.EmployeeID);</p>
</section>
<section id="self-joins" class="level3">
<h3 class="anchored" data-anchor-id="self-joins">Self joins</h3>
<ul>
<li>Takes the table and treats it like two separate tables</li>
<li>Join the original table to itself</li>
</ul>
<p>For example, match cities from the same state</p>
<p><code>select A.city,A.state,B.city, B.state</code></p>
<p><code>from station A, station B</code></p>
<p><code>where A.city=B.city</code></p>
<p><code>and A.state=B.state</code></p>
<p><code>order by A.state;</code></p>
<table class="table">
<thead>
<tr class="header">
<th>city A</th>
<th>state A</th>
<th>city B</th>
<th>state B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Seward</td>
<td>AK</td>
<td>Seward</td>
<td>AK</td>
</tr>
<tr class="even">
<td>Chignik Lagoon</td>
<td>AK</td>
<td>Chignik Lagoon</td>
<td>AK</td>
</tr>
<tr class="odd">
<td>Five Points</td>
<td>AL</td>
<td>Five Points</td>
<td>AL</td>
</tr>
<tr class="even">
<td>Groveoak</td>
<td>AL</td>
<td>Groveoak</td>
<td>AL</td>
</tr>
<tr class="odd">
<td>Notasulga</td>
<td>AL</td>
<td>Notasulga</td>
<td>AL</td>
</tr>
<tr class="even">
<td>Jackson</td>
<td>AL</td>
<td>Jackson</td>
<td>AL</td>
</tr>
<tr class="odd">
<td>….</td>
<td>….</td>
<td>….</td>
<td>….</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="advanced-joins" class="level2">
<h2 class="anchored" data-anchor-id="advanced-joins">Advanced Joins</h2>
<section id="left-joins" class="level3">
<h3 class="anchored" data-anchor-id="left-joins">Left Joins</h3>
<p>Returns all records from the left table and the matched records from the righ table</p>
<p>The result is NULL from the right hand side if there is no match</p>
<p>Right joins are the same but from the RHS. Can be converted to left join by reversing the order</p>
<p><img src="ghtop_images/leftjoin.png" class="img-fluid"></p>
<p>For example, find all the customers who have an invoice</p>
<p><code>select c.FirstNAme, c.LastName, i.InvoiceId</code></p>
<p><code>from customers c</code></p>
<p><code>LEFT JOIN invoices i on c.customerid = i.customerid</code></p>
<p><code>order by c.customerid</code></p>
<table class="table">
<thead>
<tr class="header">
<th>FirstName</th>
<th>LastName</th>
<th>InvoiceId</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Luís</td>
<td>Gonçalves</td>
<td>98</td>
</tr>
<tr class="even">
<td>Luís</td>
<td>Gonçalves</td>
<td>121</td>
</tr>
<tr class="odd">
<td>Luís</td>
<td>Gonçalves</td>
<td>143</td>
</tr>
<tr class="even">
<td>Luís</td>
<td>Gonçalves</td>
<td>195</td>
</tr>
<tr class="odd">
<td>Luís</td>
<td>Gonçalves</td>
<td>316</td>
</tr>
<tr class="even">
<td>Luís</td>
<td>Gonçalves</td>
<td>327</td>
</tr>
<tr class="odd">
<td>Luís</td>
<td>Gonçalves</td>
<td>382</td>
</tr>
<tr class="even">
<td>Leonie</td>
<td>Köhler</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Leonie</td>
<td>Köhler</td>
<td>12</td>
</tr>
<tr class="even">
<td>Leonie</td>
<td>Köhler</td>
<td>67</td>
</tr>
<tr class="odd">
<td>Leonie</td>
<td>Köhler</td>
<td>196</td>
</tr>
<tr class="even">
<td>Leonie</td>
<td>Köhler</td>
<td>219</td>
</tr>
<tr class="odd">
<td>Leonie</td>
<td>Köhler</td>
<td>241</td>
</tr>
<tr class="even">
<td>Leonie</td>
<td>Köhler</td>
<td>293</td>
</tr>
<tr class="odd">
<td>François</td>
<td>Tremblay</td>
<td>99</td>
</tr>
</tbody>
</table>
</section>
<section id="full-outer-join" class="level3">
<h3 class="anchored" data-anchor-id="full-outer-join">Full outer join</h3>
<p>Returns all records where there is a match in either table</p>
<p>“Give me everything”</p>
<p><code>select c.FirstNAme, c.LastName, i.InvoiceId</code></p>
<p><code>from customers c</code></p>
<p><code>FULL OUTER JOIN invoices i on c.customerid = i.customerid</code></p>
<p><code>order by c.customerid</code></p>
</section>
</section>
<section id="unions" class="level2">
<h2 class="anchored" data-anchor-id="unions">Unions</h2>
<p>Combine two or more select statements - Each select must have the same number of columns - Columns must have similar data types - Columns in the same order - Less commonly used</p>
<p>e.g.&nbsp;combine two string statements, the first a list of occupations and the second a summary of the above</p>
<p><code>(select concat(name,'(',substr(occupation,1,1),')') from occupations)</code></p>
<p><code>union</code></p>
<p><code>(select concat('There are a total number of ',count(*),' ',occupation,'s.')</code></p>
<p><code>from occupations</code></p>
<p><code>group by occupation</code></p>
<p><code>order by count(occupation));</code></p>
</section>
<section id="substr" class="level2">
<h2 class="anchored" data-anchor-id="substr">Substr</h2>
<p>Returns part of a string</p>
<p><code>substr(string name, string position, number of characters to return)</code></p>
<p>If string position is negative counts from the end</p>
<p>e.g., find city names that start and end with a vowel</p>
<p><code>select city from station</code></p>
<p><code>where substr(city,1,1) in ('a','e','i','o','u')</code></p>
<p><code>and substr(city,-1,1) in ('a','e','i','o','u')</code></p>
</section>
<section id="others" class="level2">
<h2 class="anchored" data-anchor-id="others">Others</h2>
<p><code>Limit 1</code> limit the results to 1</p>
<p><code>concat</code> combine multiple parts</p>
<p><code>select concat(name, '(', substr(occupation,1,1), ')')</code></p>
<p><code>from occupations</code></p>
<p><code>round(X,5)</code></p>
<p>rounds X to 5 decimal places</p>
<p>or <code>round(x)</code> to nearest integer</p>
</section>
<section id="mode" class="level2">
<h2 class="anchored" data-anchor-id="mode">Mode</h2>
<p>Mode seems like a good free way to perform SQL. I’ve yet to work out if the course provided me a link to access datasets or if these are freely available for everyone opeing a new account. The website is not easy to navigate and I only found access to my workspaces from a link I saved and not from links on the website.</p>
<p>https://app.mode.com/thomassimm/reports/e9412b22b846/runs/c4e7c78695f3</p>
<section id="spark-sql" class="level3">
<h3 class="anchored" data-anchor-id="spark-sql">Spark SQL</h3>
<ul>
<li>https://files.training.databricks.com/courses/ucdavis/Lessons.dbc</li>
<li><a href="https://spark.apache.org/docs/latest/sql-programming-guide.html">Spark SQL and DataFrames and Datasets Guides</a> -<a href="https://docs.databricks.com/spark/latest/spark-sql/index.html">SQL Guide from Databricks</a></li>
<li><a href="https://databricks.com/p/ebook/learning-spark-from-oreilly">Learning Spark, 2nd Edition (eBook compliments of Databricks).</a></li>
<li><a href="https://jaceklaskowski.gitbooks.io/mastering-spark-sql/">Introduction - The Internals of Spark SQL (free gitbook)</a></li>
</ul>
</section>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<p>https://dev.mysql.com/doc/refman/8.0/en/union.html</p>
<p>https://www.w3schools.com/sql/default.asp</p>
<p>https://blog.sqlauthority.com/category/sql-puzzle/</p>
<p>https://sqlzoo.net/wiki/SQL_Tutorial</p>
<p>https://mode.com/sql-tutorial/introduction-to-sql</p>
<p>https://www.postgresql.org/docs/9.1/tutorial.html</p>
<p>https://www.coursera.org/specializations/learn-sql-basics-data-science#courses</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>