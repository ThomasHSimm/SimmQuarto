<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ThomasHSimm â€“ olympics_homeevent</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//posts/Picture3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ThomasHSimm</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ThomasHSimm"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ThomasHSimm"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><p><img src="../posts/header2.png" height="200"></p>



<section id="olympics-data-with-sql-and-pandas--home-games" class="level1">
<h1>Olympics data with SQL and pandas- home games</h1>
<blockquote class="blockquote">
<p>What is the effect of a home Olympic games</p>
</blockquote>
<ul>
<li>toc: true</li>
<li>badges: true</li>
<li>comments: true</li>
<li>categories: [SQL, Pandas, python, Olympics]</li>
</ul>
<p><img src="ghtop_images/header2.png" class="img-fluid"></p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This is part of a project that looks at an Olympics dataset.</p>
<p>In this part the hypothesis considered is:</p>
<pre><code>At a home Olympic games a nation will on average obtain more medals than at other games</code></pre>
<ul>
<li>But can we quantify this effect?</li>
<li>Are there any residual effects before and after the games?</li>
<li>What about a home continent games?</li>
</ul>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<p>To be able to answer the question, the steps taken are as follows. Note the data and tables created in a previous page.</p>
<ul>
<li>Create table of medal athletes as <code>athlete</code>
<ul>
<li><code>Medals</code></li>
<li><code>Year</code></li>
<li><code>NOC</code></li>
<li><em>Others? <code>Sex</code>, <code>number_of_athletes</code></em></li>
</ul></li>
<li>Join <code>athlete</code> table to <code>country</code> table to get the country added to <code>athlete</code></li>
</ul>
<p>Now the next step is trickier. There are several ways we could look at the effect of a home game and the nearness to it. The way I like to do this is to visualise the plot(s) I would like and work back from that.</p>
<p>The plot Iâ€™d like is: - x-axis = year from games (0 = at the games, +ve after and -ve before) - y-axis = number of medals</p>
<p>If we normalise the y-axis we can put all the events together to get an effect of games, before and after. We can also pick out individual games or do the averageing on different time-periods.</p>
<p>So to achieve this we need a vector for each games of: - Year from games - Number of medals</p>
<p>There are a number of potential problems with this: 1. If a nation holds two games close to each other 1. Normally games are every 4 years but how do we deal with exceptions to this? 1. What do we do when there is a lack of data before or after the games? e.g.&nbsp;games at the start of Olympics or current games, or if a nation stops partipation 1. When looking at the effect of continent, the approach would need to be adjusted based on there being fewer continents and most games being in Europe</p>
<ol type="1">
<li><p>can be solved by reducing the times to +- 20 years, and because we are averageing any exceptions should be covered</p></li>
<li><p>a way to solve this is to fit the data across the years/medals data we have with a function then use the function to give us values on a set scale (e.g.&nbsp;-20 to 20 in steps of 4 yrs)</p></li>
<li><p>a bit trickier, may we fit values that have positive and negative values up to 20 yrs first. Then if an event has a gap in years fill with the average values below and above 0 yrs</p></li>
<li><p>for this maybe just look at a partcular game based on recent games that are not in the same continent</p></li>
</ol>
</section>
<section id="some-starting-code" class="level2">
<h2 class="anchored" data-anchor-id="some-starting-code">Some Starting Code</h2>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandasql <span class="im">import</span> sqldf</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_F_S <span class="op">=</span>pd.read_csv(<span class="st">'data/athlete_F_S'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_F_W<span class="op">=</span>pd.read_csv(<span class="st">'data/athlete_F_W'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df_M_S<span class="op">=</span>pd.read_csv(<span class="st">'data/athlete_M_S'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df_M_W<span class="op">=</span>pd.read_csv(<span class="st">'data/athlete_M_W'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>df_all_athletes<span class="op">=</span> pd.read_csv(<span class="st">'data/all_athletes'</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>df_country<span class="op">=</span> pd.read_csv(<span class="st">'data/country'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df_event= pd.read_csv('data/event')</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>df_games<span class="op">=</span> pd.read_csv(<span class="st">'data/games'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># df_population= pd.read_csv('data/population')</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>df_country <span class="op">=</span> df_country.groupby(<span class="st">'NOC'</span>).<span class="bu">max</span>()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># df_country.head(10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_games.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>games_id</th>
      <th>City</th>
      <th>Country</th>
      <th>Year</th>
      <th>Region</th>
      <th>Summer</th>
      <th>Winter</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>Athens</td>
      <td>Greece</td>
      <td>1896</td>
      <td>Europe</td>
      <td>1</td>
      <td>0</td>
      <td>37.9838</td>
      <td>23.7275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>Paris</td>
      <td>France</td>
      <td>1900</td>
      <td>Europe</td>
      <td>1</td>
      <td>0</td>
      <td>48.8566</td>
      <td>2.3522</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>St. Louis</td>
      <td>USA</td>
      <td>1904</td>
      <td>North America</td>
      <td>1</td>
      <td>0</td>
      <td>38.6270</td>
      <td>90.1994</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>Athens</td>
      <td>Greece</td>
      <td>1906</td>
      <td>Europe</td>
      <td>1</td>
      <td>0</td>
      <td>37.9838</td>
      <td>23.7275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>London</td>
      <td>UK</td>
      <td>1908</td>
      <td>Europe</td>
      <td>1</td>
      <td>0</td>
      <td>51.5072</td>
      <td>0.1276</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="create-a-table-of-country-medals" class="level2">
<h2 class="anchored" data-anchor-id="create-a-table-of-country-medals">Create a table of Country &amp; Medals</h2>
<p>This first step is to create a table of athletes data that includes both women and men athletes from the summer games, we want the following columns: - The Olympic Year - The Nation - The Continent of the Nation - The number of medals the nation got that year</p>
<p>Basically just <code>UNION</code> to join the male and female athletes- with some additions so we get the total number of medals per country</p>
<p>Followed by a <code>JOIN</code> on the <code>country</code> table to get more information about the countries.</p>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_of_medals(df_F_S,df_M_S):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    testa2<span class="op">=</span>sqldf(<span class="st">'</span><span class="ch">\</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT                                                         </span><span class="ch">\</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">            COUNT(*)              AS number_of_medals,                 </span><span class="ch">\</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">            Year, NOC                                                  </span><span class="ch">\</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM                                                           </span><span class="ch">\</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">        (SELECT NOC,Year,COUNT(*) AS counta                            </span><span class="ch">\</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">           FROM                                                        </span><span class="ch">\</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">             (SELECT                                                   </span><span class="ch">\</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">             athlete_ID,                                               </span><span class="ch">\</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">             event_ID,                                                 </span><span class="ch">\</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">             Medal_Gold,Medal_Silver,Medal_Bronze,                     </span><span class="ch">\</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">             Year,                                                     </span><span class="ch">\</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">             NOC                                                       </span><span class="ch">\</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="st">             from df_F_S                                               </span><span class="ch">\</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE Medal_Gold=1 OR Medal_Silver=1 OR Medal_Bronze=1    </span><span class="ch">\</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="st">             UNION ALL                                                 </span><span class="ch">\</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="st">             SELECT                                                    </span><span class="ch">\</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="st">             athlete_ID,                                               </span><span class="ch">\</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="st">             event_ID,                                                 </span><span class="ch">\</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="st">             Medal_Gold,Medal_Silver,Medal_Bronze,                     </span><span class="ch">\</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="st">             Year,                                                     </span><span class="ch">\</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="st">             NOC                                                       </span><span class="ch">\</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="st">             from df_M_S                                               </span><span class="ch">\</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="st">             WHERE Medal_Gold=1 OR Medal_Silver=1 OR Medal_Bronze=1    </span><span class="ch">\</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="st">             order by Year asc) A                                      </span><span class="ch">\</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="st">           GROUP BY                                                    </span><span class="ch">\</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="st">             Year, NOC,event_id,Medal_Gold,Medal_Silver,Medal_Bronze)  AS B</span><span class="ch">\</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="st">         GROUP BY Year, NOC                                            </span><span class="ch">\</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="st">                 ;'</span>,<span class="bu">locals</span>()  )                                       </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> testa2</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> join_country(df_,df_country):</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    testa2<span class="op">=</span>sqldf(<span class="st">'</span><span class="ch">\</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="st">        SELECT                             </span><span class="ch">\</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="st">            c.NOC,c.Nation,c.Continent,    </span><span class="ch">\</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="st">            a.number_of_medals,            </span><span class="ch">\</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="st">            a.Year                         </span><span class="ch">\</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM                               </span><span class="ch">\</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="st">            df_ AS a                       </span><span class="ch">\</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="st">        INNER JOIN                         </span><span class="ch">\</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="st">            df_country AS c                </span><span class="ch">\</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="st">        ON                                 </span><span class="ch">\</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="st">            c.NOC=a.NOC                    </span><span class="ch">\</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="st">        GROUP BY                           </span><span class="ch">\</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="st">            c.NOC,a.Year                   </span><span class="ch">\</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="st">     ;'</span>,<span class="bu">locals</span>()  ) </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> testa2</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>df_medals<span class="op">=</span>number_of_medals(df_F_S,df_M_S)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>df_medals2<span class="op">=</span>join_country(df_medals,df_country)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>df_medals2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>NOC</th>
      <th>Nation</th>
      <th>Continent</th>
      <th>number_of_medals</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALG</td>
      <td>Algeria</td>
      <td>Africa</td>
      <td>2</td>
      <td>1984</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ALG</td>
      <td>Algeria</td>
      <td>Africa</td>
      <td>2</td>
      <td>1992</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ALG</td>
      <td>Algeria</td>
      <td>Africa</td>
      <td>3</td>
      <td>1996</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="find-the-change-in-medals-around-a-home-games" class="level2">
<h2 class="anchored" data-anchor-id="find-the-change-in-medals-around-a-home-games">Find the change in medals around a home games</h2>
<p>The <em>easy</em> solution here would be to take an average of the medals a country obtains obtains at a home games versus non-home games. However, this wouldnâ€™t work mainly due to the changes in medals with time (they increase).</p>
<p>We could correct for overall changes in the number of medals by normalising based on the total number of medals in a games. This would be better, but we may need an extra step to account for the lack of diversity of nations in earlier years too.</p>
<p>But also we wouldnâ€™t be able to see what effect a home games had before and after the games were held.</p>
<p>To observe how medal count is effected before and after a games, and to somewhat reduce the increase in medals with time, the following steps are taken.</p>
<ol type="1">
<li>Scoll through the <code>games</code> table for each summer games</li>
<li>For each game add data to the following variables (of length of the number of games) for each particular games
<ul>
<li><code>nation</code> the nation hosting the particular games</li>
<li><code>medals</code> the number of medals for each games for the nation hosting the particular games, in all the other games</li>
<li><code>years</code> the difference in years between the particular games and all other games</li>
</ul></li>
</ol>
<p>For example:</p>
<p>USA 1984, Los Angeles</p>
<ul>
<li><p><code>nation[20]</code> is â€˜USAâ€™</p></li>
<li><p><code>years[20]</code> is <code>[-88, -84, -80, -78, -76, -72, -64, -60, -56, -52, -48, -36, -32,-28, -24, -20, -16, -12,  -8,   0,   4,   8,  12,  16,  20,  24, 28,  32]</code></p></li>
</ul>
<p>the 0 being the 1984 games, and the 32 being the 2016 games</p>
<ul>
<li><code>medals[20]</code> is <code>[ 19,  54, 230,  23,  46,  63,  95,  99,  56, 110,  57,  84,  76, 74,  71,  90, 107,   94,  94, 173,  94, 108, 101,  91, 101, 110, 103, 121]</code></li>
</ul>
<p>the 173 being the number of medals obtained in 1984 and 121 in 2016</p>
<ol start="3" type="1">
<li>Create a vector for each games of medals against years around the home game.</li>
</ol>
<ul>
<li>Since not all games are seperated by 4 years and some games can be missed the data needs to be interpolated onto a range in steps of 4 years. Outer bounds of +-28 years ae chosen</li>
<li>When data is missing because the full range of data canâ€™t be obtained (i.e.&nbsp;for recent games or ones near the start of Olympics) replace any missing values with 0</li>
</ul>
<ol start="4" type="1">
<li>Add up all the vectors for different games</li>
</ol>
<ul>
<li>ignore games where the range isnâ€™t full (-32-&gt;32)</li>
<li>this gives the average effect of a home games</li>
</ul>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 and 2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Since we just want the summer games</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df_games<span class="op">=</span>df_games[df_games.Summer<span class="op">==</span><span class="dv">1</span>].reset_index()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>medals<span class="op">=</span>[]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>years<span class="op">=</span>[]</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>nation<span class="op">=</span>[]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df_games)):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    country<span class="op">=</span>df_games.loc[i,<span class="st">'Country'</span>]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    year<span class="op">=</span>df_games.loc[i,<span class="st">'Year'</span>]</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    nation.append(country)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    medals.append(df_medals2[df_medals2.Nation<span class="op">==</span>country].number_of_medals.values)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    years.append(df_medals2[df_medals2.Nation<span class="op">==</span>country].Year.values <span class="op">-</span> year)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">Step 3</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">Function to interpolate number of medals in years around a games</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">Takes as input x=years and y=number of medals and outputs a new x and y values </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">that have been interpolated between -28 to +28 years in steps of 4 years</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">For games where the full range can't be obtained (e.g. an event close to 2016 </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">will have missing data for years after it) the data is interpolated to the nearest </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">4 years and missing data replaced with zeroes.</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_interp(x,y):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> scipy.interpolate <span class="im">import</span> interp1d</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    xx,yy<span class="op">=</span>x,y</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    xhi,xlo<span class="op">=</span><span class="dv">28</span>,<span class="op">-</span><span class="dv">28</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    xnew<span class="op">=</span>np.arange(xlo,xhi<span class="op">+</span><span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    ynew<span class="op">=</span>np.zeros(np.shape(xnew))</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># here make adjustments if the whole range doesn't exist to go to nearest 4 yrs</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># or if inbetween go outside to next one i.e. 11 years-&gt;12 years, 8-&gt;8,-5-&gt;-8</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lower years are dealt with separately to later years then combined</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and normalised</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    maxx,minx<span class="op">=</span>np.<span class="bu">max</span>(x),np.<span class="bu">min</span>(x)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> maxx<span class="op">&lt;</span>xhi:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        xhi<span class="op">=</span> <span class="dv">4</span><span class="op">*</span>(np.ceil(maxx<span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        xx<span class="op">=</span>xx[<span class="dv">1</span>:]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        yy<span class="op">=</span>yy[<span class="dv">1</span>:]</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> minx<span class="op">&gt;</span>xlo:</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        xlo<span class="op">=</span> <span class="op">-</span><span class="dv">4</span><span class="op">*</span>(np.ceil(<span class="bu">abs</span>(minx)<span class="op">/</span><span class="dv">4</span>))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        xx<span class="op">=</span>xx[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        yy<span class="op">=</span>yy[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    cond <span class="op">=</span>((xnew<span class="op">&lt;=</span>xhi) <span class="op">&amp;</span> (xnew<span class="op">&gt;=</span>xlo))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        f2 <span class="op">=</span> interp1d(x, y, kind<span class="op">=</span><span class="st">'cubic'</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        ynew[cond]<span class="op">=</span>f2(xnew[cond])</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        f2 <span class="op">=</span> interp1d(xx, yy, kind<span class="op">=</span><span class="st">'cubic'</span>)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        cond <span class="op">=</span>((xnew<span class="op">&lt;=</span>xhi<span class="op">-</span><span class="dv">4</span>) <span class="op">&amp;</span> (xnew<span class="op">&gt;=</span>xlo<span class="op">+</span><span class="dv">4</span>))</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        ynew[cond]<span class="op">=</span>f2(xnew[cond])</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    ynew<span class="op">=</span>ynew<span class="op">/</span><span class="bu">max</span>(ynew)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xnew,ynew</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>XY<span class="op">=</span>[]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,year_range <span class="kw">in</span> <span class="bu">enumerate</span>(years):</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>year_range</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>medals[i]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    xnew,ynew<span class="op">=</span>do_interp(x,y)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    XY.append(np.array(ynew))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>np.shape(XY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(29, 15)</code></pre>
</div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If values are less than 0 put as just above zero- can occur when </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make XY a numpy array</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>XY <span class="op">=</span> np.array(XY)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># if interpolation is not good</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>XY[XY<span class="op">&lt;</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># create vectors for y-data either side of home-event</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>yallL <span class="op">=</span> np.zeros((<span class="dv">8</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>yallR <span class="op">=</span> np.zeros((<span class="dv">8</span>))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># scroll through each games</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co"># find if the low years or high years have zeros in them</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># if they don't include them in the sum </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,ygames <span class="kw">in</span> <span class="bu">enumerate</span>(XY):</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i<span class="op">&gt;</span><span class="dv">11</span>:</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">0</span> <span class="kw">not</span> <span class="kw">in</span> ygames[<span class="op">-</span><span class="dv">8</span>:]:</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>            yallL[<span class="op">-</span><span class="dv">8</span>:]<span class="op">=</span>yallL[<span class="op">-</span><span class="dv">8</span>:]<span class="op">+</span>ygames[<span class="op">-</span><span class="dv">8</span>:]</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="dv">0</span> <span class="kw">not</span> <span class="kw">in</span> ygames[<span class="dv">0</span>:<span class="dv">8</span>]:</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>            yallR[<span class="dv">0</span>:<span class="dv">8</span>]<span class="op">=</span>yallR[<span class="dv">0</span>:<span class="dv">8</span>]<span class="op">+</span>ygames[<span class="dv">0</span>:<span class="dv">8</span>]</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># normalise</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>yallL<span class="op">=</span>yallL<span class="op">/</span><span class="bu">max</span>(yallL)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>yallR<span class="op">=</span>yallR<span class="op">/</span><span class="bu">max</span>(yallR)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># combine low and high years and only use home game year once</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>yall<span class="op">=</span>np.concatenate([yallR[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>],yallL])</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>plt.plot(xnew,yall<span class="op">/</span><span class="bu">max</span>(yall),<span class="st">'ok-'</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span> ,<span class="fl">1.05</span>])</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Normalise medals won'</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Years either side of a home games'</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(xnew,yall2/max(yall2),'m+--')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Text(0.5, 0, 'Years either side of a home games')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="plot-the-effect-of-home-games-for-different-games" class="level2">
<h2 class="anchored" data-anchor-id="plot-the-effect-of-home-games-for-different-games">Plot the effect of home games for different games</h2>
<p>Look at the individual games plots</p>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="22">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>startnum<span class="op">=</span><span class="dv">11</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>cola<span class="op">=</span>[<span class="st">'mo--'</span>,<span class="st">'gs:'</span>,<span class="st">'bv-.'</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i2 <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    fig,ax<span class="op">=</span>plt.subplots()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    vals <span class="op">=</span> np.arange(startnum,startnum<span class="op">+</span><span class="dv">3</span>,<span class="dv">1</span>,dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    i1<span class="op">=</span><span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> vals: </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        plt.plot(xnew,XY[i,:],cola[i1])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        plt.ylim([<span class="op">-</span><span class="fl">.2</span> ,<span class="dv">1</span>])</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        plt.legend([ nation[ii] <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> <span class="bu">str</span>(df_games.loc[ii,<span class="st">'Year'</span>]) <span class="cf">for</span> jj,ii <span class="kw">in</span> <span class="bu">enumerate</span>(vals)])<span class="op">;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Normalise medals won'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Years either side of a home games'</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        i1<span class="op">=</span>i1<span class="op">+</span><span class="dv">1</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    startnum<span class="op">=</span>startnum<span class="op">+</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-11-output-6.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="continent-home-games" class="level2">
<h2 class="anchored" data-anchor-id="continent-home-games">Continent home games</h2>
<p>The Olympics have mainly been held in Europe and North America. Because of this it is not possible to do the same analysis as for home country games.</p>
<p>Instead we can look at the difference if a games is a home continent or not.</p>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-scrolled="true" data-execution_count="551">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>continentYorN<span class="op">=</span>sqldf(<span class="st">'</span><span class="ch">\</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT                                     </span><span class="ch">\</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">    home_continent,                            </span><span class="ch">\</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">    Year,                                      </span><span class="ch">\</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*)         AS num_countries,         </span><span class="ch">\</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(avg_medals)  AS avg_medals             </span><span class="ch">\</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM                                       </span><span class="ch">\</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">      (SELECT                                  </span><span class="ch">\</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="st">            Nation,home_continent, Year,       </span><span class="ch">\</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">            AVG(number_of_medals)  AS avg_medals</span><span class="ch">\</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="st">        FROM                                   </span><span class="ch">\</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">            (SELECT                            </span><span class="ch">\</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">               a.*,                            </span><span class="ch">\</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="st">               CASE WHEN                       </span><span class="ch">\</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="st">                  c.Region =a.Continent THEN 1 </span><span class="ch">\</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE 0 END AS home_continent    </span><span class="ch">\</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM                               </span><span class="ch">\</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="st">                df_medals2 AS a                </span><span class="ch">\</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="st">            INNER JOIN                         </span><span class="ch">\</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="st">                df_games AS c                  </span><span class="ch">\</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="st">            ON                                 </span><span class="ch">\</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="st">                c.Year=a.Year                  </span><span class="ch">\</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE c.Year&gt; 1951) as inner       </span><span class="ch">\</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="st">        GROUP BY                               </span><span class="ch">\</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="st">            Nation, Year ) as midder           </span><span class="ch">\</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY home_continent,Year               </span><span class="ch">\</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="st">     ;'</span>,<span class="bu">locals</span>()  ) </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>continentYorN.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="551">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>home_continent</th>
      <th>Year</th>
      <th>num_countries</th>
      <th>avg_medals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1952</td>
      <td>20</td>
      <td>7.450000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1956</td>
      <td>36</td>
      <td>11.944444</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1960</td>
      <td>21</td>
      <td>7.095238</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1964</td>
      <td>34</td>
      <td>13.470588</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1968</td>
      <td>35</td>
      <td>11.285714</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="631">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span>plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN[continentYorN.home_continent<span class="op">==</span><span class="dv">1</span>].Year,continentYorN[continentYorN.home_continent<span class="op">==</span><span class="dv">1</span>].avg_medals,<span class="st">'rs--'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN[continentYorN.home_continent<span class="op">==</span><span class="dv">0</span>].Year,continentYorN[continentYorN.home_continent<span class="op">==</span><span class="dv">0</span>].avg_medals,<span class="st">'ob--'</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Average medals'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Games year'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot([df_games[df_games.Region=='Asia'].Year.values,df_games[df_games.Region=='Asia'].Year.values],[0,35],color=[1,.8,.8]);</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],<span class="st">'m--'</span>)<span class="op">;</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>,<span class="dv">0</span>],<span class="st">'g-.'</span>)<span class="op">;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>plt.plot([df_games[df_games.Region<span class="op">==</span><span class="st">'Americas'</span>].Year.values,df_games[df_games.Region<span class="op">==</span><span class="st">'Americas'</span>].Year.values],[<span class="dv">0</span>,<span class="dv">35</span>],<span class="st">'m--'</span>)<span class="op">;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>plt.plot([df_games[df_games.Region<span class="op">==</span><span class="st">'Europe'</span>].Year.values,df_games[df_games.Region<span class="op">==</span><span class="st">'Europe'</span>].Year.values],[<span class="dv">0</span>,<span class="dv">35</span>],<span class="st">'g-.'</span>)<span class="op">;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot([df_games[df_games.Region=='Oceania'].Year.values,df_games[df_games.Region=='Oceania'].Year.values],[0,35],color=[0.7,1,.7]);</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">1950</span>,<span class="dv">2020</span>])</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Home continent'</span>,<span class="st">'Another continent'</span>,<span class="st">'Americas'</span>,<span class="st">'Europe'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="631">
<pre><code>&lt;matplotlib.legend.Legend at 0x1f4339ed580&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>Not a good measure</li>
<li>Instead need following columns
<ul>
<li>total or average medals per continent</li>
<li>Home Continent</li>
<li>Year</li>
</ul></li>
</ul>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="35">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">A check on the inner part of the SQL  statement</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>sqldf(<span class="st">'</span><span class="ch">\</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT *   FROM                            </span><span class="ch">\</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">        (SELECT                                </span><span class="ch">\</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">               a.*,                            </span><span class="ch">\</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">               CASE WHEN                       </span><span class="ch">\</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">                  c.Region =a.Continent THEN 1 </span><span class="ch">\</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE 0 END AS home_continent    </span><span class="ch">\</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM                               </span><span class="ch">\</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">                df_medals2 AS a                </span><span class="ch">\</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">            INNER JOIN                         </span><span class="ch">\</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">                df_games AS c                  </span><span class="ch">\</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="st">            ON                                 </span><span class="ch">\</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="st">                c.Year=a.Year                  </span><span class="ch">\</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE c.Year&gt; 1951) as inner       </span><span class="ch">\</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="st">     ;'</span>,<span class="bu">locals</span>()  ) </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>NOC</th>
      <th>Nation</th>
      <th>Continent</th>
      <th>number_of_medals</th>
      <th>Year</th>
      <th>home_continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ANZ</td>
      <td>Australia</td>
      <td>Oceania</td>
      <td>11</td>
      <td>1952</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ARG</td>
      <td>Argentina</td>
      <td>Americas</td>
      <td>5</td>
      <td>1952</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AUT</td>
      <td>Austria</td>
      <td>Europe</td>
      <td>2</td>
      <td>1952</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>BEL</td>
      <td>Belgium</td>
      <td>Europe</td>
      <td>4</td>
      <td>1952</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>BOH</td>
      <td>Czech Republic</td>
      <td>Europe</td>
      <td>13</td>
      <td>1952</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>960</th>
      <td>UKR</td>
      <td>Ukraine</td>
      <td>Europe</td>
      <td>11</td>
      <td>2016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>961</th>
      <td>USA</td>
      <td>USA</td>
      <td>Americas</td>
      <td>121</td>
      <td>2016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>962</th>
      <td>UZB</td>
      <td>Uzbekistan</td>
      <td>Asia</td>
      <td>13</td>
      <td>2016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>963</th>
      <td>VEN</td>
      <td>Venezuela</td>
      <td>Americas</td>
      <td>3</td>
      <td>2016</td>
      <td>0</td>
    </tr>
    <tr>
      <th>964</th>
      <td>VIE</td>
      <td>Vietnam</td>
      <td>Asia</td>
      <td>2</td>
      <td>2016</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>965 rows Ã— 6 columns</p>
</div>
</div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="592">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">The complete SQL statement</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>continentYorN2<span class="op">=</span>sqldf(<span class="st">'</span><span class="ch">\</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span><span class="ch">\</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">      Year, sum(number_of_medals) AS num_medals, Continent,home_continent</span><span class="ch">\</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">          FROM                                 </span><span class="ch">\</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">        (SELECT                                </span><span class="ch">\</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="st">               a.*,                            </span><span class="ch">\</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="st">               CASE WHEN                       </span><span class="ch">\</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="st">                  c.Region =a.Continent THEN 1 </span><span class="ch">\</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="st">               ELSE 0 END AS home_continent    </span><span class="ch">\</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="st">            FROM                               </span><span class="ch">\</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">                df_medals2 AS a                </span><span class="ch">\</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">            INNER JOIN                         </span><span class="ch">\</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="st">                df_games AS c                  </span><span class="ch">\</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="st">            ON                                 </span><span class="ch">\</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="st">                c.Year=a.Year                  </span><span class="ch">\</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="st">            WHERE c.Year&gt; 1951) as inner       </span><span class="ch">\</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="st">        GROUP BY Continent,Year, home_continent</span><span class="ch">\</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="st">        ORDER BY Year</span><span class="ch">\</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="st">     ;'</span>,<span class="bu">locals</span>()  ) </span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>continentYorN2.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="592">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>num_medals</th>
      <th>Continent</th>
      <th>home_continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1952</td>
      <td>11</td>
      <td>Africa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1952</td>
      <td>100</td>
      <td>Americas</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1952</td>
      <td>24</td>
      <td>Asia</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1952</td>
      <td>308</td>
      <td>Europe</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1952</td>
      <td>14</td>
      <td>Oceania</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-execution_count="603">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">5</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Asia'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'or'</span>,markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">':or'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Europe'</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'bo'</span>,markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'b--o'</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Americas'</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'m&lt;'</span>,markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'m-o'</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Oceania'</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'cv'</span>,markersize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>plt.plot(continentYorN2[cond].Year,continentYorN2[cond].num_medals,<span class="st">'c-o'</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Asia'</span>,<span class="st">''</span>,<span class="st">'Europe'</span>,<span class="st">''</span>,<span class="st">'Americas'</span>,<span class="st">''</span>,<span class="st">'Oceania'</span>,<span class="st">''</span>])</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-07-29-Olympics_HomeEvent_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-run_control="{&quot;frozen&quot;:true}" data-scrolled="true" data-execution_count="620">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Europe'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>asum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>bsum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'For </span><span class="sc">{}</span><span class="st"> the average medals at home continent = </span><span class="sc">{:.0f}</span><span class="st"> and for away continent = </span><span class="sc">{:.0f}</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="st">      With a ratio of </span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(region,asum,bsum,asum<span class="op">/</span>bsum))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Asia'</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>asum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>bsum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'For </span><span class="sc">{}</span><span class="st"> the average medals at home continent = </span><span class="sc">{:.0f}</span><span class="st"> and for away continent = </span><span class="sc">{:.0f}</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">      With a ratio of </span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(region,asum,bsum,asum<span class="op">/</span>bsum))</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Americas'</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>asum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>bsum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'For </span><span class="sc">{}</span><span class="st"> the average medals at home continent = </span><span class="sc">{:.0f}</span><span class="st"> and for away continent = </span><span class="sc">{:.0f}</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="st">      With a ratio of </span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(region,asum,bsum,asum<span class="op">/</span>bsum))</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>region<span class="op">=</span><span class="st">'Oceania'</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">1</span>))</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>asum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>cond<span class="op">=</span>((continentYorN2.Continent<span class="op">==</span>region)<span class="op">&amp;</span>(continentYorN2.home_continent<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>bsum<span class="op">=</span>np.average(continentYorN2[cond].num_medals)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'For </span><span class="sc">{}</span><span class="st"> the average medals at home continent = </span><span class="sc">{:.0f}</span><span class="st"> and for away continent = </span><span class="sc">{:.0f}</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="st">      With a ratio of </span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>(region,asum,bsum,asum<span class="op">/</span>bsum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>For Europe the average medals at home continent = 420 and for away continent = 396
       With a ratio of 1.06
For Asia the average medals at home continent = 121 and for away continent = 103
       With a ratio of 1.18
For Americas the average medals at home continent = 177 and for away continent = 130
       With a ratio of 1.36
For Oceania the average medals at home continent = 50 and for away continent = 32
       With a ratio of 1.57</code></pre>
</div>
</div>
<p>Again the above stats are not really great as</p>
<ul>
<li>donâ€™t take account of changes in the average number of medals with time for a nation</li>
<li>games in Oceania and Americas are often also home games</li>
</ul>
<p>The best metric uses Europe and suggests a less than 6% increase for a home continent</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>