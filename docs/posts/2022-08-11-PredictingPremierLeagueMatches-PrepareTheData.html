<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ThomasHSimm – predictingpremierleaguematches-preparethedata</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//posts/Picture3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ThomasHSimm</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ThomasHSimm"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ThomasHSimm"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><p><img src="../posts/header2.png" height="200"></p>



<section id="predicting-premier-league-matches--prepare-the-data" class="level1">
<h1>Predicting Premier League Matches- Prepare the data</h1>
<blockquote class="blockquote">
<p>Using Python and Random Forests to predict football matches</p>
</blockquote>
<blockquote class="blockquote">
<p>Prepare the data</p>
</blockquote>
<ul>
<li>toc: true</li>
<li>badges: true</li>
<li>comments: true</li>
<li>categories: [pandas, Football, Premier League,Python]</li>
</ul>
<p><img src="ghtop_images/header2.png" class="img-fluid"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The aim of this page is to prepare data for modelling to predict the results.</p>
<section id="source-of-the-data" class="level3">
<h3 class="anchored" data-anchor-id="source-of-the-data">Source of the data</h3>
<p>The data was downloaded with this <a href="https://www.kaggle.com/code/thomassimm/epl-downloaddata">code</a> which uses the wesbite <a href="https://fbref.com/en/comps/9/history/Premier-League-Seasons">FBREF</a>.</p>
<p>The data from the following seasons were used (season = year competition started), as earlier years had a different format: - 2017 - 2018 - 2019 - 2020 - 2021</p>
<p>Further down the data in each column downloaded is shown.</p>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology">Methodology</h3>
<p>The data gives details of a given match along with the result. Details such as shots on goal, possession etc. But I don’t want to predict the results of a match given the data of that match. Instead I want to predict the result based on data from previous matches.</p>
<ul>
<li>So the data for a match needs to come from data from previous matches, with preferance to matches that are near</li>
</ul>
<p>The second important step with this data is to combine results of the home and away team to allow predictions for one match.</p>
<p>#collapse-hide</p>
</section>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<section id="overall-match-details" class="level3">
<h3 class="anchored" data-anchor-id="overall-match-details">Overall match details</h3>
<ul>
<li><code>Date</code> – Date listed is local to the match</li>
<li><code>Time</code> – Time listed is local to the match venue
<ul>
<li><code>Time</code> is written in the 24-hour notation -Your local time is in (·)</li>
</ul></li>
<li><code>Comp</code> – Competition</li>
<li><code>Number</code> next to competition states which level in the country’s league pyramid this league occupies.</li>
<li><code>Round</code> – Round or Phase of Competition</li>
<li><code>Day</code> – Day of week</li>
<li><code>GF</code> – Goals For</li>
<li><code>GA</code> – Goals Against</li>
<li><code>opponent</code></li>
</ul>
</section>
<section id="scores-fixtures" class="level3">
<h3 class="anchored" data-anchor-id="scores-fixtures">Scores &amp; Fixtures</h3>
<ul>
<li><code>Day</code> – Day of week</li>
<li><code>xG</code> – Expected Goals
<ul>
<li>xG totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>xGA</code> – Expected Goals Allowed
<ul>
<li>xG totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>Poss</code> – Possession
<ul>
<li>Calculated as the percentage of passes attempted</li>
</ul></li>
<li><code>Formation</code> – Number of players in each row from defenders to forwards, not including the goalkeeper.
<ul>
<li>Formations provided by Data Sports Group and StatsBomb.</li>
</ul></li>
</ul>
</section>
<section id="shooting" class="level3">
<h3 class="anchored" data-anchor-id="shooting">Shooting</h3>
<section id="standard" class="level4">
<h4 class="anchored" data-anchor-id="standard">Standard</h4>
<ul>
<li><code>Gls</code> – Goals scored or allowed</li>
<li><code>Sh</code> – Shots Total -Does not include penalty kicks</li>
<li><code>SoT</code> – Shots on target -Note: Shots on target do not include penalty kicks</li>
<li><code>SoT%</code> – Percentage of shots that are on target
<ul>
<li>Minimum .395 shots per squad game to qualify as a leader -Note: Shots on target do not include penalty kicks</li>
</ul></li>
<li><code>G/Sh</code> – Goals per shot
<ul>
<li>Minimum .395 shots per squad game to qualify as a leader</li>
</ul></li>
<li><code>G/SoT</code> – Goals per shot on target
<ul>
<li>Minimum .111 shots on target per squad game to qualify as a leader</li>
<li>Note: Shots on target do not include penalty kicks</li>
</ul></li>
<li><code>Dist</code> – Average distance, in yards, from goal of all shots taken
<ul>
<li>Minimum .395 shots per squad game to qualify as a leader</li>
<li>Does not include penalty kicks</li>
</ul></li>
<li><code>FK</code> – Shots from free kicks</li>
<li><code>PK</code> – Penalty Kicks Made</li>
<li><code>PKatt</code> – Penalty Kicks Attempted #### Expected</li>
<li><code>xG</code> – Expected Goals</li>
<li><code>xG</code> totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).
<ul>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>npxG</code> – Non-Penalty Expected Goals
<ul>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>npxG/Sh</code> – Non-Penalty Expected Goals per shot
<ul>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
<li>Minimum .395 shots per squad game to qualify as a leader</li>
</ul></li>
<li><code>G-xG</code> – Goals minus Expected Goals</li>
<li><code>xG</code> totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).
<ul>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>np:G-xG</code> – Non-Penalty Goals minus Non-Penalty Expected Goals
<ul>
<li>xG totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
</ul>
</section>
</section>
<section id="goalkeeping" class="level3">
<h3 class="anchored" data-anchor-id="goalkeeping">Goalkeeping</h3>
<section id="performance" class="level4">
<h4 class="anchored" data-anchor-id="performance">Performance</h4>
<ul>
<li><code>SoTA</code> – Shots on Target Against</li>
<li><code>GA</code> – Goals Against</li>
<li><code>Save%</code> – Save Percentage
<ul>
<li>(Shots on Target Against - Goals Against)/Shots on Target Against</li>
<li>Note that not all shots on target are stopped by the keeper, many will be stopped by defenders</li>
<li>Does not include penalty kicks</li>
</ul></li>
<li><code>CS</code> – Clean Sheets
<ul>
<li>Full matches by goalkeeper where no goals are allowed.</li>
</ul></li>
<li><code>PSxG</code> – Post-Shot Expected Goals
<ul>
<li>PSxG is expected goals based on how likely the goalkeeper is to save the shot</li>
<li>xG totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>PSxG+/-</code> – Post-Shot Expected Goals minus Goals Allowed
<ul>
<li>Positive numbers suggest better luck or an above average ability to stop shots</li>
<li>PSxG is expected goals based on how likely the goalkeeper is to save the shot</li>
<li>Note: Does not include own goals</li>
<li>xG totals include penalty kicks, but do not include penalty shootouts (unless otherwise noted).</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available. #### Penalty Kicks</li>
</ul></li>
<li><code>PKatt</code> – Penalty Kicks Attempted</li>
<li><code>PKA</code>– Penalty Kicks Allowed</li>
<li><code>PKsv</code> – Penalty Kicks Saved</li>
<li><code>PKm</code>– Penalty Kicks Missed #### Launched</li>
<li><code>Cmp</code> – Passes Completed
<ul>
<li>Passes` longer than 40 yards</li>
</ul></li>
<li><code>Att</code> – Passes Attempted
<ul>
<li>Passes longer than 40 yards</li>
</ul></li>
<li><code>Cmp%</code> – Pass Completion Percentage
<ul>
<li>Passes longer than 40 yards #### Passes</li>
</ul></li>
<li><code>Att</code> – Passes Attempted
<ul>
<li>Not including goal kicks</li>
</ul></li>
<li><code>Thr</code> – Throws Attempted</li>
<li><code>Launch%</code> – Percentage of Passes that were Launched
<ul>
<li>Not including goal kicks</li>
<li>Passes longer than 40 yards</li>
</ul></li>
<li><code>AvgLen</code> – Average length of passes, in yards
<ul>
<li>Not including goal kicks #### Goal Kicks</li>
</ul></li>
<li><code>Att</code> – Goal Kicks Attempted</li>
<li><code>Launch%</code> – Percentage of Goal Kicks that were Launched
<ul>
<li>Passes longer than 40 yards</li>
</ul></li>
<li><code>AvgLen</code> – Average length of goal kicks, in yards #### Crosses</li>
<li><code>Opp</code> – Opponent’s attempted crosses into penalty area</li>
<li><code>Stp</code> – Number of crosses into penalty area which were successfully stopped by the goalkeeper</li>
<li><code>Stp%</code> – Percentage of crosses into penalty area which were successfully stopped by the goalkeeper #### Sweeper</li>
<li><code>#OPA</code> – # of defensive actions outside of penalty area</li>
<li><code>AvgDist</code> – Average distance from goal (in yards) of all defensive actions</li>
</ul>
</section>
</section>
<section id="passing" class="level3">
<h3 class="anchored" data-anchor-id="passing">Passing</h3>
<section id="total" class="level4">
<h4 class="anchored" data-anchor-id="total">Total</h4>
<ul>
<li><code>Cmp</code> – Passes Completed</li>
<li><code>Att</code> – Passes Attempted</li>
<li><code>Cmp%</code> – Pass Completion Percentage
<ul>
<li>Minimum 30 minutes played per squad game to qualify as a leader</li>
</ul></li>
<li><code>TotDist</code> – Total distance, in yards, that completed passes have traveled in any direction</li>
<li><code>PrgDist</code> – Progressive Distance
<ul>
<li>Total distance, in yards, that completed passes have traveled towards the opponent’s goal. Note: Passes away from opponent’s goal are counted as zero progressive yards. #### Short</li>
</ul></li>
<li><code>Cmp</code> – Passes Completed
<ul>
<li>Passes between 5 and 15 yards</li>
</ul></li>
<li><code>Att</code> – Passes Attempted
<ul>
<li>Passes between 5 and 15 yards</li>
</ul></li>
<li><code>Cmp%</code> – Pass Completion Percentage
<ul>
<li>Passes between 5 and 15 yards</li>
<li>Minimum 30 minutes played per squad game to qualify as a leader #### Medium</li>
</ul></li>
<li><code>Cmp</code> – Passes Completed
<ul>
<li>Passes between 15 and 30 yards</li>
</ul></li>
<li><code>Att</code> – Passes Attempted
<ul>
<li>Passes between 15 and 30 yards</li>
</ul></li>
<li><code>Cmp%</code> – Pass Completion Percentage
<ul>
<li>Passes between 15 and 30 yards</li>
<li>Minimum 30 minutes played per squad game to qualify as a leader #### Long</li>
</ul></li>
<li><code>Cmp</code> – Passes Completed
<ul>
<li>Passes longer than 30 yards</li>
</ul></li>
<li><code>Att</code> – Passes Attempted
<ul>
<li>Passes longer than 30 yards</li>
</ul></li>
<li><code>Cmp%</code> – Pass Completion Percentage
<ul>
<li>Passes longer than 30 yards</li>
<li>Minimum 30 minutes played per squad game to qualify as a leader #### Others</li>
</ul></li>
<li><code>Ast</code> – Assists</li>
<li><code>xA</code> – xG Assisted
<ul>
<li>xG which follows a pass that assists a shot</li>
<li>Provided by StatsBomb.</li>
<li>An underline indicates there is a match that is missing data, but will be updated when available.</li>
</ul></li>
<li><code>KP</code> – Passes that directly lead to a shot (assisted shots)</li>
<li><code>1/3</code> – Completed passes that enter the 1/3 of the pitch closest to the goal
<ul>
<li>Not including set pieces</li>
</ul></li>
<li><code>PPA</code> – Completed passes into the 18-yard box
<ul>
<li>Not including set pieces</li>
</ul></li>
<li><code>CrsPA</code> – Completed crosses into the 18-yard box
<ul>
<li>Not including set pieces</li>
</ul></li>
<li><code>Prog</code> – Progressive Passes
<ul>
<li>Completed passes that move the ball towards the opponent’s goal at least 10 yards from its furthest point in the last six passes, or any completed pass into the penalty area. Excludes passes from the defending 40% of the pitch</li>
</ul></li>
</ul>
</section>
</section>
<section id="pass-types" class="level3">
<h3 class="anchored" data-anchor-id="pass-types">Pass Types</h3>
<section id="total-1" class="level4">
<h4 class="anchored" data-anchor-id="total-1">Total</h4>
<ul>
<li><code>Att</code> – Passes Attempted #### Pass Types</li>
<li><code>Live</code> – Live-ball passes</li>
<li><code>Dead</code> – Dead-ball passes
<ul>
<li>Includes free kicks, corner kicks, kick offs, throw-ins and goal kicks</li>
</ul></li>
<li><code>FK</code> – Passes attempted from free kicks</li>
<li><code>TB</code> – Completed pass sent between back defenders into open space</li>
<li><code>Press</code> – Passes made while under pressure from opponent</li>
<li><code>Sw</code> – Passes that travel more than 40 yards of the width of the pitch</li>
<li><code>Crs</code> – Crosses</li>
<li><code>CK</code> – Corner Kicks</li>
</ul>
</section>
<section id="corner-kicks" class="level4">
<h4 class="anchored" data-anchor-id="corner-kicks">Corner Kicks</h4>
<ul>
<li><code>In</code> – Inswinging Corner Kicks</li>
<li><code>Out</code> – Outswinging Corner Kicks</li>
<li><code>Str</code> – Straight Corner Kicks #### Height</li>
<li><code>Ground</code> – Ground passes</li>
<li><code>Low</code> – Passes that leave the ground, but stay below shoulder-level</li>
<li><code>High</code> – Passes that are above shoulder-level at the peak height #### Body Parts</li>
<li><code>Left</code> – Passes attempted using left foot</li>
<li><code>Right</code> – Passes attempted using right foot</li>
<li><code>Head</code> – Passes attempted using head</li>
<li><code>TI</code> – Throw-Ins taken</li>
<li><code>Other</code> – Passes attempted using body parts other than the player’s head or feet #### Outcomes</li>
<li><code>Cmp</code> – Passes Completed</li>
<li><code>Off</code> – Offsides</li>
<li><code>Out</code> – Out of bounds</li>
<li><code>Int</code> – Intercepted</li>
<li><code>Blocks</code> – Blocked by the opponent who was standing it the path</li>
</ul>
</section>
</section>
<section id="goal-and-shot-creation" class="level3">
<h3 class="anchored" data-anchor-id="goal-and-shot-creation">Goal and Shot Creation</h3>
<section id="sca-types" class="level4">
<h4 class="anchored" data-anchor-id="sca-types">SCA Types</h4>
<ul>
<li><code>SCA</code> – Shot-Creating Actions
<ul>
<li>The two offensive actions directly leading to a shot, such as passes, dribbles and drawing fouls. Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit.</li>
</ul></li>
<li><code>PassLive</code> – Completed live-ball passes that lead to a shot attempt</li>
<li><code>PassDead</code> – Completed dead-ball passes that lead to a shot attempt.
<ul>
<li>Includes free kicks, corner kicks, kick offs, throw-ins and goal kicks</li>
</ul></li>
<li><code>Drib</code> – Successful dribbles that lead to a shot attempt</li>
<li><code>Sh</code> – Shots that lead to another shot attempt</li>
<li><code>Fld</code> – Fouls drawn that lead to a shot attempt</li>
<li><code>Def</code> – Defensive actions that lead to a shot attempt #### GCA Types</li>
<li><code>GCA</code> – Goal-Creating Actions
<ul>
<li>The two offensive actions directly leading to a goal, such as passes, dribbles and drawing fouls. Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit.</li>
</ul></li>
<li><code>PassLive</code> – Completed live-ball passes that lead to a goal</li>
<li><code>PassDead</code> – Completed dead-ball passes that lead to a goal. Includes free kicks, corner kicks, kick offs, throw-ins and goal kicks</li>
<li><code>Drib</code> – Successful dribbles that lead to a goal</li>
<li><code>Sh</code> – Shots that lead to another goal-scoring shot</li>
<li><code>Fld</code> – Fouls drawn that lead to a goal</li>
<li><code>Def</code> – Defensive actions that lead to a goal</li>
</ul>
</section>
</section>
<section id="defensive-actions" class="level3">
<h3 class="anchored" data-anchor-id="defensive-actions">Defensive Actions</h3>
</section>
<section id="tackles" class="level3">
<h3 class="anchored" data-anchor-id="tackles">Tackles</h3>
<ul>
<li><code>Tkl</code> – Number of players tackled</li>
<li><code>TklW</code> – Tackles in which the tackler’s team won possession of the ball</li>
<li><code>Def 3rd</code> – Tackles in defensive 1/3</li>
<li><code>Mid 3rd</code> – Tackles in middle 1/3</li>
<li><code>Att 3rd</code> – Tackles in attacking 1/3</li>
</ul>
<section id="vs-dribbles" class="level4">
<h4 class="anchored" data-anchor-id="vs-dribbles">Vs Dribbles</h4>
<ul>
<li><code>Tkl</code> – Number of dribblers tackled</li>
<li><code>Att</code> – Number of times dribbled past plus number of tackles</li>
<li><code>Tkl%</code> – Percentage of dribblers tackled
<ul>
<li>Dribblers tackled divided by dribblers tackled plus times dribbled past</li>
<li>Minimum .625 dribblers contested per squad game to qualify as a leader</li>
</ul></li>
<li><code>Past</code> – Number of times dribbled past by an opposing player</li>
</ul>
</section>
<section id="pressures" class="level4">
<h4 class="anchored" data-anchor-id="pressures">Pressures</h4>
<ul>
<li><code>Press</code> – Number of times applying pressure to opposing player who is receiving, carrying or releasing the ball</li>
<li><code>Succ</code> – Number of times the squad gained possession withing five seconds of applying pressure</li>
<li><code>%</code> – Successful Pressure Percentage
<ul>
<li>Percentage of time the squad gained possession withing five seconds of applying pressure</li>
<li>Minimum 6.44 pressures per squad game to qualify as a leader</li>
</ul></li>
<li><code>Def 3rd</code> – Number of times applying pressure to opposing player who is receiving, carrying or releasing the ball, in the defensive 1/3</li>
<li><code>Mid 3rd</code> – Number of times applying pressure to opposing player who is receiving, carrying or releasing the ball, in the middle 1/3</li>
<li><code>Att 3rd</code> – Number of times applying pressure to opposing player who is receiving, carrying or releasing the ball, in the attacking 1/3</li>
</ul>
</section>
<section id="blocks" class="level4">
<h4 class="anchored" data-anchor-id="blocks">Blocks</h4>
<ul>
<li><code>Blocks</code> – Number of times blocking the ball by standing in its path</li>
<li><code>Sh</code> – Number of times blocking a shot by standing in its path</li>
<li><code>ShSv</code> – Number of times blocking a shot that was on target, by standing in its path</li>
<li><code>Pass</code> – Number of times blocking a pass by standing in its path</li>
<li><code>Int</code> – Interceptions</li>
<li><code>Tkl+Int</code> – Number of players tackled plus number of interceptions</li>
<li><code>Clr</code> – Clearances</li>
<li><code>Err</code> – Mistakes leading to an opponent’s shot</li>
</ul>
</section>
</section>
<section id="possession" class="level3">
<h3 class="anchored" data-anchor-id="possession">Possession</h3>
<ul>
<li><code>Poss</code> – Possession
<ul>
<li>Calculated as the percentage of passes attempted #### Touches</li>
</ul></li>
<li><code>Touches</code> – Number of times a player touched the ball. Note: Receiving a pass, then dribbling, then sending a pass counts as one touch</li>
<li><code>Def Pen</code> – Touches in defensive penalty area</li>
<li><code>Def 3rd</code> – Touches in defensive 1/3</li>
<li><code>Mid 3rd</code> – Touches in middle 1/3</li>
<li><code>Att 3rd</code> – Touches in attacking 1/3</li>
<li><code>Att Pen</code> – Touches in attacking penalty area</li>
<li><code>Live</code> – Live-ball touches. Does not include corner kicks, free kicks, throw-ins, kick-offs, goal kicks or penalty kicks #### Dribbles</li>
<li><code>Succ</code> – Dribbles Completed Successfully</li>
<li><code>Att</code> – Dribbles Attempted</li>
<li><code>Succ%</code> – Percentage of Dribbles Completed Successfully
<ul>
<li>Minimum .5 dribbles per squad game to qualify as a leader</li>
</ul></li>
<li><code>#Pl</code> – Number of Players Dribbled Past</li>
<li><code>Megs</code> – Number of times a player dribbled the ball through an opposing player’s legs</li>
</ul>
<section id="carries" class="level4">
<h4 class="anchored" data-anchor-id="carries">Carries</h4>
<ul>
<li><code>Carries</code> – Number of times the player controlled the ball with their feet</li>
<li><code>TotDist</code> – Total distance, in yards, a player moved the ball while controlling - it with their feet, in any direction</li>
<li><code>PrgDist</code> – Progressive Distance
<ul>
<li>Total distance, in yards, a player moved the ball while controlling it with - their feet towards the opponent’s goal</li>
</ul></li>
<li><code>Prog</code> – Carries that move the ball towards the opponent’s goal at least 5 - yards, or any carry into the penalty area. Excludes carries from the defending 40% of the pitch</li>
<li><code>1/3</code> – Carries that enter the 1/3 of the pitch closest to the goal</li>
<li><code>CPA</code> – Carries into the 18-yard box</li>
<li><code>Mis</code> – Number of times a player failed when attempting to gain control of a ball</li>
<li><code>Dis</code> – Number of times a player loses control of the ball after being tackled - by an opposing player. Does not include attempted dribbles</li>
</ul>
</section>
<section id="receiving" class="level4">
<h4 class="anchored" data-anchor-id="receiving">Receiving</h4>
<ul>
<li><code>Targ</code> – Number of times a player was the target of an attempted pass</li>
<li><code>Rec</code> – Number of times a player successfully received a pass</li>
<li><code>Rec%</code> – Passes Received Percentage
<ul>
<li>Percentage of time a player successfully received a pass</li>
<li>Minimum 30 minutes played per squad game to qualify as a leader</li>
</ul></li>
<li><code>Prog</code> – Progressive Passes Received
<ul>
<li>Completed passes that move the ball towards the opponent’s goal at least 10 yards from its furthest point in the last six passes, or any completed pass into the penalty area. Excludes passes from the defending 40% of the pitch</li>
</ul></li>
</ul>
</section>
</section>
<section id="miscellaneous-stats" class="level3">
<h3 class="anchored" data-anchor-id="miscellaneous-stats">Miscellaneous Stats</h3>
<section id="performance-1" class="level4">
<h4 class="anchored" data-anchor-id="performance-1">Performance</h4>
<ul>
<li><code>CrdY</code>– Yellow Cards</li>
<li><code>CrdR</code>– Red Cards</li>
<li><code>2CrdY</code> – Second Yellow Card</li>
<li><code>Fls</code>- Fouls Committed</li>
<li><code>Fld</code> – Fouls Drawn</li>
<li><code>Off</code> – Offsides</li>
<li><code>Crs</code> – Crosses</li>
<li><code>Int</code> – Interceptions</li>
<li><code>TklW</code>– Tackles in which the tackler’s team won possession of the ball</li>
<li><code>PKwon</code> – Penalty Kicks Won</li>
<li><code>PKcon</code> – Penalty Kicks Conceded</li>
<li><code>OG --</code> Own Goals</li>
<li><code>Recov</code> – Number of loose balls recovered #### Aerial Duels</li>
<li><code>Won</code> – Aerials won</li>
<li><code>Lost</code> – Aerials lost</li>
<li><code>Won%</code> – Percentage of aerials won Minimum .97 aerial duels per squad game to qualify as a leader</li>
</ul>
</section>
</section>
</section>
<section id="prepare-the-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-the-data">Prepare the data</h2>
<div class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>cwd<span class="op">=</span>os.getcwd()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>cwd<span class="op">=</span>os.getcwd()</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>folda<span class="op">=</span>cwd<span class="op">+</span><span class="st">"/data/epl/"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>dira <span class="op">=</span> os.listdir(folda)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>dira</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="289">
<pre><code>['dfEPL_2017.csv',
 'dfEPL_2018.csv',
 'dfEPL_2019.csv',
 'dfEPL_2020.csv',
 'dfEPL_2021.csv',
 'epl2017-2021.csv',
 'epl2017-2021_wivnetscore.csv',
 'epl2017-2021_wivnetscoreAndGFGA_both-HA.csv',
 'epl2017-2021_wivnetscoreAndGFGA_both-HA_modPC.csv',
 'epl2017-2021_wivnetscore_both-HA.csv',
 'epl_beforeAVG_HA.csv']</code></pre>
</div>
</div>
<p>Load the data and combine in one big DataFrame</p>
<div class="cell" data-execution_count="290">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> dira:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> d[<span class="dv">0</span>]<span class="op">==</span><span class="st">'d'</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(folda<span class="op">+</span>d,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'Season'</span>]<span class="op">=</span><span class="bu">int</span>(d.split(<span class="st">'.'</span>)[<span class="dv">0</span>].split(<span class="st">'_'</span>)[<span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            dfAll<span class="op">=</span>df</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            i<span class="op">=</span>i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            dfAll<span class="op">=</span>pd.concat([dfAll,df])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_columns"</span>, <span class="va">None</span>):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    display(dfAll)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Date</th>
      <th>Time</th>
      <th>Comp</th>
      <th>Round</th>
      <th>Day</th>
      <th>Venue</th>
      <th>Result</th>
      <th>GF</th>
      <th>GA</th>
      <th>Opponent</th>
      <th>Gls</th>
      <th>Sh_shooting</th>
      <th>SoT</th>
      <th>SoT%</th>
      <th>G/Sh</th>
      <th>G/SoT</th>
      <th>Dist</th>
      <th>FK_shooting</th>
      <th>PK</th>
      <th>PKatt_shooting</th>
      <th>xG</th>
      <th>npxG</th>
      <th>npxG/Sh</th>
      <th>G-xG</th>
      <th>np:G-xG</th>
      <th>Match Report</th>
      <th>SoTA</th>
      <th>Saves</th>
      <th>Save%</th>
      <th>CS</th>
      <th>PSxG</th>
      <th>PSxG+/-</th>
      <th>PKatt_keeper</th>
      <th>PKA</th>
      <th>PKsv</th>
      <th>PKm</th>
      <th>Cmp_keeper</th>
      <th>Att_keeper</th>
      <th>Cmp%_keeper</th>
      <th>Att_keeper.1</th>
      <th>Thr</th>
      <th>Launch%</th>
      <th>AvgLen</th>
      <th>Att_keeper.2</th>
      <th>Launch%.1</th>
      <th>AvgLen.1</th>
      <th>Opp</th>
      <th>Stp</th>
      <th>Stp%</th>
      <th>#OPA</th>
      <th>AvgDist</th>
      <th>Cmp_passing</th>
      <th>Att_passing</th>
      <th>Cmp%_passing</th>
      <th>TotDist_passing</th>
      <th>PrgDist_passing</th>
      <th>Cmp_passing.1</th>
      <th>Att_passing.1</th>
      <th>Cmp%_passing.1</th>
      <th>Cmp_passing.2</th>
      <th>Att_passing.2</th>
      <th>Cmp%_passing.2</th>
      <th>Cmp_passing.3</th>
      <th>Att_passing.3</th>
      <th>Cmp%_passing.3</th>
      <th>Ast</th>
      <th>xA</th>
      <th>KP</th>
      <th>1/3_passing</th>
      <th>PPA</th>
      <th>CrsPA</th>
      <th>Prog_passing</th>
      <th>Att_passing_types</th>
      <th>Live_passing_types</th>
      <th>Dead</th>
      <th>FK_passing_types</th>
      <th>TB</th>
      <th>Press_passing_types</th>
      <th>Sw</th>
      <th>Crs_passing_types</th>
      <th>CK</th>
      <th>In</th>
      <th>Out</th>
      <th>Str</th>
      <th>Ground</th>
      <th>Low</th>
      <th>High</th>
      <th>Left</th>
      <th>Right</th>
      <th>Head</th>
      <th>TI</th>
      <th>Other</th>
      <th>Cmp_passing_types</th>
      <th>Off_passing_types</th>
      <th>Out.1</th>
      <th>Int_passing_types</th>
      <th>Blocks_passing_types</th>
      <th>SCA</th>
      <th>PassLive</th>
      <th>PassDead</th>
      <th>Drib</th>
      <th>Sh_gca</th>
      <th>Fld_gca</th>
      <th>Def</th>
      <th>GCA</th>
      <th>PassLive.1</th>
      <th>PassDead.1</th>
      <th>Drib.1</th>
      <th>Sh_gca.1</th>
      <th>Fld_gca.1</th>
      <th>Def.1</th>
      <th>Tkl</th>
      <th>TklW_defense</th>
      <th>Def 3rd_defense</th>
      <th>Mid 3rd_defense</th>
      <th>Att 3rd_defense</th>
      <th>Tkl.1</th>
      <th>Att_defense</th>
      <th>Tkl%</th>
      <th>Past</th>
      <th>Press_defense</th>
      <th>Succ_defense</th>
      <th>%</th>
      <th>Def 3rd_defense.1</th>
      <th>Mid 3rd_defense.1</th>
      <th>Att 3rd_defense.1</th>
      <th>Blocks_defense</th>
      <th>Sh_defense</th>
      <th>ShSv</th>
      <th>Pass</th>
      <th>Int_defense</th>
      <th>Tkl+Int</th>
      <th>Clr</th>
      <th>Err</th>
      <th>Poss</th>
      <th>Touches</th>
      <th>Def Pen</th>
      <th>Def 3rd_possession</th>
      <th>Mid 3rd_possession</th>
      <th>Att 3rd_possession</th>
      <th>Att Pen</th>
      <th>Live_possession</th>
      <th>Succ_possession</th>
      <th>Att_possession</th>
      <th>Succ%</th>
      <th>#Pl</th>
      <th>Megs</th>
      <th>Carries</th>
      <th>TotDist_possession</th>
      <th>PrgDist_possession</th>
      <th>Prog_possession</th>
      <th>1/3_possession</th>
      <th>CPA</th>
      <th>Mis</th>
      <th>Dis</th>
      <th>Targ</th>
      <th>Rec</th>
      <th>Rec%</th>
      <th>Prog_possession.1</th>
      <th>CrdY</th>
      <th>CrdR</th>
      <th>2CrdY</th>
      <th>Fls</th>
      <th>Fld_misc</th>
      <th>Off_misc</th>
      <th>Crs_misc</th>
      <th>Int_misc</th>
      <th>TklW_misc</th>
      <th>PKwon</th>
      <th>PKcon</th>
      <th>OG</th>
      <th>Recov</th>
      <th>Won</th>
      <th>Lost</th>
      <th>Won%</th>
      <th>team</th>
      <th>Season</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-08-12</td>
      <td>17:30</td>
      <td>Premier League</td>
      <td>Matchweek 1</td>
      <td>Sat</td>
      <td>Away</td>
      <td>W</td>
      <td>2</td>
      <td>0</td>
      <td>Brighton</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>4.0</td>
      <td>28.6</td>
      <td>0.07</td>
      <td>0.25</td>
      <td>19.4</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.8</td>
      <td>1.8</td>
      <td>0.14</td>
      <td>-0.8</td>
      <td>-0.8</td>
      <td>Match Report</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>1.0</td>
      <td>0.4</td>
      <td>0.4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>40.0</td>
      <td>20.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>22.5</td>
      <td>4.0</td>
      <td>75.0</td>
      <td>56.8</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>24.2</td>
      <td>712.0</td>
      <td>808.0</td>
      <td>88.1</td>
      <td>13422.0</td>
      <td>3465.0</td>
      <td>297.0</td>
      <td>320.0</td>
      <td>92.8</td>
      <td>315.0</td>
      <td>346.0</td>
      <td>91.0</td>
      <td>89.0</td>
      <td>117.0</td>
      <td>76.1</td>
      <td>1.0</td>
      <td>1.1</td>
      <td>9.0</td>
      <td>69.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>60.0</td>
      <td>808.0</td>
      <td>766.0</td>
      <td>42.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>63.0</td>
      <td>28.0</td>
      <td>16.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>612.0</td>
      <td>105.0</td>
      <td>91.0</td>
      <td>182.0</td>
      <td>570.0</td>
      <td>20.0</td>
      <td>17.0</td>
      <td>10.0</td>
      <td>712.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>19.0</td>
      <td>17.0</td>
      <td>22.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>14.0</td>
      <td>28.6</td>
      <td>10.0</td>
      <td>104.0</td>
      <td>28.0</td>
      <td>26.9</td>
      <td>25.0</td>
      <td>42.0</td>
      <td>37.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>77.0</td>
      <td>902.0</td>
      <td>30.0</td>
      <td>146.0</td>
      <td>484.0</td>
      <td>329.0</td>
      <td>31.0</td>
      <td>858.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>53.3</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>646.0</td>
      <td>3346.0</td>
      <td>1924.0</td>
      <td>91.0</td>
      <td>27.0</td>
      <td>3.0</td>
      <td>15.0</td>
      <td>4.0</td>
      <td>794.0</td>
      <td>712.0</td>
      <td>89.7</td>
      <td>60.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>85.0</td>
      <td>19.0</td>
      <td>17.0</td>
      <td>52.8</td>
      <td>ManchesterCity</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-08-21</td>
      <td>20:00</td>
      <td>Premier League</td>
      <td>Matchweek 2</td>
      <td>Mon</td>
      <td>Home</td>
      <td>D</td>
      <td>1</td>
      <td>1</td>
      <td>Everton</td>
      <td>1.0</td>
      <td>20.0</td>
      <td>6.0</td>
      <td>30.0</td>
      <td>0.05</td>
      <td>0.17</td>
      <td>18.9</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>1.2</td>
      <td>0.06</td>
      <td>-0.2</td>
      <td>-0.2</td>
      <td>Match Report</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>50.0</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>-0.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>70.0</td>
      <td>27.0</td>
      <td>5.0</td>
      <td>25.9</td>
      <td>33.5</td>
      <td>6.0</td>
      <td>50.0</td>
      <td>46.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>66.7</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>497.0</td>
      <td>611.0</td>
      <td>81.3</td>
      <td>9615.0</td>
      <td>3476.0</td>
      <td>199.0</td>
      <td>228.0</td>
      <td>87.3</td>
      <td>217.0</td>
      <td>254.0</td>
      <td>85.4</td>
      <td>72.0</td>
      <td>110.0</td>
      <td>65.5</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>39.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>67.0</td>
      <td>611.0</td>
      <td>556.0</td>
      <td>55.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>135.0</td>
      <td>24.0</td>
      <td>14.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>389.0</td>
      <td>113.0</td>
      <td>109.0</td>
      <td>158.0</td>
      <td>370.0</td>
      <td>22.0</td>
      <td>29.0</td>
      <td>10.0</td>
      <td>497.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>33.0</td>
      <td>27.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>14.0</td>
      <td>50.0</td>
      <td>7.0</td>
      <td>127.0</td>
      <td>42.0</td>
      <td>33.1</td>
      <td>42.0</td>
      <td>51.0</td>
      <td>34.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>63.0</td>
      <td>732.0</td>
      <td>47.0</td>
      <td>190.0</td>
      <td>374.0</td>
      <td>227.0</td>
      <td>42.0</td>
      <td>678.0</td>
      <td>6.0</td>
      <td>15.0</td>
      <td>40.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>447.0</td>
      <td>2863.0</td>
      <td>1715.0</td>
      <td>77.0</td>
      <td>25.0</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>16.0</td>
      <td>580.0</td>
      <td>497.0</td>
      <td>85.7</td>
      <td>67.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>13.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>108.0</td>
      <td>28.0</td>
      <td>14.0</td>
      <td>66.7</td>
      <td>ManchesterCity</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-08-26</td>
      <td>12:30</td>
      <td>Premier League</td>
      <td>Matchweek 3</td>
      <td>Sat</td>
      <td>Away</td>
      <td>W</td>
      <td>2</td>
      <td>1</td>
      <td>Bournemouth</td>
      <td>2.0</td>
      <td>18.0</td>
      <td>8.0</td>
      <td>44.4</td>
      <td>0.11</td>
      <td>0.25</td>
      <td>16.4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.6</td>
      <td>1.6</td>
      <td>0.09</td>
      <td>0.4</td>
      <td>0.4</td>
      <td>Match Report</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>66.7</td>
      <td>0.0</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>33.3</td>
      <td>17.0</td>
      <td>6.0</td>
      <td>11.8</td>
      <td>26.9</td>
      <td>1.0</td>
      <td>100.0</td>
      <td>98.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>14.3</td>
      <td>0.0</td>
      <td>18.6</td>
      <td>568.0</td>
      <td>676.0</td>
      <td>84.0</td>
      <td>10625.0</td>
      <td>3119.0</td>
      <td>243.0</td>
      <td>268.0</td>
      <td>90.7</td>
      <td>240.0</td>
      <td>280.0</td>
      <td>85.7</td>
      <td>78.0</td>
      <td>107.0</td>
      <td>72.9</td>
      <td>2.0</td>
      <td>1.3</td>
      <td>12.0</td>
      <td>47.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>48.0</td>
      <td>676.0</td>
      <td>621.0</td>
      <td>55.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>96.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>445.0</td>
      <td>126.0</td>
      <td>105.0</td>
      <td>201.0</td>
      <td>377.0</td>
      <td>30.0</td>
      <td>35.0</td>
      <td>7.0</td>
      <td>568.0</td>
      <td>3.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>22.0</td>
      <td>26.0</td>
      <td>18.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>11.0</td>
      <td>9.1</td>
      <td>10.0</td>
      <td>91.0</td>
      <td>29.0</td>
      <td>31.9</td>
      <td>15.0</td>
      <td>38.0</td>
      <td>38.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>71.0</td>
      <td>802.0</td>
      <td>54.0</td>
      <td>191.0</td>
      <td>403.0</td>
      <td>268.0</td>
      <td>41.0</td>
      <td>748.0</td>
      <td>11.0</td>
      <td>17.0</td>
      <td>64.7</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>566.0</td>
      <td>2875.0</td>
      <td>1691.0</td>
      <td>77.0</td>
      <td>25.0</td>
      <td>5.0</td>
      <td>25.0</td>
      <td>15.0</td>
      <td>653.0</td>
      <td>568.0</td>
      <td>87.0</td>
      <td>56.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>17.0</td>
      <td>8.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>119.0</td>
      <td>30.0</td>
      <td>11.0</td>
      <td>73.2</td>
      <td>ManchesterCity</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-09-09</td>
      <td>12:30</td>
      <td>Premier League</td>
      <td>Matchweek 4</td>
      <td>Sat</td>
      <td>Home</td>
      <td>W</td>
      <td>5</td>
      <td>0</td>
      <td>Liverpool</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>10.0</td>
      <td>76.9</td>
      <td>0.38</td>
      <td>0.50</td>
      <td>14.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.7</td>
      <td>2.7</td>
      <td>0.21</td>
      <td>2.3</td>
      <td>2.3</td>
      <td>Match Report</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>100.0</td>
      <td>2.0</td>
      <td>0.5</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>62.5</td>
      <td>30.0</td>
      <td>5.0</td>
      <td>23.3</td>
      <td>33.6</td>
      <td>3.0</td>
      <td>33.3</td>
      <td>50.3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>16.0</td>
      <td>694.0</td>
      <td>773.0</td>
      <td>89.8</td>
      <td>13656.0</td>
      <td>3583.0</td>
      <td>254.0</td>
      <td>268.0</td>
      <td>94.8</td>
      <td>338.0</td>
      <td>365.0</td>
      <td>92.6</td>
      <td>94.0</td>
      <td>122.0</td>
      <td>77.0</td>
      <td>5.0</td>
      <td>2.6</td>
      <td>11.0</td>
      <td>32.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>44.0</td>
      <td>773.0</td>
      <td>729.0</td>
      <td>44.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>111.0</td>
      <td>22.0</td>
      <td>20.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>631.0</td>
      <td>73.0</td>
      <td>69.0</td>
      <td>241.0</td>
      <td>475.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>6.0</td>
      <td>694.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>18.0</td>
      <td>11.0</td>
      <td>23.0</td>
      <td>17.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.0</td>
      <td>14.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>7.0</td>
      <td>21.0</td>
      <td>33.3</td>
      <td>14.0</td>
      <td>135.0</td>
      <td>43.0</td>
      <td>31.9</td>
      <td>33.0</td>
      <td>62.0</td>
      <td>40.0</td>
      <td>10.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>18.0</td>
      <td>0.0</td>
      <td>65.0</td>
      <td>878.0</td>
      <td>51.0</td>
      <td>182.0</td>
      <td>588.0</td>
      <td>152.0</td>
      <td>26.0</td>
      <td>835.0</td>
      <td>3.0</td>
      <td>12.0</td>
      <td>25.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>678.0</td>
      <td>2392.0</td>
      <td>1341.0</td>
      <td>54.0</td>
      <td>17.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>754.0</td>
      <td>694.0</td>
      <td>92.0</td>
      <td>44.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>20.0</td>
      <td>16.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>62.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>60.0</td>
      <td>ManchesterCity</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-09-13</td>
      <td>20:45</td>
      <td>Champions Lg</td>
      <td>Group stage</td>
      <td>Wed</td>
      <td>Away</td>
      <td>W</td>
      <td>4</td>
      <td>0</td>
      <td>nl Feyenoord</td>
      <td>4.0</td>
      <td>11.0</td>
      <td>8.0</td>
      <td>72.7</td>
      <td>0.36</td>
      <td>0.50</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Match Report</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>100.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>12.0</td>
      <td>6.0</td>
      <td>22.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ManchesterCity</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2022-05-08</td>
      <td>14:00</td>
      <td>Premier League</td>
      <td>Matchweek 36</td>
      <td>Sun</td>
      <td>Home</td>
      <td>L</td>
      <td>0</td>
      <td>4</td>
      <td>West Ham</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>25.0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>21.5</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.7</td>
      <td>0.7</td>
      <td>0.08</td>
      <td>-0.7</td>
      <td>-0.7</td>
      <td>Match Report</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>2.3</td>
      <td>-1.7</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>10.0</td>
      <td>40.0</td>
      <td>25.0</td>
      <td>4.0</td>
      <td>28.0</td>
      <td>31.3</td>
      <td>5.0</td>
      <td>60.0</td>
      <td>52.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.3</td>
      <td>335.0</td>
      <td>412.0</td>
      <td>81.3</td>
      <td>6189.0</td>
      <td>2105.0</td>
      <td>140.0</td>
      <td>158.0</td>
      <td>88.6</td>
      <td>146.0</td>
      <td>162.0</td>
      <td>90.1</td>
      <td>42.0</td>
      <td>72.0</td>
      <td>58.3</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>5.0</td>
      <td>19.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>25.0</td>
      <td>412.0</td>
      <td>375.0</td>
      <td>37.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>36.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>306.0</td>
      <td>37.0</td>
      <td>69.0</td>
      <td>102.0</td>
      <td>275.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>335.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>11.0</td>
      <td>14.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>14.0</td>
      <td>21.4</td>
      <td>11.0</td>
      <td>161.0</td>
      <td>32.0</td>
      <td>19.9</td>
      <td>64.0</td>
      <td>65.0</td>
      <td>32.0</td>
      <td>16.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>21.0</td>
      <td>1.0</td>
      <td>37.0</td>
      <td>499.0</td>
      <td>66.0</td>
      <td>188.0</td>
      <td>215.0</td>
      <td>132.0</td>
      <td>19.0</td>
      <td>462.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>87.5</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>310.0</td>
      <td>1933.0</td>
      <td>1122.0</td>
      <td>55.0</td>
      <td>19.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>374.0</td>
      <td>335.0</td>
      <td>89.6</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>48.0</td>
      <td>NorwichCity</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2022-05-11</td>
      <td>19:45</td>
      <td>Premier League</td>
      <td>Matchweek 21</td>
      <td>Wed</td>
      <td>Away</td>
      <td>L</td>
      <td>0</td>
      <td>3</td>
      <td>Leicester City</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>5.0</td>
      <td>55.6</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>16.2</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.2</td>
      <td>1.2</td>
      <td>0.15</td>
      <td>-1.2</td>
      <td>-1.2</td>
      <td>Match Report</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>62.5</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>20.0</td>
      <td>15.0</td>
      <td>26.0</td>
      <td>3.0</td>
      <td>50.0</td>
      <td>38.9</td>
      <td>9.0</td>
      <td>77.8</td>
      <td>57.4</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>295.0</td>
      <td>367.0</td>
      <td>80.4</td>
      <td>5864.0</td>
      <td>2054.0</td>
      <td>132.0</td>
      <td>148.0</td>
      <td>89.2</td>
      <td>119.0</td>
      <td>133.0</td>
      <td>89.5</td>
      <td>41.0</td>
      <td>74.0</td>
      <td>55.4</td>
      <td>0.0</td>
      <td>0.8</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>22.0</td>
      <td>367.0</td>
      <td>323.0</td>
      <td>44.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>58.0</td>
      <td>18.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>250.0</td>
      <td>46.0</td>
      <td>71.0</td>
      <td>90.0</td>
      <td>238.0</td>
      <td>11.0</td>
      <td>18.0</td>
      <td>4.0</td>
      <td>295.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>20.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>16.0</td>
      <td>43.8</td>
      <td>9.0</td>
      <td>264.0</td>
      <td>56.0</td>
      <td>21.2</td>
      <td>102.0</td>
      <td>124.0</td>
      <td>38.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>26.0</td>
      <td>0.0</td>
      <td>36.0</td>
      <td>511.0</td>
      <td>95.0</td>
      <td>242.0</td>
      <td>194.0</td>
      <td>99.0</td>
      <td>19.0</td>
      <td>468.0</td>
      <td>6.0</td>
      <td>15.0</td>
      <td>40.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>310.0</td>
      <td>1330.0</td>
      <td>723.0</td>
      <td>26.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>17.0</td>
      <td>307.0</td>
      <td>295.0</td>
      <td>96.1</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>16.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>71.0</td>
      <td>8.0</td>
      <td>14.0</td>
      <td>36.4</td>
      <td>NorwichCity</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2022-05-15</td>
      <td>14:00</td>
      <td>Premier League</td>
      <td>Matchweek 37</td>
      <td>Sun</td>
      <td>Away</td>
      <td>D</td>
      <td>1</td>
      <td>1</td>
      <td>Wolves</td>
      <td>1.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>18.2</td>
      <td>0.09</td>
      <td>0.50</td>
      <td>13.4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.3</td>
      <td>1.3</td>
      <td>0.12</td>
      <td>-0.3</td>
      <td>-0.3</td>
      <td>Match Report</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>1.1</td>
      <td>0.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>22.0</td>
      <td>45.5</td>
      <td>25.0</td>
      <td>4.0</td>
      <td>60.0</td>
      <td>40.9</td>
      <td>14.0</td>
      <td>50.0</td>
      <td>40.6</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>275.0</td>
      <td>363.0</td>
      <td>75.8</td>
      <td>4915.0</td>
      <td>1856.0</td>
      <td>125.0</td>
      <td>143.0</td>
      <td>87.4</td>
      <td>112.0</td>
      <td>131.0</td>
      <td>85.5</td>
      <td>31.0</td>
      <td>73.0</td>
      <td>42.5</td>
      <td>1.0</td>
      <td>1.2</td>
      <td>9.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>363.0</td>
      <td>320.0</td>
      <td>43.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>40.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>243.0</td>
      <td>47.0</td>
      <td>73.0</td>
      <td>120.0</td>
      <td>199.0</td>
      <td>13.0</td>
      <td>19.0</td>
      <td>7.0</td>
      <td>275.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>15.0</td>
      <td>6.0</td>
      <td>19.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>22.0</td>
      <td>36.4</td>
      <td>14.0</td>
      <td>180.0</td>
      <td>41.0</td>
      <td>22.8</td>
      <td>99.0</td>
      <td>58.0</td>
      <td>23.0</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>37.0</td>
      <td>465.0</td>
      <td>96.0</td>
      <td>250.0</td>
      <td>173.0</td>
      <td>72.0</td>
      <td>14.0</td>
      <td>423.0</td>
      <td>12.0</td>
      <td>16.0</td>
      <td>75.0</td>
      <td>13.0</td>
      <td>2.0</td>
      <td>275.0</td>
      <td>1615.0</td>
      <td>844.0</td>
      <td>29.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>340.0</td>
      <td>275.0</td>
      <td>80.9</td>
      <td>14.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>22.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>53.0</td>
      <td>11.0</td>
      <td>16.0</td>
      <td>40.7</td>
      <td>NorwichCity</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2022-05-22</td>
      <td>16:00</td>
      <td>Premier League</td>
      <td>Matchweek 38</td>
      <td>Sun</td>
      <td>Home</td>
      <td>L</td>
      <td>0</td>
      <td>5</td>
      <td>Tottenham</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>NaN</td>
      <td>17.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.04</td>
      <td>-0.3</td>
      <td>-0.3</td>
      <td>Match Report</td>
      <td>12.0</td>
      <td>7.0</td>
      <td>58.3</td>
      <td>0.0</td>
      <td>4.6</td>
      <td>-0.4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>14.0</td>
      <td>28.6</td>
      <td>28.0</td>
      <td>7.0</td>
      <td>39.3</td>
      <td>39.1</td>
      <td>4.0</td>
      <td>75.0</td>
      <td>59.3</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>335.0</td>
      <td>422.0</td>
      <td>79.4</td>
      <td>7435.0</td>
      <td>1726.0</td>
      <td>99.0</td>
      <td>114.0</td>
      <td>86.8</td>
      <td>163.0</td>
      <td>184.0</td>
      <td>88.6</td>
      <td>71.0</td>
      <td>116.0</td>
      <td>61.2</td>
      <td>0.0</td>
      <td>0.2</td>
      <td>5.0</td>
      <td>18.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>21.0</td>
      <td>422.0</td>
      <td>383.0</td>
      <td>39.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>57.0</td>
      <td>24.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>299.0</td>
      <td>42.0</td>
      <td>81.0</td>
      <td>136.0</td>
      <td>244.0</td>
      <td>12.0</td>
      <td>17.0</td>
      <td>8.0</td>
      <td>335.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>16.0</td>
      <td>8.0</td>
      <td>12.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>5.0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>16.0</td>
      <td>18.8</td>
      <td>13.0</td>
      <td>117.0</td>
      <td>32.0</td>
      <td>27.4</td>
      <td>44.0</td>
      <td>40.0</td>
      <td>33.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>40.0</td>
      <td>505.0</td>
      <td>61.0</td>
      <td>206.0</td>
      <td>222.0</td>
      <td>101.0</td>
      <td>17.0</td>
      <td>466.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>46.2</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>344.0</td>
      <td>1648.0</td>
      <td>875.0</td>
      <td>42.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>11.0</td>
      <td>4.0</td>
      <td>417.0</td>
      <td>335.0</td>
      <td>80.3</td>
      <td>21.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>16.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>58.0</td>
      <td>9.0</td>
      <td>13.0</td>
      <td>40.9</td>
      <td>NorwichCity</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>43</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8-7-28</td>
      <td>32</td>
      <td>89</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>426.0</td>
      <td>131.0</td>
      <td>30.8</td>
      <td>0.06</td>
      <td>0.21</td>
      <td>18.1</td>
      <td>18.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>33.3</td>
      <td>31.0</td>
      <td>0.09</td>
      <td>-3.3</td>
      <td>-4.0</td>
      <td>NaN</td>
      <td>224.0</td>
      <td>142.0</td>
      <td>64.3</td>
      <td>9.0</td>
      <td>78.7</td>
      <td>-3.3</td>
      <td>13.0</td>
      <td>9.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>250.0</td>
      <td>649.0</td>
      <td>38.5</td>
      <td>1046.0</td>
      <td>194.0</td>
      <td>46.6</td>
      <td>39.6</td>
      <td>309.0</td>
      <td>52.4</td>
      <td>44.1</td>
      <td>350.0</td>
      <td>17.0</td>
      <td>4.9</td>
      <td>17.0</td>
      <td>12.9</td>
      <td>11974.0</td>
      <td>15658.0</td>
      <td>76.5</td>
      <td>242050.0</td>
      <td>81553.0</td>
      <td>4705.0</td>
      <td>5440.0</td>
      <td>86.5</td>
      <td>5095.0</td>
      <td>6038.0</td>
      <td>84.4</td>
      <td>1985.0</td>
      <td>3585.0</td>
      <td>55.4</td>
      <td>24.0</td>
      <td>22.7</td>
      <td>254.0</td>
      <td>705.0</td>
      <td>230.0</td>
      <td>47.0</td>
      <td>922.0</td>
      <td>15658.0</td>
      <td>13820.0</td>
      <td>1838.0</td>
      <td>475.0</td>
      <td>27.0</td>
      <td>2280.0</td>
      <td>518.0</td>
      <td>411.0</td>
      <td>164.0</td>
      <td>87.0</td>
      <td>61.0</td>
      <td>4.0</td>
      <td>10004.0</td>
      <td>2064.0</td>
      <td>3590.0</td>
      <td>4770.0</td>
      <td>8734.0</td>
      <td>721.0</td>
      <td>767.0</td>
      <td>253.0</td>
      <td>11974.0</td>
      <td>48.0</td>
      <td>315.0</td>
      <td>518.0</td>
      <td>399.0</td>
      <td>546.0</td>
      <td>368.0</td>
      <td>59.0</td>
      <td>30.0</td>
      <td>29.0</td>
      <td>40.0</td>
      <td>20.0</td>
      <td>32.0</td>
      <td>25.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>678.0</td>
      <td>429.0</td>
      <td>358.0</td>
      <td>256.0</td>
      <td>64.0</td>
      <td>256.0</td>
      <td>643.0</td>
      <td>39.8</td>
      <td>387.0</td>
      <td>6146.0</td>
      <td>1570.0</td>
      <td>25.5</td>
      <td>2410.0</td>
      <td>2488.0</td>
      <td>1248.0</td>
      <td>639.0</td>
      <td>207.0</td>
      <td>5.0</td>
      <td>432.0</td>
      <td>673.0</td>
      <td>NaN</td>
      <td>840.0</td>
      <td>9.0</td>
      <td>42.7</td>
      <td>20165.0</td>
      <td>3068.0</td>
      <td>8529.0</td>
      <td>8372.0</td>
      <td>4463.0</td>
      <td>692.0</td>
      <td>18371.0</td>
      <td>289.0</td>
      <td>576.0</td>
      <td>50.2</td>
      <td>317.0</td>
      <td>35.0</td>
      <td>11712.0</td>
      <td>62580.0</td>
      <td>33620.0</td>
      <td>1194.0</td>
      <td>384.0</td>
      <td>115.0</td>
      <td>415.0</td>
      <td>388.0</td>
      <td>14702.0</td>
      <td>11974.0</td>
      <td>81.4</td>
      <td>922.0</td>
      <td>72.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>524.0</td>
      <td>548.0</td>
      <td>71.0</td>
      <td>411.0</td>
      <td>673.0</td>
      <td>429.0</td>
      <td>2.0</td>
      <td>12.0</td>
      <td>2.0</td>
      <td>2883.0</td>
      <td>585.0</td>
      <td>669.0</td>
      <td>46.7</td>
      <td>NorwichCity</td>
      <td>2021</td>
    </tr>
  </tbody>
</table>
<p>4884 rows × 177 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_columns"</span>, <span class="va">None</span>):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    display(dfAll.describe(include<span class="op">=</span><span class="st">'all'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Date</th>
      <th>Time</th>
      <th>Comp</th>
      <th>Round</th>
      <th>Day</th>
      <th>Venue</th>
      <th>Result</th>
      <th>GF</th>
      <th>GA</th>
      <th>Opponent</th>
      <th>Gls</th>
      <th>Sh_shooting</th>
      <th>SoT</th>
      <th>SoT%</th>
      <th>G/Sh</th>
      <th>G/SoT</th>
      <th>Dist</th>
      <th>FK_shooting</th>
      <th>PK</th>
      <th>PKatt_shooting</th>
      <th>xG</th>
      <th>npxG</th>
      <th>npxG/Sh</th>
      <th>G-xG</th>
      <th>np:G-xG</th>
      <th>Match Report</th>
      <th>SoTA</th>
      <th>Saves</th>
      <th>Save%</th>
      <th>CS</th>
      <th>PSxG</th>
      <th>PSxG+/-</th>
      <th>PKatt_keeper</th>
      <th>PKA</th>
      <th>PKsv</th>
      <th>PKm</th>
      <th>Cmp_keeper</th>
      <th>Att_keeper</th>
      <th>Cmp%_keeper</th>
      <th>Att_keeper.1</th>
      <th>Thr</th>
      <th>Launch%</th>
      <th>AvgLen</th>
      <th>Att_keeper.2</th>
      <th>Launch%.1</th>
      <th>AvgLen.1</th>
      <th>Opp</th>
      <th>Stp</th>
      <th>Stp%</th>
      <th>#OPA</th>
      <th>AvgDist</th>
      <th>Cmp_passing</th>
      <th>Att_passing</th>
      <th>Cmp%_passing</th>
      <th>TotDist_passing</th>
      <th>PrgDist_passing</th>
      <th>Cmp_passing.1</th>
      <th>Att_passing.1</th>
      <th>Cmp%_passing.1</th>
      <th>Cmp_passing.2</th>
      <th>Att_passing.2</th>
      <th>Cmp%_passing.2</th>
      <th>Cmp_passing.3</th>
      <th>Att_passing.3</th>
      <th>Cmp%_passing.3</th>
      <th>Ast</th>
      <th>xA</th>
      <th>KP</th>
      <th>1/3_passing</th>
      <th>PPA</th>
      <th>CrsPA</th>
      <th>Prog_passing</th>
      <th>Att_passing_types</th>
      <th>Live_passing_types</th>
      <th>Dead</th>
      <th>FK_passing_types</th>
      <th>TB</th>
      <th>Press_passing_types</th>
      <th>Sw</th>
      <th>Crs_passing_types</th>
      <th>CK</th>
      <th>In</th>
      <th>Out</th>
      <th>Str</th>
      <th>Ground</th>
      <th>Low</th>
      <th>High</th>
      <th>Left</th>
      <th>Right</th>
      <th>Head</th>
      <th>TI</th>
      <th>Other</th>
      <th>Cmp_passing_types</th>
      <th>Off_passing_types</th>
      <th>Out.1</th>
      <th>Int_passing_types</th>
      <th>Blocks_passing_types</th>
      <th>SCA</th>
      <th>PassLive</th>
      <th>PassDead</th>
      <th>Drib</th>
      <th>Sh_gca</th>
      <th>Fld_gca</th>
      <th>Def</th>
      <th>GCA</th>
      <th>PassLive.1</th>
      <th>PassDead.1</th>
      <th>Drib.1</th>
      <th>Sh_gca.1</th>
      <th>Fld_gca.1</th>
      <th>Def.1</th>
      <th>Tkl</th>
      <th>TklW_defense</th>
      <th>Def 3rd_defense</th>
      <th>Mid 3rd_defense</th>
      <th>Att 3rd_defense</th>
      <th>Tkl.1</th>
      <th>Att_defense</th>
      <th>Tkl%</th>
      <th>Past</th>
      <th>Press_defense</th>
      <th>Succ_defense</th>
      <th>%</th>
      <th>Def 3rd_defense.1</th>
      <th>Mid 3rd_defense.1</th>
      <th>Att 3rd_defense.1</th>
      <th>Blocks_defense</th>
      <th>Sh_defense</th>
      <th>ShSv</th>
      <th>Pass</th>
      <th>Int_defense</th>
      <th>Tkl+Int</th>
      <th>Clr</th>
      <th>Err</th>
      <th>Poss</th>
      <th>Touches</th>
      <th>Def Pen</th>
      <th>Def 3rd_possession</th>
      <th>Mid 3rd_possession</th>
      <th>Att 3rd_possession</th>
      <th>Att Pen</th>
      <th>Live_possession</th>
      <th>Succ_possession</th>
      <th>Att_possession</th>
      <th>Succ%</th>
      <th>#Pl</th>
      <th>Megs</th>
      <th>Carries</th>
      <th>TotDist_possession</th>
      <th>PrgDist_possession</th>
      <th>Prog_possession</th>
      <th>1/3_possession</th>
      <th>CPA</th>
      <th>Mis</th>
      <th>Dis</th>
      <th>Targ</th>
      <th>Rec</th>
      <th>Rec%</th>
      <th>Prog_possession.1</th>
      <th>CrdY</th>
      <th>CrdR</th>
      <th>2CrdY</th>
      <th>Fls</th>
      <th>Fld_misc</th>
      <th>Off_misc</th>
      <th>Crs_misc</th>
      <th>Int_misc</th>
      <th>TklW_misc</th>
      <th>PKwon</th>
      <th>PKcon</th>
      <th>OG</th>
      <th>Recov</th>
      <th>Won</th>
      <th>Lost</th>
      <th>Won%</th>
      <th>team</th>
      <th>Season</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4784</td>
      <td>4784</td>
      <td>4784</td>
      <td>4784</td>
      <td>4784</td>
      <td>4784</td>
      <td>4884</td>
      <td>4884</td>
      <td>4884</td>
      <td>4784</td>
      <td>4882.000000</td>
      <td>4855.000000</td>
      <td>4855.000000</td>
      <td>4852.000000</td>
      <td>4852.000000</td>
      <td>4702.000000</td>
      <td>4183.000000</td>
      <td>4186.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4183.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4784</td>
      <td>4855.000000</td>
      <td>4855.000000</td>
      <td>4665.000000</td>
      <td>4872.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4180.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4174.000000</td>
      <td>4174.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4167.000000</td>
      <td>4186.000000</td>
      <td>4152.00000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.00000</td>
      <td>4186.000000</td>
      <td>4880.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4855.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4855.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4855.000000</td>
      <td>0.0</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4853.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4185.000000</td>
      <td>4185.000000</td>
      <td>4185.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4882.000000</td>
      <td>4855.000000</td>
      <td>4855.000000</td>
      <td>4851.000000</td>
      <td>4855.000000</td>
      <td>4855.000000</td>
      <td>4855.000000</td>
      <td>4429.000000</td>
      <td>4429.000000</td>
      <td>4882.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4186.000000</td>
      <td>4884</td>
      <td>4884.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>932</td>
      <td>55</td>
      <td>8</td>
      <td>57</td>
      <td>7</td>
      <td>3</td>
      <td>102</td>
      <td>100</td>
      <td>79</td>
      <td>196</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2020-07-26</td>
      <td>15:00</td>
      <td>Premier League</td>
      <td>Group stage</td>
      <td>Sat</td>
      <td>Away</td>
      <td>W</td>
      <td>1</td>
      <td>1</td>
      <td>Chelsea</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Match Report</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Chelsea</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>20</td>
      <td>1304</td>
      <td>3800</td>
      <td>204</td>
      <td>1955</td>
      <td>2379</td>
      <td>2024</td>
      <td>1458</td>
      <td>1530</td>
      <td>223</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4784</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>302</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.807046</td>
      <td>25.024099</td>
      <td>8.454377</td>
      <td>34.208780</td>
      <td>0.107178</td>
      <td>0.302303</td>
      <td>17.016161</td>
      <td>0.916866</td>
      <td>0.212618</td>
      <td>0.265465</td>
      <td>2.650358</td>
      <td>2.447611</td>
      <td>0.102305</td>
      <td>0.325991</td>
      <td>0.297731</td>
      <td>NaN</td>
      <td>7.774253</td>
      <td>5.405973</td>
      <td>69.542851</td>
      <td>0.599343</td>
      <td>2.554754</td>
      <td>0.007215</td>
      <td>0.244982</td>
      <td>0.191315</td>
      <td>0.038918</td>
      <td>0.014748</td>
      <td>12.899188</td>
      <td>33.093168</td>
      <td>41.963493</td>
      <td>47.056856</td>
      <td>7.976589</td>
      <td>49.877926</td>
      <td>41.947181</td>
      <td>14.445294</td>
      <td>65.545208</td>
      <td>51.673766</td>
      <td>16.774009</td>
      <td>1.260870</td>
      <td>7.495824</td>
      <td>1.270425</td>
      <td>14.44039</td>
      <td>778.702819</td>
      <td>979.663641</td>
      <td>77.703321</td>
      <td>15260.310081</td>
      <td>5068.769231</td>
      <td>318.322026</td>
      <td>361.893454</td>
      <td>86.891519</td>
      <td>330.830387</td>
      <td>384.102246</td>
      <td>84.293048</td>
      <td>115.584329</td>
      <td>197.11419</td>
      <td>57.708624</td>
      <td>2.017623</td>
      <td>1.808576</td>
      <td>17.715719</td>
      <td>58.741042</td>
      <td>16.486861</td>
      <td>3.909221</td>
      <td>64.507883</td>
      <td>979.663641</td>
      <td>886.577162</td>
      <td>93.086479</td>
      <td>22.768275</td>
      <td>1.907788</td>
      <td>146.339226</td>
      <td>28.565217</td>
      <td>25.307930</td>
      <td>10.187769</td>
      <td>4.153846</td>
      <td>3.428571</td>
      <td>0.769231</td>
      <td>646.799331</td>
      <td>132.541806</td>
      <td>200.322504</td>
      <td>271.279025</td>
      <td>588.523650</td>
      <td>39.738175</td>
      <td>41.058290</td>
      <td>12.734353</td>
      <td>778.702819</td>
      <td>3.241280</td>
      <td>17.334448</td>
      <td>22.790731</td>
      <td>23.553751</td>
      <td>38.194458</td>
      <td>27.595318</td>
      <td>3.312470</td>
      <td>2.381749</td>
      <td>1.967511</td>
      <td>2.090301</td>
      <td>0.847109</td>
      <td>4.365504</td>
      <td>2.998567</td>
      <td>0.281892</td>
      <td>0.305781</td>
      <td>0.356904</td>
      <td>0.320115</td>
      <td>0.102246</td>
      <td>34.440038</td>
      <td>20.515345</td>
      <td>17.107023</td>
      <td>13.040134</td>
      <td>4.292881</td>
      <td>11.609651</td>
      <td>31.862398</td>
      <td>36.524319</td>
      <td>20.252747</td>
      <td>294.902054</td>
      <td>85.661252</td>
      <td>29.545485</td>
      <td>100.644052</td>
      <td>128.161968</td>
      <td>66.096034</td>
      <td>30.767320</td>
      <td>7.319637</td>
      <td>0.153846</td>
      <td>23.447683</td>
      <td>23.006797</td>
      <td>NaN</td>
      <td>47.913521</td>
      <td>0.542284</td>
      <td>51.159242</td>
      <td>1213.857143</td>
      <td>127.489250</td>
      <td>388.689441</td>
      <td>576.553273</td>
      <td>322.073101</td>
      <td>47.647396</td>
      <td>1122.888677</td>
      <td>19.130435</td>
      <td>32.597707</td>
      <td>58.473340</td>
      <td>20.764931</td>
      <td>1.397516</td>
      <td>763.685141</td>
      <td>3891.837076</td>
      <td>2095.075490</td>
      <td>85.597611</td>
      <td>25.697013</td>
      <td>8.394265</td>
      <td>23.881032</td>
      <td>23.030100</td>
      <td>923.780698</td>
      <td>778.700430</td>
      <td>82.872934</td>
      <td>68.917821</td>
      <td>3.081934</td>
      <td>0.107743</td>
      <td>0.046293</td>
      <td>23.768486</td>
      <td>22.819773</td>
      <td>3.692022</td>
      <td>25.307930</td>
      <td>23.006797</td>
      <td>20.515345</td>
      <td>0.222624</td>
      <td>0.245202</td>
      <td>0.081934</td>
      <td>175.380315</td>
      <td>36.778309</td>
      <td>36.482083</td>
      <td>50.300263</td>
      <td>NaN</td>
      <td>2018.999795</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.633434</td>
      <td>88.799785</td>
      <td>30.533485</td>
      <td>15.894195</td>
      <td>0.106387</td>
      <td>0.260790</td>
      <td>2.956683</td>
      <td>3.218861</td>
      <td>0.931731</td>
      <td>1.123947</td>
      <td>8.894023</td>
      <td>8.208661</td>
      <td>0.045897</td>
      <td>3.151378</td>
      <td>3.001137</td>
      <td>NaN</td>
      <td>26.650273</td>
      <td>18.596239</td>
      <td>27.910813</td>
      <td>2.295011</td>
      <td>8.196880</td>
      <td>1.103346</td>
      <td>0.979508</td>
      <td>0.793245</td>
      <td>0.237192</td>
      <td>0.134986</td>
      <td>41.759788</td>
      <td>107.882512</td>
      <td>17.911863</td>
      <td>150.427337</td>
      <td>26.089799</td>
      <td>23.767444</td>
      <td>11.250174</td>
      <td>45.771924</td>
      <td>31.433860</td>
      <td>17.035460</td>
      <td>53.173125</td>
      <td>4.175571</td>
      <td>10.930395</td>
      <td>4.553672</td>
      <td>4.93127</td>
      <td>2605.489763</td>
      <td>3208.035980</td>
      <td>7.414447</td>
      <td>50630.636493</td>
      <td>16299.172616</td>
      <td>1068.855698</td>
      <td>1202.422025</td>
      <td>4.805741</td>
      <td>1123.135331</td>
      <td>1282.943241</td>
      <td>6.690822</td>
      <td>377.078549</td>
      <td>624.91629</td>
      <td>11.307517</td>
      <td>7.763338</td>
      <td>6.131791</td>
      <td>58.080111</td>
      <td>197.829053</td>
      <td>55.986741</td>
      <td>12.654073</td>
      <td>214.622704</td>
      <td>3208.035980</td>
      <td>2925.037009</td>
      <td>292.535663</td>
      <td>72.090205</td>
      <td>7.136800</td>
      <td>470.335604</td>
      <td>93.135721</td>
      <td>88.390685</td>
      <td>33.119199</td>
      <td>13.731657</td>
      <td>12.164358</td>
      <td>2.915172</td>
      <td>2207.910917</td>
      <td>423.589872</td>
      <td>630.932794</td>
      <td>917.313240</td>
      <td>1963.754151</td>
      <td>125.726147</td>
      <td>129.347165</td>
      <td>40.881764</td>
      <td>2605.489763</td>
      <td>10.552076</td>
      <td>54.773459</td>
      <td>75.022925</td>
      <td>74.970220</td>
      <td>125.518394</td>
      <td>91.755801</td>
      <td>10.691361</td>
      <td>8.137498</td>
      <td>6.618276</td>
      <td>6.873735</td>
      <td>2.885309</td>
      <td>15.374347</td>
      <td>10.847460</td>
      <td>1.038030</td>
      <td>1.256439</td>
      <td>1.326036</td>
      <td>1.209979</td>
      <td>0.497602</td>
      <td>108.322327</td>
      <td>70.287520</td>
      <td>54.061008</td>
      <td>41.315181</td>
      <td>13.986381</td>
      <td>36.726989</td>
      <td>100.519999</td>
      <td>14.096407</td>
      <td>64.120993</td>
      <td>927.776033</td>
      <td>270.289930</td>
      <td>6.137151</td>
      <td>318.495026</td>
      <td>404.369150</td>
      <td>212.614304</td>
      <td>96.855501</td>
      <td>23.584690</td>
      <td>0.649772</td>
      <td>73.919927</td>
      <td>80.317731</td>
      <td>NaN</td>
      <td>152.214124</td>
      <td>1.913732</td>
      <td>12.765971</td>
      <td>3922.818669</td>
      <td>401.789918</td>
      <td>1232.300695</td>
      <td>1895.667845</td>
      <td>1063.463054</td>
      <td>158.530092</td>
      <td>3643.085181</td>
      <td>62.084728</td>
      <td>104.776235</td>
      <td>14.357941</td>
      <td>67.270208</td>
      <td>4.731968</td>
      <td>2539.014612</td>
      <td>12895.247448</td>
      <td>7030.655371</td>
      <td>293.742138</td>
      <td>86.595433</td>
      <td>29.033431</td>
      <td>75.264289</td>
      <td>73.034432</td>
      <td>3043.493873</td>
      <td>2605.477967</td>
      <td>6.643909</td>
      <td>228.821950</td>
      <td>10.680582</td>
      <td>0.491127</td>
      <td>0.269891</td>
      <td>81.167475</td>
      <td>78.675002</td>
      <td>13.030748</td>
      <td>88.390685</td>
      <td>80.317731</td>
      <td>70.287520</td>
      <td>0.936620</td>
      <td>0.944928</td>
      <td>0.389166</td>
      <td>552.150279</td>
      <td>116.590220</td>
      <td>116.000905</td>
      <td>10.049628</td>
      <td>NaN</td>
      <td>1.414431</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.020000</td>
      <td>-10.300000</td>
      <td>-9.700000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-11.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.800000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.700000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.00000</td>
      <td>97.000000</td>
      <td>179.000000</td>
      <td>49.100000</td>
      <td>2201.000000</td>
      <td>931.000000</td>
      <td>34.000000</td>
      <td>54.000000</td>
      <td>60.700000</td>
      <td>22.000000</td>
      <td>41.000000</td>
      <td>53.700000</td>
      <td>11.000000</td>
      <td>46.00000</td>
      <td>20.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>179.000000</td>
      <td>130.000000</td>
      <td>21.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>56.000000</td>
      <td>12.000000</td>
      <td>41.000000</td>
      <td>26.000000</td>
      <td>92.000000</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>97.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>39.000000</td>
      <td>10.000000</td>
      <td>11.500000</td>
      <td>4.000000</td>
      <td>11.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>17.000000</td>
      <td>299.000000</td>
      <td>16.000000</td>
      <td>56.000000</td>
      <td>91.000000</td>
      <td>25.000000</td>
      <td>0.000000</td>
      <td>261.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>105.000000</td>
      <td>446.000000</td>
      <td>188.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>150.000000</td>
      <td>97.000000</td>
      <td>55.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>37.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>10.000000</td>
      <td>NaN</td>
      <td>2017.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>23.800000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.100000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.800000</td>
      <td>0.700000</td>
      <td>0.070000</td>
      <td>-0.600000</td>
      <td>-0.600000</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>50.000000</td>
      <td>0.000000</td>
      <td>0.600000</td>
      <td>-0.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>10.000000</td>
      <td>30.000000</td>
      <td>19.000000</td>
      <td>2.000000</td>
      <td>30.800000</td>
      <td>33.000000</td>
      <td>5.000000</td>
      <td>42.900000</td>
      <td>38.600000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11.30000</td>
      <td>289.250000</td>
      <td>395.000000</td>
      <td>73.000000</td>
      <td>5805.250000</td>
      <td>2197.000000</td>
      <td>117.000000</td>
      <td>139.000000</td>
      <td>84.100000</td>
      <td>114.000000</td>
      <td>141.000000</td>
      <td>80.625000</td>
      <td>45.000000</td>
      <td>88.00000</td>
      <td>49.600000</td>
      <td>0.000000</td>
      <td>0.500000</td>
      <td>6.000000</td>
      <td>20.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>23.000000</td>
      <td>395.000000</td>
      <td>346.250000</td>
      <td>42.000000</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>54.000000</td>
      <td>10.000000</td>
      <td>8.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>224.000000</td>
      <td>53.000000</td>
      <td>86.000000</td>
      <td>99.000000</td>
      <td>220.000000</td>
      <td>15.000000</td>
      <td>17.000000</td>
      <td>4.000000</td>
      <td>289.250000</td>
      <td>1.000000</td>
      <td>7.000000</td>
      <td>7.000000</td>
      <td>9.000000</td>
      <td>13.000000</td>
      <td>9.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>12.000000</td>
      <td>27.300000</td>
      <td>7.000000</td>
      <td>122.000000</td>
      <td>35.000000</td>
      <td>25.400000</td>
      <td>36.000000</td>
      <td>51.000000</td>
      <td>25.000000</td>
      <td>12.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>7.000000</td>
      <td>NaN</td>
      <td>16.000000</td>
      <td>0.000000</td>
      <td>42.000000</td>
      <td>521.000000</td>
      <td>53.000000</td>
      <td>171.000000</td>
      <td>227.000000</td>
      <td>120.000000</td>
      <td>16.000000</td>
      <td>473.000000</td>
      <td>7.000000</td>
      <td>12.000000</td>
      <td>50.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>289.000000</td>
      <td>1457.500000</td>
      <td>743.000000</td>
      <td>27.000000</td>
      <td>8.000000</td>
      <td>2.000000</td>
      <td>9.000000</td>
      <td>9.000000</td>
      <td>365.000000</td>
      <td>289.250000</td>
      <td>78.700000</td>
      <td>25.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>9.000000</td>
      <td>1.000000</td>
      <td>8.000000</td>
      <td>7.000000</td>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>78.000000</td>
      <td>13.000000</td>
      <td>13.000000</td>
      <td>44.000000</td>
      <td>NaN</td>
      <td>2018.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>12.000000</td>
      <td>4.000000</td>
      <td>33.300000</td>
      <td>0.090000</td>
      <td>0.290000</td>
      <td>16.900000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.300000</td>
      <td>1.100000</td>
      <td>0.090000</td>
      <td>-0.100000</td>
      <td>-0.100000</td>
      <td>NaN</td>
      <td>4.000000</td>
      <td>3.000000</td>
      <td>71.400000</td>
      <td>0.000000</td>
      <td>1.200000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>17.000000</td>
      <td>40.000000</td>
      <td>23.000000</td>
      <td>4.000000</td>
      <td>50.000000</td>
      <td>40.900000</td>
      <td>7.000000</td>
      <td>71.400000</td>
      <td>54.300000</td>
      <td>8.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.00000</td>
      <td>384.000000</td>
      <td>491.000000</td>
      <td>78.600000</td>
      <td>7600.500000</td>
      <td>2575.000000</td>
      <td>155.500000</td>
      <td>178.000000</td>
      <td>87.700000</td>
      <td>162.000000</td>
      <td>189.000000</td>
      <td>85.600000</td>
      <td>58.000000</td>
      <td>100.00000</td>
      <td>57.800000</td>
      <td>1.000000</td>
      <td>0.800000</td>
      <td>9.000000</td>
      <td>28.000000</td>
      <td>8.000000</td>
      <td>2.000000</td>
      <td>32.000000</td>
      <td>491.000000</td>
      <td>441.000000</td>
      <td>48.000000</td>
      <td>12.000000</td>
      <td>1.000000</td>
      <td>72.000000</td>
      <td>14.000000</td>
      <td>12.000000</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>315.000000</td>
      <td>66.000000</td>
      <td>102.000000</td>
      <td>129.000000</td>
      <td>290.000000</td>
      <td>20.000000</td>
      <td>21.000000</td>
      <td>6.000000</td>
      <td>384.000000</td>
      <td>1.000000</td>
      <td>9.000000</td>
      <td>11.000000</td>
      <td>12.000000</td>
      <td>19.000000</td>
      <td>13.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>17.000000</td>
      <td>10.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>2.000000</td>
      <td>6.000000</td>
      <td>16.000000</td>
      <td>36.250000</td>
      <td>10.000000</td>
      <td>148.000000</td>
      <td>43.000000</td>
      <td>29.300000</td>
      <td>49.000000</td>
      <td>64.000000</td>
      <td>33.000000</td>
      <td>15.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>11.000000</td>
      <td>NaN</td>
      <td>23.000000</td>
      <td>0.000000</td>
      <td>51.000000</td>
      <td>611.000000</td>
      <td>64.000000</td>
      <td>198.000000</td>
      <td>288.000000</td>
      <td>155.000000</td>
      <td>23.000000</td>
      <td>564.000000</td>
      <td>9.000000</td>
      <td>16.000000</td>
      <td>58.800000</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>379.000000</td>
      <td>1935.500000</td>
      <td>1024.500000</td>
      <td>40.000000</td>
      <td>12.000000</td>
      <td>4.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
      <td>460.500000</td>
      <td>384.000000</td>
      <td>83.800000</td>
      <td>34.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>12.000000</td>
      <td>2.000000</td>
      <td>12.000000</td>
      <td>11.000000</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>89.000000</td>
      <td>18.000000</td>
      <td>18.000000</td>
      <td>50.000000</td>
      <td>NaN</td>
      <td>2019.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>16.000000</td>
      <td>6.000000</td>
      <td>43.800000</td>
      <td>0.170000</td>
      <td>0.500000</td>
      <td>18.700000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.900000</td>
      <td>1.700000</td>
      <td>0.120000</td>
      <td>0.600000</td>
      <td>0.600000</td>
      <td>NaN</td>
      <td>6.000000</td>
      <td>4.000000</td>
      <td>100.000000</td>
      <td>1.000000</td>
      <td>1.900000</td>
      <td>0.400000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9.000000</td>
      <td>24.000000</td>
      <td>50.000000</td>
      <td>29.000000</td>
      <td>6.000000</td>
      <td>68.400000</td>
      <td>50.400000</td>
      <td>10.000000</td>
      <td>100.000000</td>
      <td>66.000000</td>
      <td>11.000000</td>
      <td>1.000000</td>
      <td>12.500000</td>
      <td>1.000000</td>
      <td>16.90000</td>
      <td>502.000000</td>
      <td>605.000000</td>
      <td>83.300000</td>
      <td>9785.250000</td>
      <td>3022.750000</td>
      <td>203.000000</td>
      <td>228.000000</td>
      <td>90.300000</td>
      <td>223.000000</td>
      <td>252.000000</td>
      <td>89.400000</td>
      <td>73.000000</td>
      <td>114.00000</td>
      <td>66.100000</td>
      <td>2.000000</td>
      <td>1.300000</td>
      <td>12.000000</td>
      <td>39.000000</td>
      <td>11.000000</td>
      <td>3.000000</td>
      <td>43.000000</td>
      <td>605.000000</td>
      <td>557.000000</td>
      <td>53.750000</td>
      <td>14.000000</td>
      <td>2.000000</td>
      <td>93.000000</td>
      <td>19.000000</td>
      <td>17.000000</td>
      <td>7.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>433.000000</td>
      <td>82.000000</td>
      <td>119.000000</td>
      <td>169.000000</td>
      <td>379.000000</td>
      <td>25.000000</td>
      <td>25.000000</td>
      <td>9.000000</td>
      <td>502.000000</td>
      <td>3.000000</td>
      <td>11.000000</td>
      <td>16.000000</td>
      <td>15.000000</td>
      <td>26.000000</td>
      <td>19.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>21.000000</td>
      <td>13.000000</td>
      <td>11.000000</td>
      <td>9.000000</td>
      <td>3.000000</td>
      <td>8.000000</td>
      <td>20.000000</td>
      <td>45.500000</td>
      <td>13.000000</td>
      <td>179.000000</td>
      <td>53.000000</td>
      <td>33.500000</td>
      <td>65.000000</td>
      <td>80.000000</td>
      <td>43.000000</td>
      <td>20.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>15.000000</td>
      <td>16.000000</td>
      <td>NaN</td>
      <td>32.000000</td>
      <td>0.000000</td>
      <td>61.000000</td>
      <td>723.000000</td>
      <td>77.000000</td>
      <td>226.000000</td>
      <td>358.000000</td>
      <td>206.000000</td>
      <td>32.000000</td>
      <td>676.000000</td>
      <td>13.000000</td>
      <td>21.000000</td>
      <td>68.150000</td>
      <td>14.000000</td>
      <td>1.000000</td>
      <td>491.000000</td>
      <td>2538.000000</td>
      <td>1391.750000</td>
      <td>58.000000</td>
      <td>17.000000</td>
      <td>6.000000</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>578.000000</td>
      <td>502.000000</td>
      <td>87.800000</td>
      <td>45.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.000000</td>
      <td>14.000000</td>
      <td>3.000000</td>
      <td>17.000000</td>
      <td>16.000000</td>
      <td>13.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>102.000000</td>
      <td>24.000000</td>
      <td>24.000000</td>
      <td>56.700000</td>
      <td>NaN</td>
      <td>2020.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>162.000000</td>
      <td>1140.000000</td>
      <td>418.000000</td>
      <td>100.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>34.900000</td>
      <td>50.000000</td>
      <td>18.000000</td>
      <td>22.000000</td>
      <td>115.600000</td>
      <td>107.600000</td>
      <td>0.370000</td>
      <td>59.200000</td>
      <td>57.500000</td>
      <td>NaN</td>
      <td>246.000000</td>
      <td>184.000000</td>
      <td>100.000000</td>
      <td>33.000000</td>
      <td>78.700000</td>
      <td>11.900000</td>
      <td>13.000000</td>
      <td>13.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>435.000000</td>
      <td>1122.000000</td>
      <td>100.000000</td>
      <td>1702.000000</td>
      <td>290.000000</td>
      <td>100.000000</td>
      <td>78.000000</td>
      <td>417.000000</td>
      <td>100.000000</td>
      <td>106.000000</td>
      <td>464.000000</td>
      <td>53.000000</td>
      <td>100.000000</td>
      <td>80.000000</td>
      <td>85.00000</td>
      <td>32015.000000</td>
      <td>37015.000000</td>
      <td>93.000000</td>
      <td>597272.000000</td>
      <td>176070.000000</td>
      <td>14699.000000</td>
      <td>16107.000000</td>
      <td>97.700000</td>
      <td>14051.000000</td>
      <td>15205.000000</td>
      <td>96.400000</td>
      <td>4291.000000</td>
      <td>6303.00000</td>
      <td>89.000000</td>
      <td>127.000000</td>
      <td>82.600000</td>
      <td>676.000000</td>
      <td>2552.000000</td>
      <td>734.000000</td>
      <td>135.000000</td>
      <td>2578.000000</td>
      <td>37015.000000</td>
      <td>34410.000000</td>
      <td>2728.000000</td>
      <td>751.000000</td>
      <td>136.000000</td>
      <td>5062.000000</td>
      <td>1145.000000</td>
      <td>1035.000000</td>
      <td>398.000000</td>
      <td>170.000000</td>
      <td>267.000000</td>
      <td>51.000000</td>
      <td>28713.000000</td>
      <td>4655.000000</td>
      <td>5891.000000</td>
      <td>14393.000000</td>
      <td>27064.000000</td>
      <td>1190.000000</td>
      <td>1223.000000</td>
      <td>419.000000</td>
      <td>32015.000000</td>
      <td>110.000000</td>
      <td>509.000000</td>
      <td>962.000000</td>
      <td>744.000000</td>
      <td>1471.000000</td>
      <td>1128.000000</td>
      <td>130.000000</td>
      <td>119.000000</td>
      <td>97.000000</td>
      <td>81.000000</td>
      <td>39.000000</td>
      <td>216.000000</td>
      <td>164.000000</td>
      <td>14.000000</td>
      <td>19.000000</td>
      <td>22.000000</td>
      <td>17.000000</td>
      <td>10.000000</td>
      <td>901.000000</td>
      <td>670.000000</td>
      <td>476.000000</td>
      <td>377.000000</td>
      <td>168.000000</td>
      <td>373.000000</td>
      <td>916.000000</td>
      <td>100.000000</td>
      <td>585.000000</td>
      <td>8089.000000</td>
      <td>2429.000000</td>
      <td>53.800000</td>
      <td>2948.000000</td>
      <td>3705.000000</td>
      <td>2388.000000</td>
      <td>867.000000</td>
      <td>251.000000</td>
      <td>9.000000</td>
      <td>688.000000</td>
      <td>846.000000</td>
      <td>NaN</td>
      <td>1486.000000</td>
      <td>29.000000</td>
      <td>85.000000</td>
      <td>43032.000000</td>
      <td>3617.000000</td>
      <td>12063.000000</td>
      <td>22515.000000</td>
      <td>13154.000000</td>
      <td>2090.000000</td>
      <td>40508.000000</td>
      <td>695.000000</td>
      <td>1086.000000</td>
      <td>100.000000</td>
      <td>743.000000</td>
      <td>70.000000</td>
      <td>31423.000000</td>
      <td>154478.000000</td>
      <td>89994.000000</td>
      <td>4119.000000</td>
      <td>1150.000000</td>
      <td>463.000000</td>
      <td>697.000000</td>
      <td>735.000000</td>
      <td>35814.000000</td>
      <td>32015.000000</td>
      <td>99.600000</td>
      <td>2725.000000</td>
      <td>110.000000</td>
      <td>7.000000</td>
      <td>4.000000</td>
      <td>836.000000</td>
      <td>889.000000</td>
      <td>170.000000</td>
      <td>1035.000000</td>
      <td>846.000000</td>
      <td>670.000000</td>
      <td>16.000000</td>
      <td>12.000000</td>
      <td>5.000000</td>
      <td>5087.000000</td>
      <td>1155.000000</td>
      <td>1193.000000</td>
      <td>90.900000</td>
      <td>NaN</td>
      <td>2021.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>[ (x,dfAll[x].dtype) <span class="cf">for</span> x <span class="kw">in</span> dfAll]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">
<pre><code>[('Date', dtype('O')),
 ('Time', dtype('O')),
 ('Comp', dtype('O')),
 ('Round', dtype('O')),
 ('Day', dtype('O')),
 ('Venue', dtype('O')),
 ('Result', dtype('O')),
 ('GF', dtype('O')),
 ('GA', dtype('O')),
 ('Opponent', dtype('O')),
 ('Gls', dtype('float64')),
 ('Sh_shooting', dtype('float64')),
 ('SoT', dtype('float64')),
 ('SoT%', dtype('float64')),
 ('G/Sh', dtype('float64')),
 ('G/SoT', dtype('float64')),
 ('Dist', dtype('float64')),
 ('FK_shooting', dtype('float64')),
 ('PK', dtype('float64')),
 ('PKatt_shooting', dtype('float64')),
 ('xG', dtype('float64')),
 ('npxG', dtype('float64')),
 ('npxG/Sh', dtype('float64')),
 ('G-xG', dtype('float64')),
 ('np:G-xG', dtype('float64')),
 ('Match Report', dtype('O')),
 ('SoTA', dtype('float64')),
 ('Saves', dtype('float64')),
 ('Save%', dtype('float64')),
 ('CS', dtype('float64')),
 ('PSxG', dtype('float64')),
 ('PSxG+/-', dtype('float64')),
 ('PKatt_keeper', dtype('float64')),
 ('PKA', dtype('float64')),
 ('PKsv', dtype('float64')),
 ('PKm', dtype('float64')),
 ('Cmp_keeper', dtype('float64')),
 ('Att_keeper', dtype('float64')),
 ('Cmp%_keeper', dtype('float64')),
 ('Att_keeper.1', dtype('float64')),
 ('Thr', dtype('float64')),
 ('Launch%', dtype('float64')),
 ('AvgLen', dtype('float64')),
 ('Att_keeper.2', dtype('float64')),
 ('Launch%.1', dtype('float64')),
 ('AvgLen.1', dtype('float64')),
 ('Opp', dtype('float64')),
 ('Stp', dtype('float64')),
 ('Stp%', dtype('float64')),
 ('#OPA', dtype('float64')),
 ('AvgDist', dtype('float64')),
 ('Cmp_passing', dtype('float64')),
 ('Att_passing', dtype('float64')),
 ('Cmp%_passing', dtype('float64')),
 ('TotDist_passing', dtype('float64')),
 ('PrgDist_passing', dtype('float64')),
 ('Cmp_passing.1', dtype('float64')),
 ('Att_passing.1', dtype('float64')),
 ('Cmp%_passing.1', dtype('float64')),
 ('Cmp_passing.2', dtype('float64')),
 ('Att_passing.2', dtype('float64')),
 ('Cmp%_passing.2', dtype('float64')),
 ('Cmp_passing.3', dtype('float64')),
 ('Att_passing.3', dtype('float64')),
 ('Cmp%_passing.3', dtype('float64')),
 ('Ast', dtype('float64')),
 ('xA', dtype('float64')),
 ('KP', dtype('float64')),
 ('1/3_passing', dtype('float64')),
 ('PPA', dtype('float64')),
 ('CrsPA', dtype('float64')),
 ('Prog_passing', dtype('float64')),
 ('Att_passing_types', dtype('float64')),
 ('Live_passing_types', dtype('float64')),
 ('Dead', dtype('float64')),
 ('FK_passing_types', dtype('float64')),
 ('TB', dtype('float64')),
 ('Press_passing_types', dtype('float64')),
 ('Sw', dtype('float64')),
 ('Crs_passing_types', dtype('float64')),
 ('CK', dtype('float64')),
 ('In', dtype('float64')),
 ('Out', dtype('float64')),
 ('Str', dtype('float64')),
 ('Ground', dtype('float64')),
 ('Low', dtype('float64')),
 ('High', dtype('float64')),
 ('Left', dtype('float64')),
 ('Right', dtype('float64')),
 ('Head', dtype('float64')),
 ('TI', dtype('float64')),
 ('Other', dtype('float64')),
 ('Cmp_passing_types', dtype('float64')),
 ('Off_passing_types', dtype('float64')),
 ('Out.1', dtype('float64')),
 ('Int_passing_types', dtype('float64')),
 ('Blocks_passing_types', dtype('float64')),
 ('SCA', dtype('float64')),
 ('PassLive', dtype('float64')),
 ('PassDead', dtype('float64')),
 ('Drib', dtype('float64')),
 ('Sh_gca', dtype('float64')),
 ('Fld_gca', dtype('float64')),
 ('Def', dtype('float64')),
 ('GCA', dtype('float64')),
 ('PassLive.1', dtype('float64')),
 ('PassDead.1', dtype('float64')),
 ('Drib.1', dtype('float64')),
 ('Sh_gca.1', dtype('float64')),
 ('Fld_gca.1', dtype('float64')),
 ('Def.1', dtype('float64')),
 ('Tkl', dtype('float64')),
 ('TklW_defense', dtype('float64')),
 ('Def 3rd_defense', dtype('float64')),
 ('Mid 3rd_defense', dtype('float64')),
 ('Att 3rd_defense', dtype('float64')),
 ('Tkl.1', dtype('float64')),
 ('Att_defense', dtype('float64')),
 ('Tkl%', dtype('float64')),
 ('Past', dtype('float64')),
 ('Press_defense', dtype('float64')),
 ('Succ_defense', dtype('float64')),
 ('%', dtype('float64')),
 ('Def 3rd_defense.1', dtype('float64')),
 ('Mid 3rd_defense.1', dtype('float64')),
 ('Att 3rd_defense.1', dtype('float64')),
 ('Blocks_defense', dtype('float64')),
 ('Sh_defense', dtype('float64')),
 ('ShSv', dtype('float64')),
 ('Pass', dtype('float64')),
 ('Int_defense', dtype('float64')),
 ('Tkl+Int', dtype('float64')),
 ('Clr', dtype('float64')),
 ('Err', dtype('float64')),
 ('Poss', dtype('float64')),
 ('Touches', dtype('float64')),
 ('Def Pen', dtype('float64')),
 ('Def 3rd_possession', dtype('float64')),
 ('Mid 3rd_possession', dtype('float64')),
 ('Att 3rd_possession', dtype('float64')),
 ('Att Pen', dtype('float64')),
 ('Live_possession', dtype('float64')),
 ('Succ_possession', dtype('float64')),
 ('Att_possession', dtype('float64')),
 ('Succ%', dtype('float64')),
 ('#Pl', dtype('float64')),
 ('Megs', dtype('float64')),
 ('Carries', dtype('float64')),
 ('TotDist_possession', dtype('float64')),
 ('PrgDist_possession', dtype('float64')),
 ('Prog_possession', dtype('float64')),
 ('1/3_possession', dtype('float64')),
 ('CPA', dtype('float64')),
 ('Mis', dtype('float64')),
 ('Dis', dtype('float64')),
 ('Targ', dtype('float64')),
 ('Rec', dtype('float64')),
 ('Rec%', dtype('float64')),
 ('Prog_possession.1', dtype('float64')),
 ('CrdY', dtype('float64')),
 ('CrdR', dtype('float64')),
 ('2CrdY', dtype('float64')),
 ('Fls', dtype('float64')),
 ('Fld_misc', dtype('float64')),
 ('Off_misc', dtype('float64')),
 ('Crs_misc', dtype('float64')),
 ('Int_misc', dtype('float64')),
 ('TklW_misc', dtype('float64')),
 ('PKwon', dtype('float64')),
 ('PKcon', dtype('float64')),
 ('OG', dtype('float64')),
 ('Recov', dtype('float64')),
 ('Won', dtype('float64')),
 ('Lost', dtype('float64')),
 ('Won%', dtype('float64')),
 ('team', dtype('O')),
 ('Season', dtype('int64'))]</code></pre>
</div>
</div>
<section id="change-some-columns" class="level3">
<h3 class="anchored" data-anchor-id="change-some-columns">Change some columns</h3>
<ul>
<li>Add the predictor column as <code>Win</code> from <code>result</code></li>
<li>Change <code>time</code> to an int of the time eg 16:30 goes to 16.5</li>
<li>Change <code>date</code> to <code>day</code>, <code>month</code>, <code>year</code> and day of week <code>weekday</code></li>
<li>Convert <code>result</code> to int of 2, 1, 0 for W/D/L</li>
<li>Change <code>round</code> to just an int of the matchweek</li>
<li>Convert some columns to int</li>
<li>Sort the DataFrame by <code>season</code> and then <code>round</code></li>
<li>Make sure team names are consistent (sometimes name in <code>opponent</code> column differ from <code>team</code> column</li>
<li>drop columns won’t be using</li>
<li>select matches from Premier league only</li>
<li>create a new DataFrame not lined to old one in case we want old details</li>
</ul>
<div class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Some date time functions</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_time(time):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.time().hour<span class="op">+</span>time.time().minute<span class="op">/</span><span class="dv">60</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_datesDay(time):</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.day</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_datesMonth(time):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.month</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_datesYear(time):</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.year</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_datesWeekDay(time):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> time.weekday()</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mods to target result</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Result(string):</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> string<span class="op">==</span><span class="st">'W'</span>:</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> string<span class="op">==</span><span class="st">'D'</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> columnMods(matches):</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    cols<span class="op">=</span> matches.columns</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    cols<span class="op">=</span>[x.lower() <span class="cf">for</span> x <span class="kw">in</span> cols]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    matches.columns <span class="op">=</span> cols</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Misc</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> matches.astype({<span class="st">'gf'</span>: <span class="st">'int'</span>})</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> matches.astype({<span class="st">'ga'</span>: <span class="st">'int'</span>})</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># some adjustments to time/dates</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    matches<span class="op">=</span>matches.astype({<span class="st">'date'</span>: <span class="st">'datetime64[ns]'</span>})</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> matches.astype({<span class="st">'time'</span>: <span class="st">'datetime64[ns]'</span>})</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'day'</span>] <span class="op">=</span> matches[<span class="st">'date'</span>].<span class="bu">apply</span>(just_datesDay)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'month'</span>] <span class="op">=</span> matches[<span class="st">'date'</span>].<span class="bu">apply</span>(just_datesMonth)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'year'</span>] <span class="op">=</span> matches[<span class="st">'date'</span>].<span class="bu">apply</span>(just_datesYear)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'weekday'</span>] <span class="op">=</span> matches[<span class="st">'date'</span>].<span class="bu">apply</span>(just_datesWeekDay)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># target and results</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'Win'</span>]<span class="op">=</span>matches[<span class="st">'result'</span>]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'NetScore'</span>]<span class="op">=</span>matches[<span class="st">'gf'</span>]<span class="op">-</span>matches[<span class="st">'ga'</span>]</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'GoalsFor'</span>]<span class="op">=</span>matches[<span class="st">'gf'</span>]</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'GoalsAgainst'</span>]<span class="op">=</span>matches[<span class="st">'ga'</span>]</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'result'</span>] <span class="op">=</span> matches[<span class="st">'NetScore'</span>]<span class="co">#matches['result'].apply(Result)</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Change round to an int</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'round'</span>]<span class="op">=</span>matches[<span class="st">'round'</span>].<span class="bu">str</span>.replace(<span class="st">'Matchweek '</span>,<span class="st">''</span>).astype(<span class="st">'int'</span>)</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># drop some columns</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    matches.drop(columns<span class="op">=</span>[<span class="st">'comp'</span>,<span class="st">'match report'</span>,<span class="st">'date'</span>,<span class="st">'time'</span>,<span class="st">'tkl+int'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>        matches <span class="op">=</span> matches.drop(columns<span class="op">=</span><span class="st">'index'</span>)</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>        matches <span class="op">=</span> matches.drop(columns<span class="op">=</span><span class="st">'unnamed: 0'</span>)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">#order by date</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    matches<span class="op">=</span>matches.sort_values([<span class="st">'season'</span>,<span class="st">'round'</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># team name changes</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>    changeTeamName<span class="op">=</span>{<span class="st">'Brighton'</span>:<span class="st">'Brighton and Hove Albion'</span>,</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Manchester Utd'</span>:<span class="st">'Manchester United'</span>,</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Newcastle Utd'</span>:<span class="st">'Newcastle United'</span>,</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Sheffield Utd'</span> : <span class="st">'Sheffield United'</span>,</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Huddersfield'</span> : <span class="st">'Huddersfield Town'</span>,</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Tottenham'</span> : <span class="st">'Tottenham Hotspur'</span>,</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">'West Brom'</span> : <span class="st">'West Bromwich Albion'</span>,</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>                <span class="st">'West Ham'</span> : <span class="st">'West Ham United'</span>,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>                <span class="st">'Wolves'</span> : <span class="st">'Wolverhampton Wanderers'</span>}</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'opponent'</span>]<span class="op">=</span>matches[<span class="st">'opponent'</span>].replace(changeTeamName)</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'team'</span>]<span class="op">=</span>matches[<span class="st">'team'</span>].replace(changeTeamName)</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>    noms<span class="op">=</span>pd.concat([matches.team,matches.opponent]).sort_values().unique()</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>    teamDict<span class="op">=</span>{}</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> team <span class="kw">in</span> noms:</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span> re.sub(<span class="vs">r"([a-z])([A-Z])"</span>,<span class="vs">r"\1 \2"</span>,team) </span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>        teamout <span class="op">=</span>  re.sub(<span class="vs">r"(and)\s"</span>,<span class="vs">r" \1 "</span>,x).strip().replace(<span class="st">'  '</span>,<span class="st">' '</span>)    </span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>        teamDict[team]<span class="op">=</span>teamout</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'team'</span>]<span class="op">=</span>matches[<span class="st">'team'</span>].replace(teamDict)</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>    matches[<span class="st">'opponent'</span>]<span class="op">=</span>matches[<span class="st">'opponent'</span>].replace(teamDict)</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> matches</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>copy.copy(dfAll)</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches[matches.Comp<span class="op">==</span><span class="st">'Premier League'</span>]</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> columnMods(matches)</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>matches[matches.season<span class="op">==</span><span class="dv">2019</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="293">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>venue</th>
      <th>result</th>
      <th>gf</th>
      <th>ga</th>
      <th>opponent</th>
      <th>gls</th>
      <th>sh_shooting</th>
      <th>sot</th>
      <th>...</th>
      <th>won%</th>
      <th>team</th>
      <th>season</th>
      <th>month</th>
      <th>year</th>
      <th>weekday</th>
      <th>Win</th>
      <th>NetScore</th>
      <th>GoalsFor</th>
      <th>GoalsAgainst</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1520</th>
      <td>1</td>
      <td>9</td>
      <td>Home</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>Norwich City</td>
      <td>3.0</td>
      <td>15.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>77.8</td>
      <td>Liverpool</td>
      <td>2019</td>
      <td>8</td>
      <td>2019</td>
      <td>4</td>
      <td>W</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1521</th>
      <td>1</td>
      <td>10</td>
      <td>Away</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>West Ham United</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>50.0</td>
      <td>Manchester City</td>
      <td>2019</td>
      <td>8</td>
      <td>2019</td>
      <td>5</td>
      <td>W</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1522</th>
      <td>1</td>
      <td>11</td>
      <td>Home</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>Chelsea</td>
      <td>4.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>70.6</td>
      <td>Manchester United</td>
      <td>2019</td>
      <td>8</td>
      <td>2019</td>
      <td>6</td>
      <td>W</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1523</th>
      <td>1</td>
      <td>11</td>
      <td>Away</td>
      <td>-4</td>
      <td>0</td>
      <td>4</td>
      <td>Manchester United</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>29.4</td>
      <td>Chelsea</td>
      <td>2019</td>
      <td>8</td>
      <td>2019</td>
      <td>6</td>
      <td>L</td>
      <td>-4</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1524</th>
      <td>1</td>
      <td>11</td>
      <td>Home</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Wolverhampton Wanderers</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>56.8</td>
      <td>Leicester City</td>
      <td>2019</td>
      <td>8</td>
      <td>2019</td>
      <td>6</td>
      <td>D</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2275</th>
      <td>38</td>
      <td>26</td>
      <td>Home</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>Aston Villa</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>61.0</td>
      <td>West Ham United</td>
      <td>2019</td>
      <td>7</td>
      <td>2020</td>
      <td>6</td>
      <td>D</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2276</th>
      <td>38</td>
      <td>26</td>
      <td>Away</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>West Ham United</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>39.0</td>
      <td>Aston Villa</td>
      <td>2019</td>
      <td>7</td>
      <td>2020</td>
      <td>6</td>
      <td>D</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2277</th>
      <td>38</td>
      <td>26</td>
      <td>Away</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>Everton</td>
      <td>3.0</td>
      <td>12.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>46.3</td>
      <td>Bournemouth</td>
      <td>2019</td>
      <td>7</td>
      <td>2020</td>
      <td>6</td>
      <td>W</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2278</th>
      <td>38</td>
      <td>26</td>
      <td>Away</td>
      <td>-1</td>
      <td>2</td>
      <td>3</td>
      <td>Arsenal</td>
      <td>2.0</td>
      <td>18.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>56.1</td>
      <td>Watford</td>
      <td>2019</td>
      <td>7</td>
      <td>2020</td>
      <td>6</td>
      <td>L</td>
      <td>-1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2279</th>
      <td>38</td>
      <td>26</td>
      <td>Away</td>
      <td>-5</td>
      <td>0</td>
      <td>5</td>
      <td>Manchester City</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>40.0</td>
      <td>Norwich City</td>
      <td>2019</td>
      <td>7</td>
      <td>2020</td>
      <td>6</td>
      <td>L</td>
      <td>-5</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>760 rows × 179 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="294">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cluster_features_shootingAll <span class="op">=</span> [</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"gls_x"</span>,<span class="st">"sh_shooting_x"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sot_x"</span>,<span class="st">"sot%_x"</span>,<span class="st">"g/sh_x"</span>,<span class="st">"g/sot_x"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"dist_x"</span>,<span class="st">'fk_shooting_x'</span>,<span class="st">"pk_x"</span>,<span class="st">"pkatt_shooting_x"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xg_x'</span>,<span class="st">'npxg_x'</span>,<span class="st">'npxg/sh_x'</span>,<span class="st">'g-xg_x'</span>,<span class="st">'np:g-xg_x'</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>cluster_features_keeperAll<span class="op">=</span>[</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sota_x'</span>,<span class="st">'saves_x'</span>,<span class="st">'save%_x'</span>,<span class="st">'cs_x'</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'psxg_x'</span>,<span class="st">'psxg+/-_x'</span>,<span class="st">'pkatt_keeper_x'</span>,<span class="st">'pka_x'</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a> <span class="st">'pksv_x'</span>,<span class="st">'pkm_x'</span>,<span class="st">'cmp_keeper_x'</span>,<span class="st">'att_keeper_x'</span>,<span class="st">'cmp%_keeper_x'</span>,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">'cmp%_keeper_x'</span>,<span class="st">'att_keeper.1_x'</span>,<span class="st">'thr_x'</span>,<span class="st">'launch%_x'</span>,<span class="st">'avglen_x'</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">'att_keeper.2_x'</span>,<span class="st">'launch%.1_x'</span>,<span class="st">'avglen.1_x'</span>,<span class="st">'opp_x'</span>,<span class="st">'stp_x'</span>,<span class="st">'stp%_x'</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'#opa_x'</span>,<span class="st">'avgdist_x'</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>cluster_features_passingAll<span class="op">=</span>[</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a> <span class="st">'cmp_passing_x'</span>, <span class="st">'att_passing_x'</span>, <span class="st">'cmp%_passing_x'</span>, <span class="st">'totdist_passing_x'</span>, <span class="st">'prgdist_passing_x'</span>, <span class="st">'cmp_passing.1_x'</span>, <span class="st">'att_passing.1_x'</span>, <span class="st">'cmp%_passing.1_x'</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a> <span class="st">'cmp_passing.2_x'</span>, <span class="st">'att_passing.2_x'</span>, <span class="st">'cmp%_passing.2_x'</span>, <span class="st">'cmp_passing.3_x'</span>, <span class="st">'att_passing.3_x'</span>, <span class="st">'cmp%_passing.3_x'</span>, <span class="st">'ast_x'</span>, <span class="st">'xa_x'</span>, <span class="st">'kp_x'</span>, <span class="st">'1/3_passing_x'</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a> <span class="st">'ppa_x'</span>, <span class="st">'crspa_x'</span>, <span class="st">'prog_passing_x'</span>]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>cluster_features_passtypeAll<span class="op">=</span>[</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a> <span class="st">'att_passing_types_x'</span>, <span class="st">'live_passing_types_x'</span>, <span class="st">'dead_x'</span>, <span class="st">'fk_passing_types_x'</span>, <span class="st">'tb_x'</span>, <span class="st">'press_passing_types_x'</span>, <span class="st">'sw_x'</span>, <span class="st">'crs_passing_types_x'</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a> <span class="st">'ck_x'</span>, <span class="st">'in_x'</span>, <span class="st">'out_x'</span>, <span class="st">'str_x'</span>, <span class="st">'ground_x'</span>, <span class="st">'low_x'</span>, <span class="st">'high_x'</span>, <span class="st">'left_x'</span>, <span class="st">'right_x'</span>, <span class="st">'head_x'</span>, <span class="st">'ti_x'</span>, <span class="st">'other_x'</span>, <span class="st">'cmp_passing_types_x'</span>, <span class="st">'off_passing_types_x'</span>, <span class="st">'out.1_x'</span>, <span class="st">'int_passing_types_x'</span>, <span class="st">'blocks_passing_types_x'</span>]</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>cluster_features_shotcreateAll<span class="op">=</span>[</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a> <span class="st">'sca_x'</span>, <span class="st">'passlive_x'</span>, <span class="st">'passdead_x'</span>, <span class="st">'drib_x'</span>, <span class="st">'sh_gca_x'</span>, <span class="st">'fld_gca_x'</span>, <span class="st">'def_x'</span>, <span class="st">'gca_x'</span>, <span class="st">'passlive.1_x'</span>, <span class="st">'passdead.1_x'</span>, <span class="st">'drib.1_x'</span>, <span class="st">'sh_gca.1_x'</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a> <span class="st">'fld_gca.1_x'</span>, <span class="st">'def.1_x'</span>]</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>cluster_features_tackleAll<span class="op">=</span>[ <span class="st">'tkl_x'</span>, <span class="st">'tklw_defense_x'</span>, <span class="st">'def 3rd_defense_x'</span>, <span class="st">'mid 3rd_defense_x'</span>, <span class="st">'att 3rd_defense_x'</span>, <span class="st">'tkl.1_x'</span>, <span class="st">'att_defense_x'</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a> <span class="st">'tkl%_x'</span>, <span class="st">'past_x'</span>, <span class="st">'press_defense_x'</span>, <span class="st">'succ_defense_x'</span>, <span class="st">'%_x'</span>, <span class="st">'def 3rd_defense.1_x'</span>, <span class="st">'mid 3rd_defense.1_x'</span>, <span class="st">'att 3rd_defense.1_x'</span>, <span class="st">'blocks_defense_x'</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a> <span class="st">'sh_defense_x'</span>, <span class="st">'shsv_x'</span>, <span class="st">'pass_x'</span>, <span class="st">'tkl+int_x'</span>,<span class="st">'int_defense_x'</span>, <span class="st">'clr_x'</span>, <span class="st">'err_x'</span>]</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>cluster_features_possessionAll<span class="op">=</span>[</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a> <span class="st">'poss_x'</span>, <span class="st">'touches_x'</span>, <span class="st">'def pen_x'</span>, <span class="st">'def 3rd_possession_x'</span>, <span class="st">'mid 3rd_possession_x'</span>, <span class="st">'att 3rd_possession_x'</span>, <span class="st">'att pen_x'</span>, <span class="st">'live_possession_x'</span>, <span class="st">'succ_possession_x'</span>, <span class="st">'att_possession_x'</span>, <span class="st">'succ%_x'</span>,</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a> <span class="st">'#pl_x'</span>, <span class="st">'megs_x'</span>, <span class="st">'carries_x'</span>, <span class="st">'totdist_possession_x'</span>, <span class="st">'prgdist_possession_x'</span>, <span class="st">'prog_possession_x'</span>, <span class="st">'1/3_possession_x'</span>, <span class="st">'cpa_x'</span>, <span class="st">'mis_x'</span>, <span class="st">'dis_x'</span>, <span class="st">'targ_x'</span>, <span class="st">'rec_x'</span>,</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a> <span class="st">'rec%_x'</span>, <span class="st">'prog_possession.1_x'</span>]</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>cluster_features_miscAll<span class="op">=</span>[ <span class="st">'crdy_x'</span>, <span class="st">'crdr_x'</span>, <span class="st">'2crdy_x'</span>, <span class="st">'fls_x'</span>, <span class="st">'fld_misc_x'</span>, <span class="st">'off_misc_x'</span>, <span class="st">'crs_misc_x'</span>, <span class="st">'int_misc_x'</span>, <span class="st">'tklw_misc_x'</span>, <span class="st">'pkwon_x'</span>, <span class="st">'pkcon_x'</span>, <span class="st">'og_x'</span>, <span class="st">'recov_x'</span>, <span class="st">'won_x'</span>, <span class="st">'lost_x'</span>, <span class="st">'won%_x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [x for x in df]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_dict_col_names(dict1,string,col_names):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    regexp<span class="op">=</span>string</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> col_names:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>re.sub(<span class="st">'(_x$)'</span>,<span class="st">''</span>,x)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> re.search(regexp,x):</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            x2<span class="op">=</span>string<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>x</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#             print(x2)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            dict1[x]<span class="op">=</span>x2</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>            x2<span class="op">=</span>re.sub(regexp,<span class="st">''</span>,x)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>            x2<span class="op">=</span>string<span class="op">+</span><span class="st">'_'</span><span class="op">+</span>x2</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            x2<span class="op">=</span>x2.strip(<span class="st">'_'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            dict1[x]<span class="op">=</span>x2</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             print(x,'---',x2)</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dict1</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>{}</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'shooting'</span>,cluster_features_shootingAll)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'keeper'</span>,cluster_features_keeperAll)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'passing'</span>,cluster_features_passingAll)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'passing_types'</span>,cluster_features_passtypeAll)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'shotcreate'</span>,cluster_features_shotcreateAll)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'tackle'</span>,cluster_features_tackleAll)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'possession'</span>,cluster_features_possessionAll)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>dict1<span class="op">=</span>do_dict_col_names(dict1,<span class="vs">r'misc'</span>,cluster_features_miscAll)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>dictall<span class="op">=</span>dict1.copy()</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>matches.columns<span class="op">=</span>matches.columns.<span class="bu">str</span>.lower()</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>cols<span class="op">=</span>[]</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> matches:</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        cols.append(dictall[x])</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#         print('---')</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        cols.append(x)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co"># for i,x in enumerate(cols):</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     if re.search(r'^passing_types',x):</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#         x=re.sub(r'(^passing_types)','passingtypes',x)</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#         cols[i]=x</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>matches.columns<span class="op">=</span>cols</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>matches.columns<span class="op">=</span>matches.columns.<span class="bu">str</span>.replace(<span class="st">'passing_types'</span>,<span class="st">'passingtypes'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>noms<span class="op">=</span>pd.concat([matches.team,matches.opponent]).sort_values().unique()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>noms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="297">
<pre><code>array(['Arsenal', 'Aston Villa', 'Bournemouth', 'Brentford',
       'Brighton and Hove Albion', 'Burnley', 'Cardiff City', 'Chelsea',
       'Crystal Palace', 'Everton', 'Fulham', 'Huddersfield Town',
       'Leeds United', 'Leicester City', 'Liverpool', 'Manchester City',
       'Manchester United', 'Newcastle United', 'Norwich City',
       'Sheffield United', 'Southampton', 'Stoke City', 'Swansea City',
       'Tottenham Hotspur', 'Watford', 'West Bromwich Albion',
       'West Ham United', 'Wolverhampton Wanderers'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="i-want-to-make-some-columns-percentages" class="level3">
<h3 class="anchored" data-anchor-id="i-want-to-make-some-columns-percentages">I want to make some columns percentages</h3>
<p>i.e.&nbsp;number of passes in final 3rd -&gt; pc of passes in final 3rd</p>
<div class="cell" data-execution_count="298">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> change_to_pc(col,col_tot,df_matches):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    df_matches.loc[:,col]<span class="op">=</span>df_matches.loc[:,col].div(df_matches.loc[:,col_tot])<span class="op">*</span><span class="dv">100</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    col_new<span class="op">=</span>re.sub(<span class="vs">r'(^[a-z]*_)'</span>,<span class="vs">r"\1PC_"</span>,col)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    df_matches.rename(columns<span class="op">=</span>{col:col_new},inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_matches</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="299">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop columns 'attempts' but keep the % one after it</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cols_to_drop<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> matches <span class="cf">if</span> re.search(<span class="vs">r'^passing_'</span>,x) <span class="kw">and</span> re.search(<span class="vs">r'att'</span>,x)]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cols_to_drop)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> matches.drop(columns<span class="op">=</span>cols_to_drop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['passing_att', 'passing_att_.1', 'passing_att_.2', 'passing_att_.3']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> matches <span class="cf">if</span> re.search(<span class="vs">r'passing_'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'passing_ty'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'%'</span>,x)<span class="op">\</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'xa'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'kp'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'ast'</span>,x)<span class="op">\</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'dist'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'passing_cmp$'</span>,x) ]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cols_to_pc)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'passing_cmp'</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> change_to_pc(<span class="st">'passing_prgdist'</span>,<span class="st">'passing_cmp'</span>,matches)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> change_to_pc(<span class="st">'passing_totdist'</span>,<span class="st">'passing_cmp'</span>,matches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['passing_cmp_.1', 'passing_cmp_.2', 'passing_cmp_.3', 'passing_1/3', 'passing_ppa', 'passing_crspa', 'passing_prog']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.rename(columns<span class="op">=</span>{<span class="st">'passing_cmp'</span>: <span class="st">'passing_pass_complete'</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> <span class="st">'passing_PCcmp_.1'</span>: <span class="st">'passing_pass_complete.shortPC'</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'passing_PCcmp_.2'</span>: <span class="st">'passing_pass_complete.mediumPC'</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a> <span class="st">'passing_PCcmp_.3'</span>: <span class="st">'passing_pass_complete.longPC'</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="302">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> matches <span class="cf">if</span> re.search(<span class="vs">r'passingtype'</span>,x) <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'passingtypes_att'</span>,x)]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cols_to_pc)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'passingtypes_att'</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.drop(columns<span class="op">=</span><span class="st">'passingtypes_att'</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['passingtypes_live', 'passingtypes_dead', 'passingtypes_fk', 'passingtypes_tb', 'passingtypes_press', 'passingtypes_sw', 'passingtypes_crs', 'passingtypes_ck', 'passingtypes_in', 'passingtypes_out', 'passingtypes_str', 'passingtypes_ground', 'passingtypes_low', 'passingtypes_high', 'passingtypes_left', 'passingtypes_right', 'passingtypes_head', 'passingtypes_ti', 'passingtypes_other', 'passingtypes_cmp', 'passingtypes_off', 'passingtypes_out.1', 'passingtypes_int', 'passingtypes_blocks']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="303">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.rename(columns<span class="op">=</span>{<span class="st">'tackle_tkl.1'</span>:<span class="st">'tackle_tkl_dribble'</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'tackle_tkl%'</span> : <span class="st">'tackle_dribble%'</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'tackle_past'</span> : <span class="st">'tackle_dribllepast'</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'tackle_def 3rd_defense.1'</span>:<span class="st">'tackle_press_def3rd'</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'tackle_mid 3rd_defense.1'</span>:<span class="st">'tackle_press_mid3rd'</span>,    </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'tackle_att 3rd_defense.1'</span>:<span class="st">'tackle_press_att3rd'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                     })</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.drop(columns<span class="op">=</span><span class="st">'tackle_att_defense'</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.drop(columns<span class="op">=</span><span class="st">'tackle_succ_defense'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="304">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## this makes tackles as % for first 6 values</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> matches <span class="cf">if</span> re.search(<span class="vs">r'tackle'</span>,x) <span class="op">\</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>            <span class="kw">and</span> <span class="kw">not</span> re.search(<span class="vs">r'passingtypes_att'</span>,x)]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span>cols_to_pc[<span class="dv">0</span>]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cols_to_pc <span class="op">=</span> cols_to_pc[<span class="dv">1</span>:<span class="dv">6</span>]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[<span class="st">'tackle_press_def3rd'</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">'tackle_press_mid3rd'</span>,    </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">'tackle_press_att3rd'</span>]</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'tackle_press_defense'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'tackle_blocks_defense'</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[<span class="st">'tackle_sh_defense'</span>,<span class="st">'tackle_shsv'</span> ,<span class="st">'tackle_pass'</span>]</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="305">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">## possession touches</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> matches <span class="cf">if</span> re.search(<span class="vs">r'possession'</span>,x)  ]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span>cols_to_pc[<span class="dv">1</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>cols_to_pc[<span class="dv">2</span>:<span class="dv">8</span>]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cols_to_pc, col_tot)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['possession_def pen', 'possession_def 3rd', 'possession_mid 3rd', 'possession_att 3rd', 'possession_att pen', 'possession_live'] possession_touches</code></pre>
</div>
</div>
<div class="cell" data-execution_count="306">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>matches<span class="op">=</span>matches.rename(columns<span class="op">=</span>{<span class="st">'possession_succ'</span>:<span class="st">'possession_dribblesucc'</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">'possession_att'</span>:<span class="st">'possession_dribbleatt'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">'possession_succ%'</span>:<span class="st">'possession_dribblesucc%'</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">'possession_#pl'</span>:<span class="st">'possession_dribblepast'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="307">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'possession_totdist'</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>col<span class="op">=</span><span class="st">'possession_prgdist'</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'possession_carries'</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>cols_to_pc<span class="op">=</span>[<span class="st">'possession_prog'</span>,<span class="st">'possession_1/3'</span>,<span class="st">'possession_cpa'</span>,<span class="st">'possession_mis'</span>,<span class="st">'possession_dis'</span>]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> cols_to_pc:</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="308">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>col_tot<span class="op">=</span><span class="st">'shooting_sh'</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>col<span class="op">=</span><span class="st">'shooting_dist'</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>matches <span class="op">=</span> change_to_pc(col,col_tot,matches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="309">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>matches.to_csv(folda<span class="op">+</span><span class="st">'epl_beforeAVG_HA.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="i-want-to-predict-the-results-without-knowing-details-of-the-game" class="level3">
<h3 class="anchored" data-anchor-id="i-want-to-predict-the-results-without-knowing-details-of-the-game">I want to predict the results without knowing details of the game</h3>
<ul>
<li>so some mods</li>
</ul>
<p>So as a first step I will give each gameweek stats for the previous gameweek and the average of the last 5 gameweeks</p>
<p>These stats are everything EXCEPT:</p>
<ul>
<li><code>round</code></li>
<li><code>day</code></li>
<li><code>venue</code></li>
<li><code>opponent</code></li>
<li><code>team</code></li>
<li><code>month</code></li>
<li><code>year</code></li>
<li><code>weekday</code></li>
<li><code>Win</code></li>
</ul>
<div class="cell" data-execution_count="310">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>no_change<span class="op">=</span>[<span class="st">'round'</span>,<span class="st">'day'</span>,<span class="st">'venue'</span>,<span class="st">'opponent'</span>,<span class="st">'team'</span>,<span class="op">\</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a> <span class="st">'month'</span>,<span class="st">'year'</span>,<span class="st">'weekday'</span>,<span class="st">'season'</span>,<span class="st">'Win'</span>,<span class="st">'NetScore'</span>,<span class="st">'GoalsFor'</span>,<span class="st">'GoalsAgainst'</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>colRepeat <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> matches.columns <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> no_change]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>[x <span class="cf">for</span> x <span class="kw">in</span> colRepeat]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="310">
<pre><code>['result',
 'gf',
 'ga',
 'shooting_gls',
 'shooting_sh',
 'shooting_sot',
 'shooting_sot%',
 'shooting_g/sh',
 'shooting_g/sot',
 'shooting_PC_dist',
 'shooting_fk',
 'shooting_pk',
 'shooting_pkatt',
 'shooting_xg',
 'shooting_npxg',
 'shooting_npxg/sh',
 'shooting_g-xg',
 'shooting_np:g-xg',
 'keeper_sota',
 'keeper_saves',
 'keeper_save%',
 'keeper_cs',
 'keeper_psxg',
 'keeper_psxg+/-',
 'keeper_pkatt',
 'keeper_pka',
 'keeper_pksv',
 'keeper_pkm',
 'keeper_cmp',
 'keeper_att',
 'keeper_cmp%',
 'keeper_att_.1',
 'keeper_thr',
 'keeper_launch%',
 'keeper_avglen',
 'keeper_att_.2',
 'keeper_launch%.1',
 'keeper_avglen.1',
 'keeper_opp',
 'keeper_stp',
 'keeper_stp%',
 'keeper_#opa',
 'keeper_avgdist',
 'passing_pass_complete',
 'passing_cmp%',
 'passing_PC_totdist',
 'passing_PC_prgdist',
 'passing_PC_cmp_.1',
 'passing_cmp%_.1',
 'passing_PC_cmp_.2',
 'passing_cmp%_.2',
 'passing_PC_cmp_.3',
 'passing_cmp%_.3',
 'passing_ast',
 'passing_xa',
 'passing_kp',
 'passing_PC_1/3',
 'passing_PC_ppa',
 'passing_PC_crspa',
 'passing_PC_prog',
 'passingtypes_PC_live',
 'passingtypes_PC_dead',
 'passingtypes_PC_fk',
 'passingtypes_PC_tb',
 'passingtypes_PC_press',
 'passingtypes_PC_sw',
 'passingtypes_PC_crs',
 'passingtypes_PC_ck',
 'passingtypes_PC_in',
 'passingtypes_PC_out',
 'passingtypes_PC_str',
 'passingtypes_PC_ground',
 'passingtypes_PC_low',
 'passingtypes_PC_high',
 'passingtypes_PC_left',
 'passingtypes_PC_right',
 'passingtypes_PC_head',
 'passingtypes_PC_ti',
 'passingtypes_PC_other',
 'passingtypes_PC_cmp',
 'passingtypes_PC_off',
 'passingtypes_PC_out.1',
 'passingtypes_PC_int',
 'passingtypes_PC_blocks',
 'shotcreate_sca',
 'shotcreate_passlive',
 'shotcreate_passdead',
 'shotcreate_drib',
 'shotcreate_sh_gca',
 'shotcreate_fld_gca',
 'shotcreate_def',
 'shotcreate_gca',
 'shotcreate_passlive.1',
 'shotcreate_passdead.1',
 'shotcreate_drib.1',
 'shotcreate_sh_gca.1',
 'shotcreate_fld_gca.1',
 'shotcreate_def.1',
 'tackle_tkl',
 'tackle_PC_tklw_defense',
 'tackle_PC_def 3rd_defense',
 'tackle_PC_mid 3rd_defense',
 'tackle_PC_att 3rd_defense',
 'tackle_PC_tkl_dribble',
 'tackle_dribble%',
 'tackle_dribllepast',
 'tackle_press_defense',
 'tackle_%',
 'tackle_PC_press_def3rd',
 'tackle_PC_press_mid3rd',
 'tackle_PC_press_att3rd',
 'tackle_blocks_defense',
 'tackle_PC_sh_defense',
 'tackle_PC_shsv',
 'tackle_PC_pass',
 'tackle_int_defense',
 'tackle_clr',
 'tackle_err',
 'possession_poss',
 'possession_touches',
 'possession_PC_def pen',
 'possession_PC_def 3rd',
 'possession_PC_mid 3rd',
 'possession_PC_att 3rd',
 'possession_PC_att pen',
 'possession_PC_live',
 'possession_dribblesucc',
 'possession_dribbleatt',
 'possession_dribblesucc%',
 'possession_dribblepast',
 'possession_megs',
 'possession_carries',
 'possession_totdist',
 'possession_PC_prgdist',
 'possession_PC_prog',
 'possession_PC_1/3',
 'possession_PC_cpa',
 'possession_PC_mis',
 'possession_PC_dis',
 'possession_targ',
 'possession_rec',
 'possession_rec%',
 'possession_prog_.1',
 'misc_crdy',
 'misc_crdr',
 'misc_2crdy',
 'misc_fls',
 'misc_fld',
 'misc_off',
 'misc_crs',
 'misc_int',
 'misc_tklw',
 'misc_pkwon',
 'misc_pkcon',
 'misc_og',
 'misc_recov',
 'misc_won',
 'misc_lost',
 'misc_won%',
 'win',
 'netscore',
 'goalsfor',
 'goalsagainst']</code></pre>
</div>
</div>
</section>
<section id="converts-data-into-rolling-average-of-previous-matches" class="level3">
<h3 class="anchored" data-anchor-id="converts-data-into-rolling-average-of-previous-matches">Converts data into rolling average of previous matches</h3>
<p>https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rolling.html</p>
<section id="windowint-offset-or-baseindexer-subclass" class="level5">
<h5 class="anchored" data-anchor-id="windowint-offset-or-baseindexer-subclass">windowint, offset, or BaseIndexer subclass</h5>
<ul>
<li><p>Size of the moving window.</p></li>
<li><p>If an integer, the fixed number of observations used for each window.</p></li>
<li><p>If an offset, the time period of each window. Each window will be a variable sized based on the observations included in the time-period. This is only valid for datetimelike indexes. To learn more about the offsets &amp; frequency strings, please see this link.</p></li>
<li><p>If a BaseIndexer subclass, the window boundaries based on the defined get_window_bounds method. Additional rolling keyword arguments, namely min_periods, center, and closed will be passed to get_window_bounds.</p></li>
</ul>
</section>
<section id="min_periodsint-default-none" class="level5">
<h5 class="anchored" data-anchor-id="min_periodsint-default-none">min_periodsint, default None</h5>
<ul>
<li><p>Minimum number of observations in window required to have a value; otherwise, result is np.nan.</p></li>
<li><p>For a window that is specified by an offset, min_periods will default to 1.</p></li>
<li><p>For a window that is specified by an integer, min_periods will default to the size of the window.</p></li>
</ul>
</section>
<section id="closed-str-default-none" class="level5">
<h5 class="anchored" data-anchor-id="closed-str-default-none">closed : str, default None</h5>
<ul>
<li><p>If ‘right’, the first point in the window is excluded from calculations.</p></li>
<li><p>If ‘left’, the last point in the window is excluded from calculations.</p></li>
<li><p>If ‘both’, the no points in the window are excluded from calculations.</p></li>
<li><p>If ‘neither’, the first and last points in the window are excluded from calculations.</p></li>
<li><p>Default None (‘right’).</p></li>
</ul>
<div class="cell" data-scrolled="true" data-execution_count="311">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>matches_<span class="op">=</span>matches.copy()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> matches_.team.unique():</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    matches_.loc[matches_.team<span class="op">==</span>x,colRepeat] <span class="op">=</span> matches_.loc[matches_.team<span class="op">==</span>x,colRepeat].rolling(window<span class="op">=</span><span class="dv">3</span>,closed<span class="op">=</span><span class="st">'left'</span>,min_periods<span class="op">=</span><span class="dv">1</span>).mean()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>matches_.loc[matches_[<span class="st">'round'</span>]<span class="op">&gt;</span><span class="dv">10</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="311">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>venue</th>
      <th>result</th>
      <th>gf</th>
      <th>ga</th>
      <th>opponent</th>
      <th>shooting_gls</th>
      <th>shooting_sh</th>
      <th>shooting_sot</th>
      <th>...</th>
      <th>misc_won%</th>
      <th>team</th>
      <th>season</th>
      <th>month</th>
      <th>year</th>
      <th>weekday</th>
      <th>win</th>
      <th>netscore</th>
      <th>goalsfor</th>
      <th>goalsagainst</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>200</th>
      <td>11</td>
      <td>5</td>
      <td>Home</td>
      <td>3.000000</td>
      <td>4.333333</td>
      <td>1.333333</td>
      <td>Arsenal</td>
      <td>4.333333</td>
      <td>16.666667</td>
      <td>8.666667</td>
      <td>...</td>
      <td>63.633333</td>
      <td>Manchester City</td>
      <td>2017</td>
      <td>11</td>
      <td>2017</td>
      <td>6</td>
      <td>NaN</td>
      <td>3.000000</td>
      <td>4.333333</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>201</th>
      <td>11</td>
      <td>5</td>
      <td>Away</td>
      <td>0.000000</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>Chelsea</td>
      <td>0.666667</td>
      <td>9.000000</td>
      <td>2.666667</td>
      <td>...</td>
      <td>54.000000</td>
      <td>Manchester United</td>
      <td>2017</td>
      <td>11</td>
      <td>2017</td>
      <td>6</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>202</th>
      <td>11</td>
      <td>5</td>
      <td>Home</td>
      <td>1.000000</td>
      <td>1.666667</td>
      <td>0.666667</td>
      <td>Crystal Palace</td>
      <td>1.666667</td>
      <td>14.666667</td>
      <td>5.000000</td>
      <td>...</td>
      <td>51.466667</td>
      <td>Tottenham Hotspur</td>
      <td>2017</td>
      <td>11</td>
      <td>2017</td>
      <td>6</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.666667</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>203</th>
      <td>11</td>
      <td>4</td>
      <td>Away</td>
      <td>0.000000</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>West Ham United</td>
      <td>1.333333</td>
      <td>16.000000</td>
      <td>6.333333</td>
      <td>...</td>
      <td>46.800000</td>
      <td>Liverpool</td>
      <td>2017</td>
      <td>11</td>
      <td>2017</td>
      <td>5</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.333333</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>204</th>
      <td>11</td>
      <td>5</td>
      <td>Home</td>
      <td>0.666667</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>Manchester United</td>
      <td>2.000000</td>
      <td>16.000000</td>
      <td>5.666667</td>
      <td>...</td>
      <td>63.433333</td>
      <td>Chelsea</td>
      <td>2017</td>
      <td>11</td>
      <td>2017</td>
      <td>6</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>2.000000</td>
      <td>1.333333</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 172 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="312">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>matches_.loc[(matches.team<span class="op">==</span><span class="st">'Arsenal'</span>),[<span class="st">'round'</span>,]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="312">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2</td>
    </tr>
    <tr>
      <th>45</th>
      <td>3</td>
    </tr>
    <tr>
      <th>65</th>
      <td>4</td>
    </tr>
    <tr>
      <th>85</th>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>3704</th>
      <td>34</td>
    </tr>
    <tr>
      <th>3724</th>
      <td>35</td>
    </tr>
    <tr>
      <th>3744</th>
      <td>36</td>
    </tr>
    <tr>
      <th>3764</th>
      <td>37</td>
    </tr>
    <tr>
      <th>3784</th>
      <td>38</td>
    </tr>
  </tbody>
</table>
<p>190 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="313">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>matches.loc[(matches.team<span class="op">==</span><span class="st">'Arsenal'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>venue</th>
      <th>result</th>
      <th>gf</th>
      <th>ga</th>
      <th>opponent</th>
      <th>shooting_gls</th>
      <th>shooting_sh</th>
      <th>shooting_sot</th>
      <th>...</th>
      <th>misc_won%</th>
      <th>team</th>
      <th>season</th>
      <th>month</th>
      <th>year</th>
      <th>weekday</th>
      <th>win</th>
      <th>netscore</th>
      <th>goalsfor</th>
      <th>goalsagainst</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>11</td>
      <td>Home</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>Leicester City</td>
      <td>4.0</td>
      <td>27.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>50.0</td>
      <td>Arsenal</td>
      <td>2017</td>
      <td>8</td>
      <td>2017</td>
      <td>4</td>
      <td>W</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2</td>
      <td>19</td>
      <td>Away</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
      <td>Stoke City</td>
      <td>0.0</td>
      <td>19.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>40.0</td>
      <td>Arsenal</td>
      <td>2017</td>
      <td>8</td>
      <td>2017</td>
      <td>5</td>
      <td>L</td>
      <td>-1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>45</th>
      <td>3</td>
      <td>27</td>
      <td>Away</td>
      <td>-4</td>
      <td>0</td>
      <td>4</td>
      <td>Liverpool</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>54.5</td>
      <td>Arsenal</td>
      <td>2017</td>
      <td>8</td>
      <td>2017</td>
      <td>6</td>
      <td>L</td>
      <td>-4</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>65</th>
      <td>4</td>
      <td>9</td>
      <td>Home</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>Bournemouth</td>
      <td>3.0</td>
      <td>17.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>51.1</td>
      <td>Arsenal</td>
      <td>2017</td>
      <td>9</td>
      <td>2017</td>
      <td>5</td>
      <td>W</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>5</td>
      <td>17</td>
      <td>Away</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Chelsea</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>48.8</td>
      <td>Arsenal</td>
      <td>2017</td>
      <td>9</td>
      <td>2017</td>
      <td>6</td>
      <td>D</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3704</th>
      <td>34</td>
      <td>23</td>
      <td>Home</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>Manchester United</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>19.0</td>
      <td>Arsenal</td>
      <td>2021</td>
      <td>4</td>
      <td>2022</td>
      <td>5</td>
      <td>W</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3724</th>
      <td>35</td>
      <td>1</td>
      <td>Away</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>West Ham United</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>51.5</td>
      <td>Arsenal</td>
      <td>2021</td>
      <td>5</td>
      <td>2022</td>
      <td>6</td>
      <td>W</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3744</th>
      <td>36</td>
      <td>8</td>
      <td>Home</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>Leeds United</td>
      <td>2.0</td>
      <td>19.0</td>
      <td>9.0</td>
      <td>...</td>
      <td>42.9</td>
      <td>Arsenal</td>
      <td>2021</td>
      <td>5</td>
      <td>2022</td>
      <td>6</td>
      <td>W</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3764</th>
      <td>37</td>
      <td>16</td>
      <td>Away</td>
      <td>-2</td>
      <td>0</td>
      <td>2</td>
      <td>Newcastle United</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>45.0</td>
      <td>Arsenal</td>
      <td>2021</td>
      <td>5</td>
      <td>2022</td>
      <td>0</td>
      <td>L</td>
      <td>-2</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3784</th>
      <td>38</td>
      <td>22</td>
      <td>Home</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
      <td>Everton</td>
      <td>5.0</td>
      <td>25.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>48.4</td>
      <td>Arsenal</td>
      <td>2021</td>
      <td>5</td>
      <td>2022</td>
      <td>6</td>
      <td>W</td>
      <td>4</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>190 rows × 172 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="combine-results-for-both-home-and-away-teams" class="level3">
<h3 class="anchored" data-anchor-id="combine-results-for-both-home-and-away-teams">Combine results for both home and away teams</h3>
<p>i.e.&nbsp;combine <code>team</code>/<code>opponent</code> combos for a particular match. Will have different data for <code>team</code>/<code>opponent</code></p>
<div class="cell" data-execution_count="314">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>matchesC<span class="op">=</span>matches_.copy()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>matchesC<span class="op">=</span>matches_.merge(matches_, left_on <span class="op">=</span> [<span class="st">"month"</span>,<span class="st">'year'</span>,<span class="st">'weekday'</span>,<span class="st">"round"</span>,<span class="st">"day"</span>,<span class="st">'season'</span>, <span class="st">"team"</span>], <span class="op">\</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                       right_on<span class="op">=</span> [<span class="st">"month"</span>,<span class="st">'year'</span>,<span class="st">'weekday'</span>,<span class="st">"round"</span>,<span class="st">"day"</span>,<span class="st">'season'</span>, <span class="st">"opponent"</span>])</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>matchesC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="314">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>venue_x</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>opponent_x</th>
      <th>shooting_gls_x</th>
      <th>shooting_sh_x</th>
      <th>shooting_sot_x</th>
      <th>...</th>
      <th>misc_og_y</th>
      <th>misc_recov_y</th>
      <th>misc_won_y</th>
      <th>misc_lost_y</th>
      <th>misc_won%_y</th>
      <th>team_y</th>
      <th>win_y</th>
      <th>netscore_y</th>
      <th>goalsfor_y</th>
      <th>goalsagainst_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>12</td>
      <td>Away</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Brighton and Hove Albion</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Brighton and Hove Albion</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13</td>
      <td>Home</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>West Ham United</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>West Ham United</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>13</td>
      <td>Away</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Newcastle United</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Newcastle United</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>12</td>
      <td>Away</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Watford</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Watford</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>12</td>
      <td>Home</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Burnley</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Burnley</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3795</th>
      <td>38</td>
      <td>22</td>
      <td>Away</td>
      <td>0.333333</td>
      <td>1.666667</td>
      <td>1.333333</td>
      <td>Arsenal</td>
      <td>1.666667</td>
      <td>9.333333</td>
      <td>4.000000</td>
      <td>...</td>
      <td>0.333333</td>
      <td>74.333333</td>
      <td>14.666667</td>
      <td>16.666667</td>
      <td>46.466667</td>
      <td>Arsenal</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.333333</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>3796</th>
      <td>38</td>
      <td>22</td>
      <td>Away</td>
      <td>-1.666667</td>
      <td>0.666667</td>
      <td>2.333333</td>
      <td>Brentford</td>
      <td>0.666667</td>
      <td>9.666667</td>
      <td>2.333333</td>
      <td>...</td>
      <td>0.000000</td>
      <td>80.333333</td>
      <td>15.333333</td>
      <td>15.666667</td>
      <td>48.333333</td>
      <td>Brentford</td>
      <td>NaN</td>
      <td>0.333333</td>
      <td>2.000000</td>
      <td>1.666667</td>
    </tr>
    <tr>
      <th>3797</th>
      <td>38</td>
      <td>22</td>
      <td>Home</td>
      <td>-0.666667</td>
      <td>1.000000</td>
      <td>1.666667</td>
      <td>Newcastle United</td>
      <td>1.000000</td>
      <td>13.000000</td>
      <td>4.333333</td>
      <td>...</td>
      <td>0.000000</td>
      <td>64.333333</td>
      <td>20.000000</td>
      <td>19.000000</td>
      <td>48.766667</td>
      <td>Newcastle United</td>
      <td>NaN</td>
      <td>-1.333333</td>
      <td>0.666667</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>3798</th>
      <td>38</td>
      <td>22</td>
      <td>Away</td>
      <td>-2.000000</td>
      <td>0.666667</td>
      <td>2.666667</td>
      <td>Chelsea</td>
      <td>0.333333</td>
      <td>10.666667</td>
      <td>2.666667</td>
      <td>...</td>
      <td>0.000000</td>
      <td>88.000000</td>
      <td>17.666667</td>
      <td>13.666667</td>
      <td>57.066667</td>
      <td>Chelsea</td>
      <td>NaN</td>
      <td>-0.333333</td>
      <td>1.000000</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>3799</th>
      <td>38</td>
      <td>22</td>
      <td>Home</td>
      <td>-2.000000</td>
      <td>0.333333</td>
      <td>2.333333</td>
      <td>Tottenham Hotspur</td>
      <td>0.333333</td>
      <td>9.666667</td>
      <td>2.333333</td>
      <td>...</td>
      <td>0.000000</td>
      <td>81.666667</td>
      <td>23.666667</td>
      <td>17.000000</td>
      <td>57.633333</td>
      <td>Tottenham Hotspur</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.666667</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
<p>3800 rows × 338 columns</p>
</div>
</div>
</div>
<section id="save-the-data" class="level4">
<h4 class="anchored" data-anchor-id="save-the-data">Save the data</h4>
<div class="cell" data-execution_count="315">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>whatsave<span class="op">=</span><span class="dv">1</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> whatsave<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    matchesOut<span class="op">=</span>matchesC.copy()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    matchesOut<span class="op">=</span>matchesOut.drop(columns<span class="op">=</span>[<span class="st">'venue_x'</span>,<span class="st">'venue_y'</span>,<span class="st">'win_y'</span>,<span class="st">'netscore_y'</span>,<span class="st">'goalsfor_x'</span>,<span class="st">'goalsfor_y'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'goalsagainst_x'</span>,<span class="st">'goalsagainst_y'</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    matchesOut.to_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscore_both-HA.csv'</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> whatsave<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    matchesOut<span class="op">=</span>matchesC.copy()</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    matchesOut<span class="op">=</span>matchesOut.drop(columns<span class="op">=</span>[<span class="st">'venue_y'</span>,<span class="st">'win_y'</span>,<span class="st">'netscore_y'</span>,<span class="st">'goalsfor_y'</span>,<span class="st">'goalsagainst_y'</span>])</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    matchesOut.to_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscoreAndGFGA_both-HA.csv'</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    </span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># matchesC=matchesC.drop(columns=['opponent_x','opponent_y'])</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># matchesC=matchesC.loc[matchesC['venue_x']=='Home']</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="316">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>matchesC[[<span class="st">'venue_x'</span>,<span class="st">'venue_y'</span>,<span class="st">'win_y'</span>,<span class="st">'netscore_y'</span>,<span class="st">'goalsfor_x'</span>,<span class="st">'goalsfor_y'</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">'goalsagainst_x'</span>,<span class="st">'goalsagainst_y'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="316">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>venue_x</th>
      <th>venue_y</th>
      <th>win_y</th>
      <th>netscore_y</th>
      <th>goalsfor_x</th>
      <th>goalsfor_y</th>
      <th>goalsagainst_x</th>
      <th>goalsagainst_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Home</td>
      <td>Away</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Home</td>
      <td>Away</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3795</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.666667</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>3796</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>0.333333</td>
      <td>0.666667</td>
      <td>2.000000</td>
      <td>2.333333</td>
      <td>1.666667</td>
    </tr>
    <tr>
      <th>3797</th>
      <td>Home</td>
      <td>Away</td>
      <td>NaN</td>
      <td>-1.333333</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>1.666667</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>3798</th>
      <td>Away</td>
      <td>Home</td>
      <td>NaN</td>
      <td>-0.333333</td>
      <td>0.666667</td>
      <td>1.000000</td>
      <td>2.666667</td>
      <td>1.333333</td>
    </tr>
    <tr>
      <th>3799</th>
      <td>Home</td>
      <td>Away</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.333333</td>
      <td>1.666667</td>
      <td>2.333333</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
<p>3800 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">## SANITY CHECKS</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>teamName<span class="op">=</span><span class="st">'Manchester United'</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>year<span class="op">=</span><span class="dv">2017</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>mc<span class="op">=</span>matchesC.loc[((  (matchesC.team_x<span class="op">==</span>teamName) ))][[<span class="st">'round'</span>,<span class="st">'team_x'</span>,<span class="st">'team_y'</span>,<span class="st">'result_x'</span>,<span class="st">'season'</span>]]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>mraw<span class="op">=</span>matches.loc[((  matches.team<span class="op">==</span>teamName  ))][[<span class="st">'round'</span>,<span class="st">'team'</span>,<span class="st">'opponent'</span>,<span class="st">'result'</span>,<span class="st">'season'</span>]]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="318">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">5</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.plot( (mc[<span class="st">'round'</span>]<span class="op">+</span>(mc[<span class="st">'season'</span>]<span class="op">-</span><span class="dv">2017</span>)<span class="op">*</span><span class="dv">38</span>)<span class="op">/</span><span class="dv">38</span>, mraw[<span class="st">'result'</span>] ,<span class="st">'.-'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plt.plot( (mc[<span class="st">'round'</span>]<span class="op">+</span>(mc[<span class="st">'season'</span>]<span class="op">-</span><span class="dv">2017</span>)<span class="op">*</span><span class="dv">38</span>)<span class="op">/</span><span class="dv">38</span>, mc[<span class="st">'result_x'</span>] ,<span class="st">'.-'</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'raw'</span>,<span class="st">'running average'</span>])<span class="op">;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-PrepareTheData_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="319">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mg <span class="op">=</span> matchesC.groupby(<span class="st">'team_x'</span>).mean()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="319">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>shooting_gls_x</th>
      <th>shooting_sh_x</th>
      <th>shooting_sot_x</th>
      <th>shooting_sot%_x</th>
      <th>shooting_g/sh_x</th>
      <th>...</th>
      <th>misc_pkwon_y</th>
      <th>misc_pkcon_y</th>
      <th>misc_og_y</th>
      <th>misc_recov_y</th>
      <th>misc_won_y</th>
      <th>misc_lost_y</th>
      <th>misc_won%_y</th>
      <th>netscore_y</th>
      <th>goalsfor_y</th>
      <th>goalsagainst_y</th>
    </tr>
    <tr>
      <th>team_x</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Arsenal</th>
      <td>19.5</td>
      <td>15.210526</td>
      <td>0.421517</td>
      <td>1.675485</td>
      <td>1.253968</td>
      <td>1.633157</td>
      <td>13.111111</td>
      <td>4.514109</td>
      <td>35.496473</td>
      <td>0.126499</td>
      <td>...</td>
      <td>0.112589</td>
      <td>0.136525</td>
      <td>0.042553</td>
      <td>91.012411</td>
      <td>19.406915</td>
      <td>19.757979</td>
      <td>49.480762</td>
      <td>-0.061170</td>
      <td>1.287234</td>
      <td>1.348404</td>
    </tr>
    <tr>
      <th>Aston Villa</th>
      <td>19.5</td>
      <td>15.903509</td>
      <td>-0.181416</td>
      <td>1.286136</td>
      <td>1.467552</td>
      <td>1.233038</td>
      <td>12.609145</td>
      <td>4.261062</td>
      <td>33.371829</td>
      <td>0.092640</td>
      <td>...</td>
      <td>0.102339</td>
      <td>0.122807</td>
      <td>0.052632</td>
      <td>89.173977</td>
      <td>17.751462</td>
      <td>18.026316</td>
      <td>49.695760</td>
      <td>0.114035</td>
      <td>1.388889</td>
      <td>1.274854</td>
    </tr>
    <tr>
      <th>Bournemouth</th>
      <td>19.5</td>
      <td>15.868421</td>
      <td>-0.500000</td>
      <td>1.218289</td>
      <td>1.718289</td>
      <td>1.191740</td>
      <td>11.336283</td>
      <td>3.691740</td>
      <td>32.124926</td>
      <td>0.095973</td>
      <td>...</td>
      <td>0.093093</td>
      <td>0.123123</td>
      <td>0.030030</td>
      <td>93.247748</td>
      <td>20.250751</td>
      <td>20.214715</td>
      <td>50.193544</td>
      <td>0.057057</td>
      <td>1.409910</td>
      <td>1.352853</td>
    </tr>
    <tr>
      <th>Brentford</th>
      <td>19.5</td>
      <td>15.394737</td>
      <td>-0.189189</td>
      <td>1.234234</td>
      <td>1.423423</td>
      <td>1.198198</td>
      <td>11.297297</td>
      <td>3.549550</td>
      <td>31.855405</td>
      <td>0.092117</td>
      <td>...</td>
      <td>0.114035</td>
      <td>0.140351</td>
      <td>0.061404</td>
      <td>82.771930</td>
      <td>16.850877</td>
      <td>16.429825</td>
      <td>51.121930</td>
      <td>0.052632</td>
      <td>1.394737</td>
      <td>1.342105</td>
    </tr>
    <tr>
      <th>Brighton and Hove Albion</th>
      <td>19.5</td>
      <td>16.052632</td>
      <td>-0.388007</td>
      <td>0.978836</td>
      <td>1.366843</td>
      <td>0.936508</td>
      <td>11.276014</td>
      <td>3.218695</td>
      <td>30.280688</td>
      <td>0.080811</td>
      <td>...</td>
      <td>0.095238</td>
      <td>0.127866</td>
      <td>0.040564</td>
      <td>89.408289</td>
      <td>19.255732</td>
      <td>19.731041</td>
      <td>49.229630</td>
      <td>0.059965</td>
      <td>1.424162</td>
      <td>1.364198</td>
    </tr>
    <tr>
      <th>Burnley</th>
      <td>19.5</td>
      <td>16.168421</td>
      <td>-0.375661</td>
      <td>1.016755</td>
      <td>1.392416</td>
      <td>0.974427</td>
      <td>10.093474</td>
      <td>3.194004</td>
      <td>31.874427</td>
      <td>0.103527</td>
      <td>...</td>
      <td>0.095238</td>
      <td>0.128748</td>
      <td>0.038801</td>
      <td>88.843034</td>
      <td>18.495591</td>
      <td>18.074074</td>
      <td>50.651764</td>
      <td>-0.073192</td>
      <td>1.338624</td>
      <td>1.411817</td>
    </tr>
    <tr>
      <th>Cardiff City</th>
      <td>19.5</td>
      <td>15.921053</td>
      <td>-1.018018</td>
      <td>0.828829</td>
      <td>1.846847</td>
      <td>0.819820</td>
      <td>10.761261</td>
      <td>2.842342</td>
      <td>29.641441</td>
      <td>0.074865</td>
      <td>...</td>
      <td>0.078947</td>
      <td>0.149123</td>
      <td>0.026316</td>
      <td>91.561404</td>
      <td>19.140351</td>
      <td>18.307018</td>
      <td>51.198246</td>
      <td>0.026316</td>
      <td>1.412281</td>
      <td>1.385965</td>
    </tr>
    <tr>
      <th>Chelsea</th>
      <td>19.5</td>
      <td>15.963158</td>
      <td>0.668430</td>
      <td>1.728395</td>
      <td>1.059965</td>
      <td>1.691358</td>
      <td>15.545855</td>
      <td>5.257496</td>
      <td>34.136684</td>
      <td>0.103307</td>
      <td>...</td>
      <td>0.121693</td>
      <td>0.126984</td>
      <td>0.052028</td>
      <td>91.537919</td>
      <td>20.075838</td>
      <td>19.852734</td>
      <td>50.077778</td>
      <td>-0.105820</td>
      <td>1.294533</td>
      <td>1.400353</td>
    </tr>
    <tr>
      <th>Crystal Palace</th>
      <td>19.5</td>
      <td>16.310526</td>
      <td>-0.296296</td>
      <td>1.142857</td>
      <td>1.439153</td>
      <td>1.100529</td>
      <td>10.937390</td>
      <td>3.427690</td>
      <td>32.483686</td>
      <td>0.100838</td>
      <td>...</td>
      <td>0.109929</td>
      <td>0.143617</td>
      <td>0.028369</td>
      <td>90.376773</td>
      <td>19.329787</td>
      <td>19.449468</td>
      <td>49.848493</td>
      <td>0.152482</td>
      <td>1.443262</td>
      <td>1.290780</td>
    </tr>
    <tr>
      <th>Everton</th>
      <td>19.5</td>
      <td>14.710526</td>
      <td>-0.194885</td>
      <td>1.216931</td>
      <td>1.411817</td>
      <td>1.174603</td>
      <td>11.298060</td>
      <td>3.654321</td>
      <td>32.695414</td>
      <td>0.100979</td>
      <td>...</td>
      <td>0.093972</td>
      <td>0.126773</td>
      <td>0.057624</td>
      <td>89.239362</td>
      <td>18.835993</td>
      <td>18.802305</td>
      <td>49.994415</td>
      <td>-0.075355</td>
      <td>1.358156</td>
      <td>1.433511</td>
    </tr>
    <tr>
      <th>Fulham</th>
      <td>19.5</td>
      <td>15.289474</td>
      <td>-0.964444</td>
      <td>0.802222</td>
      <td>1.766667</td>
      <td>0.775556</td>
      <td>11.673333</td>
      <td>3.460000</td>
      <td>29.526667</td>
      <td>0.058756</td>
      <td>...</td>
      <td>0.118421</td>
      <td>0.184211</td>
      <td>0.043860</td>
      <td>88.429825</td>
      <td>18.258772</td>
      <td>18.456140</td>
      <td>49.566228</td>
      <td>-0.188596</td>
      <td>1.381579</td>
      <td>1.570175</td>
    </tr>
    <tr>
      <th>Huddersfield Town</th>
      <td>19.5</td>
      <td>16.026316</td>
      <td>-1.062222</td>
      <td>0.680000</td>
      <td>1.742222</td>
      <td>0.602222</td>
      <td>10.044444</td>
      <td>2.935556</td>
      <td>30.048889</td>
      <td>0.055511</td>
      <td>...</td>
      <td>0.146667</td>
      <td>0.142222</td>
      <td>0.044444</td>
      <td>91.108889</td>
      <td>21.348889</td>
      <td>21.073333</td>
      <td>50.432222</td>
      <td>-0.233333</td>
      <td>1.282222</td>
      <td>1.515556</td>
    </tr>
    <tr>
      <th>Leeds United</th>
      <td>19.5</td>
      <td>16.078947</td>
      <td>-0.404444</td>
      <td>1.388889</td>
      <td>1.793333</td>
      <td>1.362222</td>
      <td>13.184444</td>
      <td>4.442222</td>
      <td>35.603778</td>
      <td>0.110378</td>
      <td>...</td>
      <td>0.114035</td>
      <td>0.162281</td>
      <td>0.048246</td>
      <td>84.732456</td>
      <td>18.061404</td>
      <td>17.293860</td>
      <td>51.365789</td>
      <td>0.008772</td>
      <td>1.364035</td>
      <td>1.355263</td>
    </tr>
    <tr>
      <th>Leicester City</th>
      <td>19.5</td>
      <td>15.889474</td>
      <td>0.212522</td>
      <td>1.582892</td>
      <td>1.370370</td>
      <td>1.519400</td>
      <td>12.416226</td>
      <td>4.320106</td>
      <td>35.845767</td>
      <td>0.121587</td>
      <td>...</td>
      <td>0.121693</td>
      <td>0.111111</td>
      <td>0.045855</td>
      <td>88.839506</td>
      <td>18.775132</td>
      <td>19.029101</td>
      <td>49.624868</td>
      <td>-0.096120</td>
      <td>1.342152</td>
      <td>1.438272</td>
    </tr>
    <tr>
      <th>Liverpool</th>
      <td>19.5</td>
      <td>16.289474</td>
      <td>1.357143</td>
      <td>2.211640</td>
      <td>0.854497</td>
      <td>2.158730</td>
      <td>16.320106</td>
      <td>5.810406</td>
      <td>36.395767</td>
      <td>0.129691</td>
      <td>...</td>
      <td>0.096257</td>
      <td>0.126560</td>
      <td>0.048128</td>
      <td>89.806595</td>
      <td>19.374332</td>
      <td>19.647950</td>
      <td>49.776827</td>
      <td>0.067736</td>
      <td>1.356506</td>
      <td>1.288770</td>
    </tr>
    <tr>
      <th>Manchester City</th>
      <td>19.5</td>
      <td>15.947368</td>
      <td>1.804233</td>
      <td>2.544092</td>
      <td>0.739859</td>
      <td>2.474427</td>
      <td>17.603175</td>
      <td>6.336861</td>
      <td>36.914815</td>
      <td>0.140406</td>
      <td>...</td>
      <td>0.134039</td>
      <td>0.121693</td>
      <td>0.046737</td>
      <td>91.272487</td>
      <td>19.769841</td>
      <td>19.767196</td>
      <td>50.053086</td>
      <td>0.152557</td>
      <td>1.456790</td>
      <td>1.304233</td>
    </tr>
    <tr>
      <th>Manchester United</th>
      <td>19.5</td>
      <td>16.047368</td>
      <td>0.615520</td>
      <td>1.758377</td>
      <td>1.142857</td>
      <td>1.726631</td>
      <td>13.648148</td>
      <td>5.078483</td>
      <td>38.115608</td>
      <td>0.119489</td>
      <td>...</td>
      <td>0.097002</td>
      <td>0.116402</td>
      <td>0.040564</td>
      <td>90.966490</td>
      <td>19.932981</td>
      <td>19.534392</td>
      <td>50.678660</td>
      <td>0.007937</td>
      <td>1.358907</td>
      <td>1.350970</td>
    </tr>
    <tr>
      <th>Newcastle United</th>
      <td>19.5</td>
      <td>16.042105</td>
      <td>-0.373016</td>
      <td>1.088183</td>
      <td>1.461199</td>
      <td>1.054674</td>
      <td>11.138448</td>
      <td>3.601411</td>
      <td>32.866755</td>
      <td>0.095344</td>
      <td>...</td>
      <td>0.119929</td>
      <td>0.125220</td>
      <td>0.047619</td>
      <td>90.180776</td>
      <td>18.980600</td>
      <td>19.029982</td>
      <td>49.676367</td>
      <td>0.069665</td>
      <td>1.417989</td>
      <td>1.348325</td>
    </tr>
    <tr>
      <th>Norwich City</th>
      <td>19.5</td>
      <td>15.973684</td>
      <td>-1.411111</td>
      <td>0.662222</td>
      <td>2.073333</td>
      <td>0.622222</td>
      <td>10.364444</td>
      <td>3.097778</td>
      <td>30.114889</td>
      <td>0.054400</td>
      <td>...</td>
      <td>0.092105</td>
      <td>0.144737</td>
      <td>0.043860</td>
      <td>89.100877</td>
      <td>18.320175</td>
      <td>18.162281</td>
      <td>50.484211</td>
      <td>-0.127193</td>
      <td>1.271930</td>
      <td>1.399123</td>
    </tr>
    <tr>
      <th>Sheffield United</th>
      <td>19.5</td>
      <td>15.657895</td>
      <td>-0.580000</td>
      <td>0.782222</td>
      <td>1.362222</td>
      <td>0.728889</td>
      <td>8.780000</td>
      <td>2.657778</td>
      <td>30.685556</td>
      <td>0.083556</td>
      <td>...</td>
      <td>0.129386</td>
      <td>0.164474</td>
      <td>0.039474</td>
      <td>90.660088</td>
      <td>16.978070</td>
      <td>17.546053</td>
      <td>49.354605</td>
      <td>-0.109649</td>
      <td>1.361842</td>
      <td>1.471491</td>
    </tr>
    <tr>
      <th>Southampton</th>
      <td>19.5</td>
      <td>16.231579</td>
      <td>-0.466490</td>
      <td>1.173721</td>
      <td>1.640212</td>
      <td>1.152557</td>
      <td>12.388007</td>
      <td>4.113757</td>
      <td>34.837654</td>
      <td>0.090088</td>
      <td>...</td>
      <td>0.125220</td>
      <td>0.121693</td>
      <td>0.045855</td>
      <td>89.746914</td>
      <td>19.088183</td>
      <td>18.665785</td>
      <td>50.723016</td>
      <td>0.035273</td>
      <td>1.398589</td>
      <td>1.363316</td>
    </tr>
    <tr>
      <th>Stoke City</th>
      <td>19.5</td>
      <td>16.394737</td>
      <td>-0.918919</td>
      <td>0.878378</td>
      <td>1.797297</td>
      <td>0.851351</td>
      <td>10.432432</td>
      <td>3.184685</td>
      <td>33.167117</td>
      <td>0.087342</td>
      <td>...</td>
      <td>0.081081</td>
      <td>0.072072</td>
      <td>0.009009</td>
      <td>94.153153</td>
      <td>21.887387</td>
      <td>23.333333</td>
      <td>48.231532</td>
      <td>0.450450</td>
      <td>1.522523</td>
      <td>1.072072</td>
    </tr>
    <tr>
      <th>Swansea City</th>
      <td>19.5</td>
      <td>16.868421</td>
      <td>-0.720721</td>
      <td>0.729730</td>
      <td>1.450450</td>
      <td>0.702703</td>
      <td>8.189189</td>
      <td>2.193694</td>
      <td>28.216667</td>
      <td>0.092162</td>
      <td>...</td>
      <td>0.099099</td>
      <td>0.081081</td>
      <td>0.031532</td>
      <td>95.824324</td>
      <td>24.725225</td>
      <td>22.824324</td>
      <td>52.114414</td>
      <td>0.216216</td>
      <td>1.459459</td>
      <td>1.243243</td>
    </tr>
    <tr>
      <th>Tottenham Hotspur</th>
      <td>19.5</td>
      <td>15.394737</td>
      <td>0.676367</td>
      <td>1.771605</td>
      <td>1.095238</td>
      <td>1.675485</td>
      <td>13.314815</td>
      <td>4.734568</td>
      <td>36.830423</td>
      <td>0.129233</td>
      <td>...</td>
      <td>0.093972</td>
      <td>0.125887</td>
      <td>0.035461</td>
      <td>90.899823</td>
      <td>19.563830</td>
      <td>19.655142</td>
      <td>49.633688</td>
      <td>0.017730</td>
      <td>1.366135</td>
      <td>1.348404</td>
    </tr>
    <tr>
      <th>Watford</th>
      <td>19.5</td>
      <td>16.184211</td>
      <td>-0.620309</td>
      <td>1.107064</td>
      <td>1.727373</td>
      <td>1.073951</td>
      <td>11.065121</td>
      <td>3.399558</td>
      <td>31.508940</td>
      <td>0.089536</td>
      <td>...</td>
      <td>0.099338</td>
      <td>0.116998</td>
      <td>0.038631</td>
      <td>90.599338</td>
      <td>19.486755</td>
      <td>19.296909</td>
      <td>50.105740</td>
      <td>-0.099338</td>
      <td>1.304636</td>
      <td>1.403974</td>
    </tr>
    <tr>
      <th>West Bromwich Albion</th>
      <td>19.5</td>
      <td>16.421053</td>
      <td>-0.817778</td>
      <td>0.866667</td>
      <td>1.684444</td>
      <td>0.840000</td>
      <td>9.457778</td>
      <td>2.793333</td>
      <td>31.112000</td>
      <td>0.083800</td>
      <td>...</td>
      <td>0.111111</td>
      <td>0.151111</td>
      <td>0.057778</td>
      <td>89.895556</td>
      <td>20.335556</td>
      <td>20.268889</td>
      <td>50.009333</td>
      <td>0.017778</td>
      <td>1.380000</td>
      <td>1.362222</td>
    </tr>
    <tr>
      <th>West Ham United</th>
      <td>19.5</td>
      <td>16.157895</td>
      <td>-0.078483</td>
      <td>1.416226</td>
      <td>1.494709</td>
      <td>1.389771</td>
      <td>11.238095</td>
      <td>3.870370</td>
      <td>35.340388</td>
      <td>0.120414</td>
      <td>...</td>
      <td>0.125220</td>
      <td>0.114638</td>
      <td>0.047619</td>
      <td>90.360670</td>
      <td>19.217813</td>
      <td>19.444444</td>
      <td>49.579894</td>
      <td>0.006173</td>
      <td>1.402116</td>
      <td>1.395944</td>
    </tr>
    <tr>
      <th>Wolverhampton Wanderers</th>
      <td>19.5</td>
      <td>15.559211</td>
      <td>-0.048565</td>
      <td>1.134658</td>
      <td>1.183223</td>
      <td>1.081678</td>
      <td>11.768212</td>
      <td>3.706402</td>
      <td>31.860706</td>
      <td>0.091347</td>
      <td>...</td>
      <td>0.118421</td>
      <td>0.120614</td>
      <td>0.067982</td>
      <td>89.114035</td>
      <td>17.844298</td>
      <td>17.971491</td>
      <td>49.912939</td>
      <td>-0.085526</td>
      <td>1.357456</td>
      <td>1.442982</td>
    </tr>
  </tbody>
</table>
<p>28 rows × 330 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="320">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="320">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>round</th>
      <th>day</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>shooting_gls_x</th>
      <th>shooting_sh_x</th>
      <th>shooting_sot_x</th>
      <th>shooting_sot%_x</th>
      <th>shooting_g/sh_x</th>
      <th>...</th>
      <th>misc_pkwon_y</th>
      <th>misc_pkcon_y</th>
      <th>misc_og_y</th>
      <th>misc_recov_y</th>
      <th>misc_won_y</th>
      <th>misc_lost_y</th>
      <th>misc_won%_y</th>
      <th>netscore_y</th>
      <th>goalsfor_y</th>
      <th>goalsagainst_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>round</th>
      <td>1.000000</td>
      <td>-0.101106</td>
      <td>-0.000427</td>
      <td>-0.032829</td>
      <td>-0.033619</td>
      <td>-0.031728</td>
      <td>-0.033182</td>
      <td>-0.031253</td>
      <td>-0.012582</td>
      <td>-0.005572</td>
      <td>...</td>
      <td>-0.026473</td>
      <td>-0.039209</td>
      <td>-0.016878</td>
      <td>0.053467</td>
      <td>0.027972</td>
      <td>0.028820</td>
      <td>0.000147</td>
      <td>-0.000427</td>
      <td>-0.032829</td>
      <td>-0.033619</td>
    </tr>
    <tr>
      <th>day</th>
      <td>-0.101106</td>
      <td>1.000000</td>
      <td>0.001526</td>
      <td>0.012942</td>
      <td>0.011046</td>
      <td>0.017277</td>
      <td>0.018508</td>
      <td>0.013796</td>
      <td>0.011117</td>
      <td>0.013813</td>
      <td>...</td>
      <td>0.017057</td>
      <td>-0.014209</td>
      <td>-0.019603</td>
      <td>0.000052</td>
      <td>0.011315</td>
      <td>0.008934</td>
      <td>0.007511</td>
      <td>0.001526</td>
      <td>0.012942</td>
      <td>0.011046</td>
    </tr>
    <tr>
      <th>result_x</th>
      <td>-0.000427</td>
      <td>0.001526</td>
      <td>1.000000</td>
      <td>0.804871</td>
      <td>-0.784386</td>
      <td>0.796159</td>
      <td>0.489624</td>
      <td>0.598669</td>
      <td>0.302810</td>
      <td>0.553999</td>
      <td>...</td>
      <td>-0.008706</td>
      <td>-0.020023</td>
      <td>0.015524</td>
      <td>0.000158</td>
      <td>-0.003279</td>
      <td>-0.004667</td>
      <td>0.006454</td>
      <td>0.020826</td>
      <td>0.017049</td>
      <td>-0.016039</td>
    </tr>
    <tr>
      <th>gf_x</th>
      <td>-0.032829</td>
      <td>0.012942</td>
      <td>0.804871</td>
      <td>1.000000</td>
      <td>-0.263228</td>
      <td>0.988970</td>
      <td>0.489024</td>
      <td>0.682367</td>
      <td>0.418380</td>
      <td>0.724261</td>
      <td>...</td>
      <td>0.010279</td>
      <td>-0.026590</td>
      <td>0.016782</td>
      <td>0.015622</td>
      <td>0.005549</td>
      <td>0.006301</td>
      <td>0.001188</td>
      <td>0.017049</td>
      <td>0.011392</td>
      <td>-0.015809</td>
    </tr>
    <tr>
      <th>ga_x</th>
      <td>-0.033619</td>
      <td>0.011046</td>
      <td>-0.784386</td>
      <td>-0.263228</td>
      <td>1.000000</td>
      <td>-0.260595</td>
      <td>-0.284823</td>
      <td>-0.260010</td>
      <td>-0.054968</td>
      <td>-0.143603</td>
      <td>...</td>
      <td>0.024876</td>
      <td>0.004775</td>
      <td>-0.007703</td>
      <td>0.016053</td>
      <td>0.011122</td>
      <td>0.014161</td>
      <td>-0.009246</td>
      <td>-0.016039</td>
      <td>-0.015809</td>
      <td>0.009557</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>misc_lost_y</th>
      <td>0.028820</td>
      <td>0.008934</td>
      <td>-0.004667</td>
      <td>0.006301</td>
      <td>0.014161</td>
      <td>0.007396</td>
      <td>0.001735</td>
      <td>0.012405</td>
      <td>0.009634</td>
      <td>0.014438</td>
      <td>...</td>
      <td>-0.119425</td>
      <td>-0.028281</td>
      <td>0.011898</td>
      <td>0.373947</td>
      <td>0.694807</td>
      <td>1.000000</td>
      <td>-0.398785</td>
      <td>-0.222763</td>
      <td>-0.280020</td>
      <td>0.069455</td>
    </tr>
    <tr>
      <th>misc_won%_y</th>
      <td>0.000147</td>
      <td>0.007511</td>
      <td>0.006454</td>
      <td>0.001188</td>
      <td>-0.009246</td>
      <td>-0.000937</td>
      <td>-0.002138</td>
      <td>0.005459</td>
      <td>0.010180</td>
      <td>0.009635</td>
      <td>...</td>
      <td>0.058702</td>
      <td>-0.067979</td>
      <td>-0.029776</td>
      <td>0.040269</td>
      <td>0.327227</td>
      <td>-0.398785</td>
      <td>1.000000</td>
      <td>0.202235</td>
      <td>0.155459</td>
      <td>-0.166274</td>
    </tr>
    <tr>
      <th>netscore_y</th>
      <td>-0.000427</td>
      <td>0.001526</td>
      <td>0.020826</td>
      <td>0.017049</td>
      <td>-0.016039</td>
      <td>0.018878</td>
      <td>-0.000026</td>
      <td>0.013563</td>
      <td>0.023359</td>
      <td>0.019314</td>
      <td>...</td>
      <td>0.189385</td>
      <td>-0.197948</td>
      <td>-0.164797</td>
      <td>0.084513</td>
      <td>-0.111881</td>
      <td>-0.222763</td>
      <td>0.202235</td>
      <td>1.000000</td>
      <td>0.804871</td>
      <td>-0.784386</td>
    </tr>
    <tr>
      <th>goalsfor_y</th>
      <td>-0.032829</td>
      <td>0.012942</td>
      <td>0.017049</td>
      <td>0.011392</td>
      <td>-0.015809</td>
      <td>0.012763</td>
      <td>0.007157</td>
      <td>0.006324</td>
      <td>0.017994</td>
      <td>0.014789</td>
      <td>...</td>
      <td>0.253819</td>
      <td>-0.045267</td>
      <td>-0.062638</td>
      <td>0.016541</td>
      <td>-0.197868</td>
      <td>-0.280020</td>
      <td>0.155459</td>
      <td>0.804871</td>
      <td>1.000000</td>
      <td>-0.263228</td>
    </tr>
    <tr>
      <th>goalsagainst_y</th>
      <td>-0.033619</td>
      <td>0.011046</td>
      <td>-0.016039</td>
      <td>-0.015809</td>
      <td>0.009557</td>
      <td>-0.017349</td>
      <td>0.007515</td>
      <td>-0.015435</td>
      <td>-0.019168</td>
      <td>-0.015943</td>
      <td>...</td>
      <td>-0.042581</td>
      <td>0.274478</td>
      <td>0.202431</td>
      <td>-0.120098</td>
      <td>-0.024934</td>
      <td>0.069455</td>
      <td>-0.166274</td>
      <td>-0.784386</td>
      <td>-0.263228</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>330 rows × 330 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="321">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plt.plot(mg.netscore_x,mg.shooting_sh_x,<span class="st">'ok'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(matchesC.gf_x,matchesC.NetScore_x,'ok')</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>matchesC.corr()</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>corrnetscore<span class="op">=</span>X.sort_values(by<span class="op">=</span><span class="st">"netscore_x"</span>).reset_index()</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>corrnetscore<span class="op">=</span>corrnetscore.rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'category'</span>})</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>corrnetscore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="321">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>category</th>
      <th>round</th>
      <th>day</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>shooting_gls_x</th>
      <th>shooting_sh_x</th>
      <th>shooting_sot_x</th>
      <th>shooting_sot%_x</th>
      <th>...</th>
      <th>misc_pkwon_y</th>
      <th>misc_pkcon_y</th>
      <th>misc_og_y</th>
      <th>misc_recov_y</th>
      <th>misc_won_y</th>
      <th>misc_lost_y</th>
      <th>misc_won%_y</th>
      <th>netscore_y</th>
      <th>goalsfor_y</th>
      <th>goalsagainst_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ga_x</td>
      <td>-0.033619</td>
      <td>0.011046</td>
      <td>-0.784386</td>
      <td>-0.263228</td>
      <td>1.000000</td>
      <td>-0.260595</td>
      <td>-0.284823</td>
      <td>-0.260010</td>
      <td>-0.054968</td>
      <td>...</td>
      <td>0.024876</td>
      <td>0.004775</td>
      <td>-0.007703</td>
      <td>0.016053</td>
      <td>0.011122</td>
      <td>0.014161</td>
      <td>-0.009246</td>
      <td>-0.016039</td>
      <td>-0.015809</td>
      <td>0.009557</td>
    </tr>
    <tr>
      <th>1</th>
      <td>goalsagainst_x</td>
      <td>-0.033619</td>
      <td>0.011046</td>
      <td>-0.784386</td>
      <td>-0.263228</td>
      <td>1.000000</td>
      <td>-0.260595</td>
      <td>-0.284823</td>
      <td>-0.260010</td>
      <td>-0.054968</td>
      <td>...</td>
      <td>0.024876</td>
      <td>0.004775</td>
      <td>-0.007703</td>
      <td>0.016053</td>
      <td>0.011122</td>
      <td>0.014161</td>
      <td>-0.009246</td>
      <td>-0.016039</td>
      <td>-0.015809</td>
      <td>0.009557</td>
    </tr>
    <tr>
      <th>2</th>
      <td>keeper_psxg_x</td>
      <td>-0.020151</td>
      <td>0.004270</td>
      <td>-0.689039</td>
      <td>-0.288664</td>
      <td>0.818415</td>
      <td>-0.285579</td>
      <td>-0.342578</td>
      <td>-0.292562</td>
      <td>-0.040214</td>
      <td>...</td>
      <td>0.016138</td>
      <td>0.005909</td>
      <td>0.004696</td>
      <td>0.022612</td>
      <td>0.008525</td>
      <td>0.021666</td>
      <td>-0.019468</td>
      <td>-0.026014</td>
      <td>-0.025878</td>
      <td>0.015252</td>
    </tr>
    <tr>
      <th>3</th>
      <td>keeper_sota_x</td>
      <td>-0.027422</td>
      <td>0.009134</td>
      <td>-0.585212</td>
      <td>-0.306845</td>
      <td>0.630628</td>
      <td>-0.303735</td>
      <td>-0.390630</td>
      <td>-0.326298</td>
      <td>-0.029044</td>
      <td>...</td>
      <td>-0.003544</td>
      <td>0.019901</td>
      <td>-0.012280</td>
      <td>0.008879</td>
      <td>0.015911</td>
      <td>0.029753</td>
      <td>-0.018988</td>
      <td>-0.016977</td>
      <td>-0.017976</td>
      <td>0.008819</td>
    </tr>
    <tr>
      <th>4</th>
      <td>passingtypes_PC_dead_x</td>
      <td>-0.020593</td>
      <td>0.025862</td>
      <td>-0.428442</td>
      <td>-0.400000</td>
      <td>0.278412</td>
      <td>-0.400698</td>
      <td>-0.520973</td>
      <td>-0.469203</td>
      <td>-0.092371</td>
      <td>...</td>
      <td>-0.022421</td>
      <td>0.000464</td>
      <td>-0.011870</td>
      <td>-0.003227</td>
      <td>0.015526</td>
      <td>0.010683</td>
      <td>0.004033</td>
      <td>-0.001923</td>
      <td>-0.001384</td>
      <td>0.001681</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>325</th>
      <td>shooting_gls_x</td>
      <td>-0.031728</td>
      <td>0.017277</td>
      <td>0.796159</td>
      <td>0.988970</td>
      <td>-0.260595</td>
      <td>1.000000</td>
      <td>0.489307</td>
      <td>0.687750</td>
      <td>0.424698</td>
      <td>...</td>
      <td>0.008137</td>
      <td>-0.028288</td>
      <td>0.015246</td>
      <td>0.016248</td>
      <td>0.005333</td>
      <td>0.007396</td>
      <td>-0.000937</td>
      <td>0.018878</td>
      <td>0.012763</td>
      <td>-0.017349</td>
    </tr>
    <tr>
      <th>326</th>
      <td>gf_x</td>
      <td>-0.032829</td>
      <td>0.012942</td>
      <td>0.804871</td>
      <td>1.000000</td>
      <td>-0.263228</td>
      <td>0.988970</td>
      <td>0.489024</td>
      <td>0.682367</td>
      <td>0.418380</td>
      <td>...</td>
      <td>0.010279</td>
      <td>-0.026590</td>
      <td>0.016782</td>
      <td>0.015622</td>
      <td>0.005549</td>
      <td>0.006301</td>
      <td>0.001188</td>
      <td>0.017049</td>
      <td>0.011392</td>
      <td>-0.015809</td>
    </tr>
    <tr>
      <th>327</th>
      <td>goalsfor_x</td>
      <td>-0.032829</td>
      <td>0.012942</td>
      <td>0.804871</td>
      <td>1.000000</td>
      <td>-0.263228</td>
      <td>0.988970</td>
      <td>0.489024</td>
      <td>0.682367</td>
      <td>0.418380</td>
      <td>...</td>
      <td>0.010279</td>
      <td>-0.026590</td>
      <td>0.016782</td>
      <td>0.015622</td>
      <td>0.005549</td>
      <td>0.006301</td>
      <td>0.001188</td>
      <td>0.017049</td>
      <td>0.011392</td>
      <td>-0.015809</td>
    </tr>
    <tr>
      <th>328</th>
      <td>result_x</td>
      <td>-0.000427</td>
      <td>0.001526</td>
      <td>1.000000</td>
      <td>0.804871</td>
      <td>-0.784386</td>
      <td>0.796159</td>
      <td>0.489624</td>
      <td>0.598669</td>
      <td>0.302810</td>
      <td>...</td>
      <td>-0.008706</td>
      <td>-0.020023</td>
      <td>0.015524</td>
      <td>0.000158</td>
      <td>-0.003279</td>
      <td>-0.004667</td>
      <td>0.006454</td>
      <td>0.020826</td>
      <td>0.017049</td>
      <td>-0.016039</td>
    </tr>
    <tr>
      <th>329</th>
      <td>netscore_x</td>
      <td>-0.000427</td>
      <td>0.001526</td>
      <td>1.000000</td>
      <td>0.804871</td>
      <td>-0.784386</td>
      <td>0.796159</td>
      <td>0.489624</td>
      <td>0.598669</td>
      <td>0.302810</td>
      <td>...</td>
      <td>-0.008706</td>
      <td>-0.020023</td>
      <td>0.015524</td>
      <td>0.000158</td>
      <td>-0.003279</td>
      <td>-0.004667</td>
      <td>0.006454</td>
      <td>0.020826</td>
      <td>0.017049</td>
      <td>-0.016039</td>
    </tr>
  </tbody>
</table>
<p>330 rows × 331 columns</p>
</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-PrepareTheData_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>