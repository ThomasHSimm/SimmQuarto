<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ThomasHSimm – predictingpremierleaguematches-copy2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//posts/Picture3.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ThomasHSimm</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ThomasHSimm"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ThomasHSimm"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><p><img src="../posts/header2.png" height="200"></p>



<section id="predicting-premier-league-matches" class="level1">
<h1>Predicting Premier League Matches</h1>
<blockquote class="blockquote">
<p>Using Python and Random Forests to predict football matches</p>
</blockquote>
<ul>
<li>toc: true</li>
<li>badges: true</li>
<li>comments: true</li>
<li>categories: [Random Forests, Football, Premier League,Python]</li>
</ul>
<p><img src="ghtop_images/header2.png" class="img-fluid"></p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Predicting results of <a href="https://en.wikipedia.org/wiki/Premier_League">English Premier League</a> using random forests for the 2022 and 2021 seasons. I will predict whether a result is a win, loss or draw.</p>
<p>From an article about pundit versus gambling company <a href="https://www.pinnacle.com/en/betting-articles/Soccer/Mark-Lawrenson-vs-Pinnacle-Sports/VGJ296E4BSYNURUB">Pinnacle vs.&nbsp;Mark Lawrenson</a> we have a benchmark to aim for from the 2012 season: - Mark Lawrenson = 52.6% accuracy - Pinnacle traders = 55.3% accuracy - Random guess = 33.3% accuracy</p>
</section>
<section id="method" class="level3">
<h3 class="anchored" data-anchor-id="method">Method</h3>
<p>In this data there are various parameters that can be used. The most important step is to not to use data about a current match as a predictor, but for a prediction to be based on stats from previous matches. (A couple of slight exceptions to this are below.)</p>
<p>The predictors used here include: - date of match - home or away - stats from previous matches - results - goals scored/conceded - possession/expected goals etc - who is playing who - details of match, limited to those that could be predicted beforehand - referee - captain - formation - attendance</p>
<p>Some details on the machine learning:</p>
<ul>
<li>A Random Forest <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">Classifier</a> was used for analysis.</li>
<li>Data is trained on the first 28 game weeks- the other 10 are used for validation
<ul>
<li>23% validation / 77% training</li>
</ul></li>
<li>Some data cleaning methods were performed and shown in the code</li>
</ul>
</section>
<section id="results" class="level3">
<h3 class="anchored" data-anchor-id="results">Results</h3>
<ul>
<li>Model accuracy = 51.5% (+-1%)
<ul>
<li>So the model is comparable with the results of Mark Lawrenson</li>
</ul></li>
<li>Draws are under-represented by the model
<ul>
<li>draws predicted was increased by adjusting the input parameter <code>class_weight</code> but the issue was only reduced</li>
</ul></li>
<li>Changing input parameters was done in a semi-manual manner, obtaining the best input parameters was not easy</li>
<li>The stats from the last 5 games are the best parameters in predicting results</li>
</ul>
<p>The model is okay as it matches the accuracy from an expert pundit. But it does underperform gambing predictions.</p>
<p>I would say the model probably needs more data to compete and outperform both of the controls consistently.</p>
</section>
<section id="code--prepare-the-data" class="level3">
<h3 class="anchored" data-anchor-id="code--prepare-the-data">Code- Prepare the data</h3>
<p>Data is prepared in a separate page- <a href="https://thomashsimm.com/pandas/football/premier%20league/python/2022/08/11/PredictingPremierLeagueMatches-PrepareTheData.html#Save-the-data">Predicting Premier League Matches- Prepare the data</a></p>
</section>
</section>
<section id="load-data-and-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-data-and-libraries">Load data and libraries</h2>
<div class="cell" data-execution_count="448">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>cwd<span class="op">=</span>os.getcwd()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="449">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cwd<span class="op">=</span>os.getcwd()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>folda<span class="op">=</span>cwd<span class="op">+</span><span class="st">"/data/epl/"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dira <span class="op">=</span> os.listdir(folda)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>dira</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="449">
<pre><code>['dfEPL_2017.csv',
 'dfEPL_2018.csv',
 'dfEPL_2019.csv',
 'dfEPL_2020.csv',
 'dfEPL_2021.csv',
 'epl2017-2021.csv',
 'epl2017-2021_wivnetscore.csv']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="450">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>dfAll<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021.csv'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>dfAll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="450">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>round</th>
      <th>day</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>opponent_x</th>
      <th>gls_x</th>
      <th>sh_shooting_x</th>
      <th>sot_x</th>
      <th>...</th>
      <th>int_misc_y</th>
      <th>tklw_misc_y</th>
      <th>pkwon_y</th>
      <th>pkcon_y</th>
      <th>og_y</th>
      <th>recov_y</th>
      <th>won_y</th>
      <th>lost_y</th>
      <th>won%_y</th>
      <th>team_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>West Ham United</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>West Ham United</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>1</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Burnley</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Burnley</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>1</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Leicester City</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Leicester City</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>1</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Stoke City</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Stoke City</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>1</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Tottenham Hotspur</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Tottenham Hotspur</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1895</th>
      <td>3788</td>
      <td>38</td>
      <td>22</td>
      <td>1.666667</td>
      <td>2.666667</td>
      <td>0.333333</td>
      <td>West Ham United</td>
      <td>2.666667</td>
      <td>15.666667</td>
      <td>6.333333</td>
      <td>...</td>
      <td>12.666667</td>
      <td>6.666667</td>
      <td>0.000000</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>62.333333</td>
      <td>14.333333</td>
      <td>15.000000</td>
      <td>49.066667</td>
      <td>West Ham United</td>
    </tr>
    <tr>
      <th>1896</th>
      <td>3791</td>
      <td>38</td>
      <td>22</td>
      <td>1.666667</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>Manchester United</td>
      <td>1.333333</td>
      <td>14.666667</td>
      <td>5.000000</td>
      <td>...</td>
      <td>19.333333</td>
      <td>11.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>68.000000</td>
      <td>17.000000</td>
      <td>13.333333</td>
      <td>56.733333</td>
      <td>Manchester United</td>
    </tr>
    <tr>
      <th>1897</th>
      <td>3792</td>
      <td>38</td>
      <td>22</td>
      <td>1.333333</td>
      <td>2.000000</td>
      <td>1.666667</td>
      <td>Leeds United</td>
      <td>1.666667</td>
      <td>16.000000</td>
      <td>5.000000</td>
      <td>...</td>
      <td>12.000000</td>
      <td>11.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>80.000000</td>
      <td>12.000000</td>
      <td>16.333333</td>
      <td>42.933333</td>
      <td>Leeds United</td>
    </tr>
    <tr>
      <th>1898</th>
      <td>3797</td>
      <td>38</td>
      <td>22</td>
      <td>0.666667</td>
      <td>1.000000</td>
      <td>1.666667</td>
      <td>Newcastle United</td>
      <td>1.000000</td>
      <td>13.000000</td>
      <td>4.333333</td>
      <td>...</td>
      <td>14.666667</td>
      <td>13.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>64.333333</td>
      <td>20.000000</td>
      <td>19.000000</td>
      <td>48.766667</td>
      <td>Newcastle United</td>
    </tr>
    <tr>
      <th>1899</th>
      <td>3799</td>
      <td>38</td>
      <td>22</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>2.333333</td>
      <td>Tottenham Hotspur</td>
      <td>0.333333</td>
      <td>9.666667</td>
      <td>2.333333</td>
      <td>...</td>
      <td>12.000000</td>
      <td>9.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>81.666667</td>
      <td>23.666667</td>
      <td>17.000000</td>
      <td>57.633333</td>
      <td>Tottenham Hotspur</td>
    </tr>
  </tbody>
</table>
<p>1900 rows × 344 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="451">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_columns"</span>, <span class="va">None</span>):</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    display(dfAll.describe(include<span class="op">=</span><span class="st">'all'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>round</th>
      <th>day</th>
      <th>result_x</th>
      <th>gf_x</th>
      <th>ga_x</th>
      <th>opponent_x</th>
      <th>gls_x</th>
      <th>sh_shooting_x</th>
      <th>sot_x</th>
      <th>sot%_x</th>
      <th>g/sh_x</th>
      <th>g/sot_x</th>
      <th>dist_x</th>
      <th>fk_shooting_x</th>
      <th>pk_x</th>
      <th>pkatt_shooting_x</th>
      <th>xg_x</th>
      <th>npxg_x</th>
      <th>npxg/sh_x</th>
      <th>g-xg_x</th>
      <th>np:g-xg_x</th>
      <th>sota_x</th>
      <th>saves_x</th>
      <th>save%_x</th>
      <th>cs_x</th>
      <th>psxg_x</th>
      <th>psxg+/-_x</th>
      <th>pkatt_keeper_x</th>
      <th>pka_x</th>
      <th>pksv_x</th>
      <th>pkm_x</th>
      <th>cmp_keeper_x</th>
      <th>att_keeper_x</th>
      <th>cmp%_keeper_x</th>
      <th>att_keeper.1_x</th>
      <th>thr_x</th>
      <th>launch%_x</th>
      <th>avglen_x</th>
      <th>att_keeper.2_x</th>
      <th>launch%.1_x</th>
      <th>avglen.1_x</th>
      <th>opp_x</th>
      <th>stp_x</th>
      <th>stp%_x</th>
      <th>#opa_x</th>
      <th>avgdist_x</th>
      <th>cmp_passing_x</th>
      <th>att_passing_x</th>
      <th>cmp%_passing_x</th>
      <th>totdist_passing_x</th>
      <th>prgdist_passing_x</th>
      <th>cmp_passing.1_x</th>
      <th>att_passing.1_x</th>
      <th>cmp%_passing.1_x</th>
      <th>cmp_passing.2_x</th>
      <th>att_passing.2_x</th>
      <th>cmp%_passing.2_x</th>
      <th>cmp_passing.3_x</th>
      <th>att_passing.3_x</th>
      <th>cmp%_passing.3_x</th>
      <th>ast_x</th>
      <th>xa_x</th>
      <th>kp_x</th>
      <th>1/3_passing_x</th>
      <th>ppa_x</th>
      <th>crspa_x</th>
      <th>prog_passing_x</th>
      <th>att_passing_types_x</th>
      <th>live_passing_types_x</th>
      <th>dead_x</th>
      <th>fk_passing_types_x</th>
      <th>tb_x</th>
      <th>press_passing_types_x</th>
      <th>sw_x</th>
      <th>crs_passing_types_x</th>
      <th>ck_x</th>
      <th>in_x</th>
      <th>out_x</th>
      <th>str_x</th>
      <th>ground_x</th>
      <th>low_x</th>
      <th>high_x</th>
      <th>left_x</th>
      <th>right_x</th>
      <th>head_x</th>
      <th>ti_x</th>
      <th>other_x</th>
      <th>cmp_passing_types_x</th>
      <th>off_passing_types_x</th>
      <th>out.1_x</th>
      <th>int_passing_types_x</th>
      <th>blocks_passing_types_x</th>
      <th>sca_x</th>
      <th>passlive_x</th>
      <th>passdead_x</th>
      <th>drib_x</th>
      <th>sh_gca_x</th>
      <th>fld_gca_x</th>
      <th>def_x</th>
      <th>gca_x</th>
      <th>passlive.1_x</th>
      <th>passdead.1_x</th>
      <th>drib.1_x</th>
      <th>sh_gca.1_x</th>
      <th>fld_gca.1_x</th>
      <th>def.1_x</th>
      <th>tkl_x</th>
      <th>tklw_defense_x</th>
      <th>def 3rd_defense_x</th>
      <th>mid 3rd_defense_x</th>
      <th>att 3rd_defense_x</th>
      <th>tkl.1_x</th>
      <th>att_defense_x</th>
      <th>tkl%_x</th>
      <th>past_x</th>
      <th>press_defense_x</th>
      <th>succ_defense_x</th>
      <th>%_x</th>
      <th>def 3rd_defense.1_x</th>
      <th>mid 3rd_defense.1_x</th>
      <th>att 3rd_defense.1_x</th>
      <th>blocks_defense_x</th>
      <th>sh_defense_x</th>
      <th>shsv_x</th>
      <th>pass_x</th>
      <th>int_defense_x</th>
      <th>clr_x</th>
      <th>err_x</th>
      <th>poss_x</th>
      <th>touches_x</th>
      <th>def pen_x</th>
      <th>def 3rd_possession_x</th>
      <th>mid 3rd_possession_x</th>
      <th>att 3rd_possession_x</th>
      <th>att pen_x</th>
      <th>live_possession_x</th>
      <th>succ_possession_x</th>
      <th>att_possession_x</th>
      <th>succ%_x</th>
      <th>#pl_x</th>
      <th>megs_x</th>
      <th>carries_x</th>
      <th>totdist_possession_x</th>
      <th>prgdist_possession_x</th>
      <th>prog_possession_x</th>
      <th>1/3_possession_x</th>
      <th>cpa_x</th>
      <th>mis_x</th>
      <th>dis_x</th>
      <th>targ_x</th>
      <th>rec_x</th>
      <th>rec%_x</th>
      <th>prog_possession.1_x</th>
      <th>crdy_x</th>
      <th>crdr_x</th>
      <th>2crdy_x</th>
      <th>fls_x</th>
      <th>fld_misc_x</th>
      <th>off_misc_x</th>
      <th>crs_misc_x</th>
      <th>int_misc_x</th>
      <th>tklw_misc_x</th>
      <th>pkwon_x</th>
      <th>pkcon_x</th>
      <th>og_x</th>
      <th>recov_x</th>
      <th>won_x</th>
      <th>lost_x</th>
      <th>won%_x</th>
      <th>team_x</th>
      <th>season</th>
      <th>month</th>
      <th>year</th>
      <th>weekday</th>
      <th>Win_x</th>
      <th>result_y</th>
      <th>gf_y</th>
      <th>ga_y</th>
      <th>opponent_y</th>
      <th>gls_y</th>
      <th>sh_shooting_y</th>
      <th>sot_y</th>
      <th>sot%_y</th>
      <th>g/sh_y</th>
      <th>g/sot_y</th>
      <th>dist_y</th>
      <th>fk_shooting_y</th>
      <th>pk_y</th>
      <th>pkatt_shooting_y</th>
      <th>xg_y</th>
      <th>npxg_y</th>
      <th>npxg/sh_y</th>
      <th>g-xg_y</th>
      <th>np:g-xg_y</th>
      <th>sota_y</th>
      <th>saves_y</th>
      <th>save%_y</th>
      <th>cs_y</th>
      <th>psxg_y</th>
      <th>psxg+/-_y</th>
      <th>pkatt_keeper_y</th>
      <th>pka_y</th>
      <th>pksv_y</th>
      <th>pkm_y</th>
      <th>cmp_keeper_y</th>
      <th>att_keeper_y</th>
      <th>cmp%_keeper_y</th>
      <th>att_keeper.1_y</th>
      <th>thr_y</th>
      <th>launch%_y</th>
      <th>avglen_y</th>
      <th>att_keeper.2_y</th>
      <th>launch%.1_y</th>
      <th>avglen.1_y</th>
      <th>opp_y</th>
      <th>stp_y</th>
      <th>stp%_y</th>
      <th>#opa_y</th>
      <th>avgdist_y</th>
      <th>cmp_passing_y</th>
      <th>att_passing_y</th>
      <th>cmp%_passing_y</th>
      <th>totdist_passing_y</th>
      <th>prgdist_passing_y</th>
      <th>cmp_passing.1_y</th>
      <th>att_passing.1_y</th>
      <th>cmp%_passing.1_y</th>
      <th>cmp_passing.2_y</th>
      <th>att_passing.2_y</th>
      <th>cmp%_passing.2_y</th>
      <th>cmp_passing.3_y</th>
      <th>att_passing.3_y</th>
      <th>cmp%_passing.3_y</th>
      <th>ast_y</th>
      <th>xa_y</th>
      <th>kp_y</th>
      <th>1/3_passing_y</th>
      <th>ppa_y</th>
      <th>crspa_y</th>
      <th>prog_passing_y</th>
      <th>att_passing_types_y</th>
      <th>live_passing_types_y</th>
      <th>dead_y</th>
      <th>fk_passing_types_y</th>
      <th>tb_y</th>
      <th>press_passing_types_y</th>
      <th>sw_y</th>
      <th>crs_passing_types_y</th>
      <th>ck_y</th>
      <th>in_y</th>
      <th>out_y</th>
      <th>str_y</th>
      <th>ground_y</th>
      <th>low_y</th>
      <th>high_y</th>
      <th>left_y</th>
      <th>right_y</th>
      <th>head_y</th>
      <th>ti_y</th>
      <th>other_y</th>
      <th>cmp_passing_types_y</th>
      <th>off_passing_types_y</th>
      <th>out.1_y</th>
      <th>int_passing_types_y</th>
      <th>blocks_passing_types_y</th>
      <th>sca_y</th>
      <th>passlive_y</th>
      <th>passdead_y</th>
      <th>drib_y</th>
      <th>sh_gca_y</th>
      <th>fld_gca_y</th>
      <th>def_y</th>
      <th>gca_y</th>
      <th>passlive.1_y</th>
      <th>passdead.1_y</th>
      <th>drib.1_y</th>
      <th>sh_gca.1_y</th>
      <th>fld_gca.1_y</th>
      <th>def.1_y</th>
      <th>tkl_y</th>
      <th>tklw_defense_y</th>
      <th>def 3rd_defense_y</th>
      <th>mid 3rd_defense_y</th>
      <th>att 3rd_defense_y</th>
      <th>tkl.1_y</th>
      <th>att_defense_y</th>
      <th>tkl%_y</th>
      <th>past_y</th>
      <th>press_defense_y</th>
      <th>succ_defense_y</th>
      <th>%_y</th>
      <th>def 3rd_defense.1_y</th>
      <th>mid 3rd_defense.1_y</th>
      <th>att 3rd_defense.1_y</th>
      <th>blocks_defense_y</th>
      <th>sh_defense_y</th>
      <th>shsv_y</th>
      <th>pass_y</th>
      <th>int_defense_y</th>
      <th>clr_y</th>
      <th>err_y</th>
      <th>poss_y</th>
      <th>touches_y</th>
      <th>def pen_y</th>
      <th>def 3rd_possession_y</th>
      <th>mid 3rd_possession_y</th>
      <th>att 3rd_possession_y</th>
      <th>att pen_y</th>
      <th>live_possession_y</th>
      <th>succ_possession_y</th>
      <th>att_possession_y</th>
      <th>succ%_y</th>
      <th>#pl_y</th>
      <th>megs_y</th>
      <th>carries_y</th>
      <th>totdist_possession_y</th>
      <th>prgdist_possession_y</th>
      <th>prog_possession_y</th>
      <th>1/3_possession_y</th>
      <th>cpa_y</th>
      <th>mis_y</th>
      <th>dis_y</th>
      <th>targ_y</th>
      <th>rec_y</th>
      <th>rec%_y</th>
      <th>prog_possession.1_y</th>
      <th>crdy_y</th>
      <th>crdr_y</th>
      <th>2crdy_y</th>
      <th>fls_y</th>
      <th>fld_misc_y</th>
      <th>off_misc_y</th>
      <th>crs_misc_y</th>
      <th>int_misc_y</th>
      <th>tklw_misc_y</th>
      <th>pkwon_y</th>
      <th>pkcon_y</th>
      <th>og_y</th>
      <th>recov_y</th>
      <th>won_y</th>
      <th>lost_y</th>
      <th>won%_y</th>
      <th>team_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1900.000000</td>
      <td>1900.000000</td>
      <td>1900.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1900</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1886.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1886.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1887.000000</td>
      <td>1900</td>
      <td>1900.000000</td>
      <td>1900.000000</td>
      <td>1900.000000</td>
      <td>1900.000000</td>
      <td>1900</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1900</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1885.000000</td>
      <td>1900</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>28</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Everton</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Everton</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>W</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Everton</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Everton</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>833</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1899.500000</td>
      <td>19.500000</td>
      <td>15.898421</td>
      <td>0.981275</td>
      <td>1.348613</td>
      <td>1.384384</td>
      <td>NaN</td>
      <td>1.303745</td>
      <td>12.114821</td>
      <td>4.026409</td>
      <td>33.733678</td>
      <td>0.103473</td>
      <td>0.295749</td>
      <td>17.072311</td>
      <td>0.449391</td>
      <td>0.100601</td>
      <td>0.127628</td>
      <td>1.298472</td>
      <td>1.201890</td>
      <td>0.100960</td>
      <td>0.005273</td>
      <td>0.001254</td>
      <td>4.135223</td>
      <td>2.855856</td>
      <td>68.903853</td>
      <td>0.279456</td>
      <td>1.345345</td>
      <td>0.006006</td>
      <td>0.133899</td>
      <td>0.104575</td>
      <td>0.022081</td>
      <td>0.007243</td>
      <td>6.758612</td>
      <td>17.588059</td>
      <td>41.225057</td>
      <td>24.244568</td>
      <td>4.087970</td>
      <td>51.351016</td>
      <td>42.636584</td>
      <td>7.580198</td>
      <td>67.203542</td>
      <td>52.586654</td>
      <td>8.913355</td>
      <td>0.671524</td>
      <td>7.550442</td>
      <td>0.644409</td>
      <td>14.386937</td>
      <td>388.891274</td>
      <td>492.537361</td>
      <td>77.164414</td>
      <td>7641.028352</td>
      <td>2558.818053</td>
      <td>158.735206</td>
      <td>180.984897</td>
      <td>86.644515</td>
      <td>164.931461</td>
      <td>192.286169</td>
      <td>83.897553</td>
      <td>58.174527</td>
      <td>100.678237</td>
      <td>56.828052</td>
      <td>0.935082</td>
      <td>0.884941</td>
      <td>8.780427</td>
      <td>29.078520</td>
      <td>8.121092</td>
      <td>1.944709</td>
      <td>32.064211</td>
      <td>492.537361</td>
      <td>444.751899</td>
      <td>47.785462</td>
      <td>11.694135</td>
      <td>0.920774</td>
      <td>74.121003</td>
      <td>14.462197</td>
      <td>11.809751</td>
      <td>5.095478</td>
      <td>2.139286</td>
      <td>1.731143</td>
      <td>0.399753</td>
      <td>321.328211</td>
      <td>67.803303</td>
      <td>103.405847</td>
      <td>135.954425</td>
      <td>294.845345</td>
      <td>20.424925</td>
      <td>21.012365</td>
      <td>6.499205</td>
      <td>388.891274</td>
      <td>1.642731</td>
      <td>8.930136</td>
      <td>11.704469</td>
      <td>12.023582</td>
      <td>18.906289</td>
      <td>13.642908</td>
      <td>1.663929</td>
      <td>1.160661</td>
      <td>0.968998</td>
      <td>1.045487</td>
      <td>0.424307</td>
      <td>2.121798</td>
      <td>1.457781</td>
      <td>0.142024</td>
      <td>0.143879</td>
      <td>0.175146</td>
      <td>0.154213</td>
      <td>0.048755</td>
      <td>17.752694</td>
      <td>10.716570</td>
      <td>8.989313</td>
      <td>6.634164</td>
      <td>2.129217</td>
      <td>6.005211</td>
      <td>16.475534</td>
      <td>36.579765</td>
      <td>10.470323</td>
      <td>150.920155</td>
      <td>43.718248</td>
      <td>29.466393</td>
      <td>53.042219</td>
      <td>65.075075</td>
      <td>32.802862</td>
      <td>15.953100</td>
      <td>3.864335</td>
      <td>0.080639</td>
      <td>12.088765</td>
      <td>12.303568</td>
      <td>25.391715</td>
      <td>0.277778</td>
      <td>49.794471</td>
      <td>613.384473</td>
      <td>66.492316</td>
      <td>200.964671</td>
      <td>289.074545</td>
      <td>160.185921</td>
      <td>23.606077</td>
      <td>566.688571</td>
      <td>9.590178</td>
      <td>16.423688</td>
      <td>58.240761</td>
      <td>10.422893</td>
      <td>0.710564</td>
      <td>381.649620</td>
      <td>1946.036213</td>
      <td>1046.398075</td>
      <td>42.419007</td>
      <td>12.752164</td>
      <td>4.159424</td>
      <td>12.226020</td>
      <td>11.763911</td>
      <td>463.668610</td>
      <td>388.891274</td>
      <td>82.442943</td>
      <td>34.198816</td>
      <td>1.649709</td>
      <td>0.059883</td>
      <td>0.025349</td>
      <td>12.391892</td>
      <td>11.972178</td>
      <td>1.849585</td>
      <td>11.809751</td>
      <td>12.303568</td>
      <td>10.716570</td>
      <td>0.106783</td>
      <td>0.127363</td>
      <td>0.045398</td>
      <td>89.831832</td>
      <td>19.251016</td>
      <td>19.192457</td>
      <td>50.053021</td>
      <td>NaN</td>
      <td>2019.000000</td>
      <td>6.783684</td>
      <td>2019.502105</td>
      <td>4.369474</td>
      <td>NaN</td>
      <td>1.019452</td>
      <td>1.394164</td>
      <td>1.357913</td>
      <td>NaN</td>
      <td>1.350928</td>
      <td>12.542794</td>
      <td>4.147126</td>
      <td>33.628974</td>
      <td>0.103412</td>
      <td>0.296049</td>
      <td>17.005402</td>
      <td>0.465252</td>
      <td>0.106720</td>
      <td>0.134483</td>
      <td>1.343775</td>
      <td>1.241813</td>
      <td>0.101071</td>
      <td>0.007153</td>
      <td>0.002396</td>
      <td>4.028559</td>
      <td>2.772679</td>
      <td>68.942476</td>
      <td>0.294518</td>
      <td>1.318400</td>
      <td>0.003899</td>
      <td>0.133245</td>
      <td>0.103714</td>
      <td>0.021751</td>
      <td>0.007781</td>
      <td>6.664633</td>
      <td>17.180460</td>
      <td>41.582263</td>
      <td>24.047303</td>
      <td>4.079222</td>
      <td>50.730752</td>
      <td>42.360955</td>
      <td>7.347834</td>
      <td>66.706225</td>
      <td>52.362776</td>
      <td>8.600973</td>
      <td>0.653935</td>
      <td>7.557745</td>
      <td>0.655615</td>
      <td>14.457374</td>
      <td>393.315915</td>
      <td>497.116092</td>
      <td>77.334757</td>
      <td>7716.688859</td>
      <td>2578.746154</td>
      <td>160.743148</td>
      <td>183.147303</td>
      <td>86.690531</td>
      <td>166.674713</td>
      <td>194.160389</td>
      <td>83.990256</td>
      <td>58.696375</td>
      <td>100.996286</td>
      <td>57.213572</td>
      <td>0.958886</td>
      <td>0.912387</td>
      <td>9.089567</td>
      <td>29.760743</td>
      <td>8.403890</td>
      <td>2.037577</td>
      <td>32.761362</td>
      <td>497.116092</td>
      <td>449.316888</td>
      <td>47.799204</td>
      <td>11.632361</td>
      <td>0.939346</td>
      <td>74.330416</td>
      <td>14.539257</td>
      <td>12.193280</td>
      <td>5.269231</td>
      <td>2.218744</td>
      <td>1.782405</td>
      <td>0.397436</td>
      <td>325.532007</td>
      <td>67.987710</td>
      <td>103.596375</td>
      <td>137.411229</td>
      <td>297.718479</td>
      <td>20.550663</td>
      <td>21.171530</td>
      <td>6.524138</td>
      <td>393.315915</td>
      <td>1.669938</td>
      <td>8.890097</td>
      <td>11.775950</td>
      <td>12.071176</td>
      <td>19.572944</td>
      <td>14.123784</td>
      <td>1.717241</td>
      <td>1.208488</td>
      <td>1.018214</td>
      <td>1.069850</td>
      <td>0.435367</td>
      <td>2.188329</td>
      <td>1.490363</td>
      <td>0.143767</td>
      <td>0.150663</td>
      <td>0.187798</td>
      <td>0.165429</td>
      <td>0.050309</td>
      <td>17.783466</td>
      <td>10.777542</td>
      <td>8.864633</td>
      <td>6.707339</td>
      <td>2.211494</td>
      <td>5.972944</td>
      <td>16.418568</td>
      <td>36.510177</td>
      <td>10.445623</td>
      <td>150.598320</td>
      <td>43.888240</td>
      <td>29.662538</td>
      <td>51.744209</td>
      <td>65.314943</td>
      <td>33.539169</td>
      <td>15.756322</td>
      <td>3.754907</td>
      <td>0.081698</td>
      <td>12.001415</td>
      <td>12.301503</td>
      <td>24.903271</td>
      <td>0.268789</td>
      <td>50.256852</td>
      <td>617.632449</td>
      <td>64.989744</td>
      <td>198.262511</td>
      <td>292.036251</td>
      <td>164.680195</td>
      <td>24.284085</td>
      <td>570.912290</td>
      <td>9.664898</td>
      <td>16.536693</td>
      <td>58.282299</td>
      <td>10.489567</td>
      <td>0.719629</td>
      <td>385.818391</td>
      <td>1975.821751</td>
      <td>1064.124050</td>
      <td>43.414147</td>
      <td>13.084085</td>
      <td>4.244828</td>
      <td>12.209372</td>
      <td>11.802122</td>
      <td>468.212025</td>
      <td>393.315915</td>
      <td>82.592440</td>
      <td>34.972679</td>
      <td>1.617860</td>
      <td>0.057913</td>
      <td>0.022812</td>
      <td>12.375066</td>
      <td>11.976835</td>
      <td>1.889390</td>
      <td>12.193280</td>
      <td>12.301503</td>
      <td>10.777542</td>
      <td>0.112555</td>
      <td>0.128647</td>
      <td>0.043590</td>
      <td>90.371618</td>
      <td>19.201503</td>
      <td>19.248806</td>
      <td>49.947038</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1097.253898</td>
      <td>10.968743</td>
      <td>9.032951</td>
      <td>0.562990</td>
      <td>0.821883</td>
      <td>0.785860</td>
      <td>NaN</td>
      <td>0.804609</td>
      <td>3.604429</td>
      <td>1.602244</td>
      <td>9.903141</td>
      <td>0.065570</td>
      <td>0.165471</td>
      <td>1.924068</td>
      <td>0.400656</td>
      <td>0.186497</td>
      <td>0.210009</td>
      <td>0.539552</td>
      <td>0.501255</td>
      <td>0.028464</td>
      <td>0.559989</td>
      <td>0.556278</td>
      <td>1.552937</td>
      <td>1.210365</td>
      <td>17.491508</td>
      <td>0.271230</td>
      <td>0.629407</td>
      <td>0.438295</td>
      <td>0.217505</td>
      <td>0.189225</td>
      <td>0.088425</td>
      <td>0.052120</td>
      <td>2.660282</td>
      <td>6.832762</td>
      <td>11.726573</td>
      <td>5.616292</td>
      <td>1.715115</td>
      <td>19.941490</td>
      <td>9.586412</td>
      <td>2.184880</td>
      <td>24.470953</td>
      <td>13.806232</td>
      <td>2.816386</td>
      <td>0.539412</td>
      <td>6.476357</td>
      <td>0.572101</td>
      <td>3.176210</td>
      <td>119.229069</td>
      <td>116.071850</td>
      <td>6.144141</td>
      <td>2168.848871</td>
      <td>445.699643</td>
      <td>50.744911</td>
      <td>52.013891</td>
      <td>3.643398</td>
      <td>59.005557</td>
      <td>59.215437</td>
      <td>5.401759</td>
      <td>14.684347</td>
      <td>13.592733</td>
      <td>8.982522</td>
      <td>0.666895</td>
      <td>0.399544</td>
      <td>2.870647</td>
      <td>10.251511</td>
      <td>3.403934</td>
      <td>0.983293</td>
      <td>10.231721</td>
      <td>116.071850</td>
      <td>116.835035</td>
      <td>5.205801</td>
      <td>2.417642</td>
      <td>0.819581</td>
      <td>19.067863</td>
      <td>4.485810</td>
      <td>3.426532</td>
      <td>1.843978</td>
      <td>1.226782</td>
      <td>1.228117</td>
      <td>0.563332</td>
      <td>117.228523</td>
      <td>14.824503</td>
      <td>17.732367</td>
      <td>49.991609</td>
      <td>89.158574</td>
      <td>5.061035</td>
      <td>3.878356</td>
      <td>2.018556</td>
      <td>119.229069</td>
      <td>0.906005</td>
      <td>2.228578</td>
      <td>4.818136</td>
      <td>2.640678</td>
      <td>6.149121</td>
      <td>5.048727</td>
      <td>0.842950</td>
      <td>0.764914</td>
      <td>0.690645</td>
      <td>0.595341</td>
      <td>0.404329</td>
      <td>1.403242</td>
      <td>1.128908</td>
      <td>0.214357</td>
      <td>0.251739</td>
      <td>0.249517</td>
      <td>0.235028</td>
      <td>0.132418</td>
      <td>3.486760</td>
      <td>2.321194</td>
      <td>2.604811</td>
      <td>1.869853</td>
      <td>1.015222</td>
      <td>1.928814</td>
      <td>3.932232</td>
      <td>8.482969</td>
      <td>2.871477</td>
      <td>28.004395</td>
      <td>8.310211</td>
      <td>4.019124</td>
      <td>15.206973</td>
      <td>13.690141</td>
      <td>8.566743</td>
      <td>3.450404</td>
      <td>1.723662</td>
      <td>0.172795</td>
      <td>2.669393</td>
      <td>4.950353</td>
      <td>7.901514</td>
      <td>0.338057</td>
      <td>9.654077</td>
      <td>112.185015</td>
      <td>11.791488</td>
      <td>29.665480</td>
      <td>73.462201</td>
      <td>47.891499</td>
      <td>8.135065</td>
      <td>112.874321</td>
      <td>2.904043</td>
      <td>4.134119</td>
      <td>9.007144</td>
      <td>3.056041</td>
      <td>0.574513</td>
      <td>108.474565</td>
      <td>555.165722</td>
      <td>343.059723</td>
      <td>16.988892</td>
      <td>4.900100</td>
      <td>2.137224</td>
      <td>2.450544</td>
      <td>2.720636</td>
      <td>118.818312</td>
      <td>119.229069</td>
      <td>5.176446</td>
      <td>10.821910</td>
      <td>0.744174</td>
      <td>0.139770</td>
      <td>0.091251</td>
      <td>2.557418</td>
      <td>2.618130</td>
      <td>0.965104</td>
      <td>3.426532</td>
      <td>4.950353</td>
      <td>2.321194</td>
      <td>0.192593</td>
      <td>0.209222</td>
      <td>0.122086</td>
      <td>11.271895</td>
      <td>5.651655</td>
      <td>5.762810</td>
      <td>6.334482</td>
      <td>NaN</td>
      <td>1.414586</td>
      <td>3.941522</td>
      <td>1.534060</td>
      <td>1.790301</td>
      <td>NaN</td>
      <td>0.552615</td>
      <td>0.807042</td>
      <td>0.773021</td>
      <td>NaN</td>
      <td>0.797606</td>
      <td>3.627001</td>
      <td>1.623645</td>
      <td>9.439212</td>
      <td>0.062460</td>
      <td>0.158243</td>
      <td>1.854209</td>
      <td>0.408448</td>
      <td>0.192914</td>
      <td>0.217812</td>
      <td>0.542758</td>
      <td>0.500615</td>
      <td>0.028187</td>
      <td>0.548397</td>
      <td>0.546242</td>
      <td>1.531216</td>
      <td>1.180476</td>
      <td>17.188190</td>
      <td>0.275738</td>
      <td>0.618038</td>
      <td>0.420442</td>
      <td>0.219380</td>
      <td>0.189636</td>
      <td>0.089879</td>
      <td>0.051501</td>
      <td>2.703961</td>
      <td>6.855387</td>
      <td>11.862575</td>
      <td>5.541456</td>
      <td>1.641207</td>
      <td>20.175225</td>
      <td>9.649619</td>
      <td>2.115403</td>
      <td>24.974972</td>
      <td>13.990437</td>
      <td>2.787519</td>
      <td>0.525688</td>
      <td>6.332470</td>
      <td>0.567261</td>
      <td>3.141355</td>
      <td>120.349836</td>
      <td>116.921562</td>
      <td>6.151168</td>
      <td>2170.967839</td>
      <td>444.312969</td>
      <td>51.702598</td>
      <td>52.846013</td>
      <td>3.671086</td>
      <td>59.408668</td>
      <td>59.649384</td>
      <td>5.348855</td>
      <td>14.399394</td>
      <td>13.379318</td>
      <td>8.932960</td>
      <td>0.670045</td>
      <td>0.405043</td>
      <td>2.929930</td>
      <td>10.425809</td>
      <td>3.474786</td>
      <td>0.996109</td>
      <td>10.419660</td>
      <td>116.921562</td>
      <td>117.856119</td>
      <td>5.108167</td>
      <td>2.394477</td>
      <td>0.837783</td>
      <td>18.926442</td>
      <td>4.461939</td>
      <td>3.465959</td>
      <td>1.852495</td>
      <td>1.273013</td>
      <td>1.253528</td>
      <td>0.555805</td>
      <td>119.017408</td>
      <td>14.350673</td>
      <td>17.779460</td>
      <td>50.632261</td>
      <td>89.905177</td>
      <td>5.074563</td>
      <td>3.824267</td>
      <td>1.953636</td>
      <td>120.349836</td>
      <td>0.905120</td>
      <td>2.222899</td>
      <td>4.840289</td>
      <td>2.638053</td>
      <td>6.235966</td>
      <td>5.138590</td>
      <td>0.855581</td>
      <td>0.774006</td>
      <td>0.707101</td>
      <td>0.609149</td>
      <td>0.411871</td>
      <td>1.389641</td>
      <td>1.130901</td>
      <td>0.220694</td>
      <td>0.251019</td>
      <td>0.263766</td>
      <td>0.243332</td>
      <td>0.135716</td>
      <td>3.497036</td>
      <td>2.283436</td>
      <td>2.575933</td>
      <td>1.880128</td>
      <td>1.026761</td>
      <td>1.903147</td>
      <td>3.991825</td>
      <td>8.613304</td>
      <td>2.975346</td>
      <td>27.787039</td>
      <td>8.192015</td>
      <td>3.904190</td>
      <td>14.934585</td>
      <td>13.454384</td>
      <td>8.855899</td>
      <td>3.427076</td>
      <td>1.641214</td>
      <td>0.176925</td>
      <td>2.692379</td>
      <td>4.848354</td>
      <td>7.741390</td>
      <td>0.326118</td>
      <td>9.582076</td>
      <td>113.150911</td>
      <td>11.346986</td>
      <td>29.170312</td>
      <td>75.558722</td>
      <td>47.850712</td>
      <td>8.148257</td>
      <td>113.983664</td>
      <td>2.935263</td>
      <td>4.119026</td>
      <td>8.891462</td>
      <td>3.069472</td>
      <td>0.559645</td>
      <td>110.104248</td>
      <td>567.762012</td>
      <td>352.252975</td>
      <td>17.649311</td>
      <td>5.005604</td>
      <td>2.101465</td>
      <td>2.442809</td>
      <td>2.752240</td>
      <td>119.845963</td>
      <td>120.349836</td>
      <td>5.157349</td>
      <td>10.905252</td>
      <td>0.753974</td>
      <td>0.145882</td>
      <td>0.090107</td>
      <td>2.516177</td>
      <td>2.584682</td>
      <td>0.962440</td>
      <td>3.465959</td>
      <td>4.848354</td>
      <td>2.283436</td>
      <td>0.198533</td>
      <td>0.213166</td>
      <td>0.119223</td>
      <td>11.291527</td>
      <td>5.667756</td>
      <td>5.856177</td>
      <td>6.246339</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>3.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.300000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.200000</td>
      <td>0.200000</td>
      <td>0.030000</td>
      <td>-2.100000</td>
      <td>-2.100000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-25.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.833333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.333333</td>
      <td>9.333333</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>7.933333</td>
      <td>22.033333</td>
      <td>1.666667</td>
      <td>0.000000</td>
      <td>11.400000</td>
      <td>1.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.500000</td>
      <td>157.000000</td>
      <td>251.666667</td>
      <td>58.200000</td>
      <td>3334.666667</td>
      <td>1419.000000</td>
      <td>58.000000</td>
      <td>70.000000</td>
      <td>68.133333</td>
      <td>55.666667</td>
      <td>78.000000</td>
      <td>63.566667</td>
      <td>26.333333</td>
      <td>68.000000</td>
      <td>33.233333</td>
      <td>0.000000</td>
      <td>0.133333</td>
      <td>1.666667</td>
      <td>10.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>8.000000</td>
      <td>251.666667</td>
      <td>212.000000</td>
      <td>32.333333</td>
      <td>4.333333</td>
      <td>0.000000</td>
      <td>32.000000</td>
      <td>4.333333</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>88.000000</td>
      <td>31.333333</td>
      <td>57.666667</td>
      <td>37.000000</td>
      <td>118.500000</td>
      <td>7.666667</td>
      <td>7.000000</td>
      <td>0.666667</td>
      <td>157.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.333333</td>
      <td>4.333333</td>
      <td>4.666667</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.333333</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>9.166667</td>
      <td>2.666667</td>
      <td>80.333333</td>
      <td>19.333333</td>
      <td>13.700000</td>
      <td>15.666667</td>
      <td>31.333333</td>
      <td>12.666667</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>1.666667</td>
      <td>6.333333</td>
      <td>0.000000</td>
      <td>24.666667</td>
      <td>361.666667</td>
      <td>25.000000</td>
      <td>116.000000</td>
      <td>140.666667</td>
      <td>54.666667</td>
      <td>5.666667</td>
      <td>324.333333</td>
      <td>2.666667</td>
      <td>5.000000</td>
      <td>28.600000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>157.000000</td>
      <td>778.000000</td>
      <td>348.666667</td>
      <td>12.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
      <td>219.333333</td>
      <td>157.000000</td>
      <td>63.700000</td>
      <td>11.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.333333</td>
      <td>4.666667</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>1.666667</td>
      <td>4.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>50.333333</td>
      <td>4.000000</td>
      <td>5.666667</td>
      <td>22.200000</td>
      <td>NaN</td>
      <td>2017.000000</td>
      <td>1.000000</td>
      <td>2017.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>0.333333</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11.766667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.200000</td>
      <td>0.166667</td>
      <td>0.033333</td>
      <td>-1.700000</td>
      <td>-1.700000</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>-8.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.800000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.666667</td>
      <td>2.333333</td>
      <td>11.100000</td>
      <td>10.000000</td>
      <td>0.333333</td>
      <td>8.200000</td>
      <td>22.500000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>10.733333</td>
      <td>1.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.000000</td>
      <td>137.000000</td>
      <td>235.000000</td>
      <td>58.300000</td>
      <td>3027.000000</td>
      <td>1359.000000</td>
      <td>53.000000</td>
      <td>68.000000</td>
      <td>71.333333</td>
      <td>51.000000</td>
      <td>72.000000</td>
      <td>64.733333</td>
      <td>27.000000</td>
      <td>65.666667</td>
      <td>32.133333</td>
      <td>0.000000</td>
      <td>0.100000</td>
      <td>2.000000</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>235.000000</td>
      <td>190.000000</td>
      <td>29.666667</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>34.000000</td>
      <td>4.666667</td>
      <td>3.333333</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>103.666667</td>
      <td>27.666667</td>
      <td>54.333333</td>
      <td>42.000000</td>
      <td>112.000000</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>137.000000</td>
      <td>0.000000</td>
      <td>2.666667</td>
      <td>1.666667</td>
      <td>5.000000</td>
      <td>5.500000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.000000</td>
      <td>4.333333</td>
      <td>1.666667</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.333333</td>
      <td>6.000000</td>
      <td>11.666667</td>
      <td>2.000000</td>
      <td>66.000000</td>
      <td>17.333333</td>
      <td>16.966667</td>
      <td>12.000000</td>
      <td>30.666667</td>
      <td>9.500000</td>
      <td>6.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.666667</td>
      <td>1.333333</td>
      <td>6.666667</td>
      <td>0.000000</td>
      <td>23.000000</td>
      <td>346.000000</td>
      <td>32.000000</td>
      <td>112.000000</td>
      <td>124.000000</td>
      <td>55.000000</td>
      <td>6.000000</td>
      <td>303.000000</td>
      <td>2.000000</td>
      <td>6.000000</td>
      <td>22.333333</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>142.000000</td>
      <td>780.000000</td>
      <td>356.000000</td>
      <td>9.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>3.666667</td>
      <td>203.000000</td>
      <td>137.000000</td>
      <td>61.866667</td>
      <td>6.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.333333</td>
      <td>3.666667</td>
      <td>0.000000</td>
      <td>3.333333</td>
      <td>1.333333</td>
      <td>4.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>51.666667</td>
      <td>5.000000</td>
      <td>6.000000</td>
      <td>28.633333</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>950.750000</td>
      <td>10.000000</td>
      <td>8.000000</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>9.666667</td>
      <td>3.000000</td>
      <td>27.150000</td>
      <td>0.056667</td>
      <td>0.170000</td>
      <td>15.733333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.900000</td>
      <td>0.833333</td>
      <td>0.080000</td>
      <td>-0.400000</td>
      <td>-0.400000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>58.333333</td>
      <td>0.000000</td>
      <td>0.866667</td>
      <td>-0.266667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.666667</td>
      <td>12.333333</td>
      <td>33.100000</td>
      <td>20.333333</td>
      <td>3.000000</td>
      <td>34.716667</td>
      <td>34.866667</td>
      <td>6.000000</td>
      <td>48.900000</td>
      <td>41.616667</td>
      <td>7.000000</td>
      <td>0.333333</td>
      <td>2.766667</td>
      <td>0.333333</td>
      <td>12.233333</td>
      <td>299.833333</td>
      <td>406.666667</td>
      <td>73.000000</td>
      <td>6008.666667</td>
      <td>2243.166667</td>
      <td>121.666667</td>
      <td>143.000000</td>
      <td>84.400000</td>
      <td>119.333333</td>
      <td>146.666667</td>
      <td>80.400000</td>
      <td>47.333333</td>
      <td>91.333333</td>
      <td>50.250000</td>
      <td>0.333333</td>
      <td>0.600000</td>
      <td>6.666667</td>
      <td>22.000000</td>
      <td>5.666667</td>
      <td>1.333333</td>
      <td>24.666667</td>
      <td>406.666667</td>
      <td>358.333333</td>
      <td>44.333333</td>
      <td>10.000000</td>
      <td>0.333333</td>
      <td>61.000000</td>
      <td>11.000000</td>
      <td>9.333333</td>
      <td>4.000000</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>232.833333</td>
      <td>57.333333</td>
      <td>90.666667</td>
      <td>102.666667</td>
      <td>227.666667</td>
      <td>17.000000</td>
      <td>18.333333</td>
      <td>5.000000</td>
      <td>299.833333</td>
      <td>1.000000</td>
      <td>7.333333</td>
      <td>8.000000</td>
      <td>10.000000</td>
      <td>14.666667</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>0.333333</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.333333</td>
      <td>9.000000</td>
      <td>7.000000</td>
      <td>5.333333</td>
      <td>1.333333</td>
      <td>4.666667</td>
      <td>13.666667</td>
      <td>30.650000</td>
      <td>8.333333</td>
      <td>130.333333</td>
      <td>38.000000</td>
      <td>26.766667</td>
      <td>42.333333</td>
      <td>55.000000</td>
      <td>26.666667</td>
      <td>13.333333</td>
      <td>2.666667</td>
      <td>0.000000</td>
      <td>10.333333</td>
      <td>8.333333</td>
      <td>20.000000</td>
      <td>0.000000</td>
      <td>42.666667</td>
      <td>530.166667</td>
      <td>58.333333</td>
      <td>179.333333</td>
      <td>235.666667</td>
      <td>127.666667</td>
      <td>17.666667</td>
      <td>483.333333</td>
      <td>7.666667</td>
      <td>13.666667</td>
      <td>52.583333</td>
      <td>8.333333</td>
      <td>0.333333</td>
      <td>301.666667</td>
      <td>1526.500000</td>
      <td>788.166667</td>
      <td>30.333333</td>
      <td>9.333333</td>
      <td>2.666667</td>
      <td>10.666667</td>
      <td>9.833333</td>
      <td>374.333333</td>
      <td>299.833333</td>
      <td>79.116667</td>
      <td>26.333333</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.666667</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>9.333333</td>
      <td>8.333333</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>82.000000</td>
      <td>15.333333</td>
      <td>15.000000</td>
      <td>46.066667</td>
      <td>NaN</td>
      <td>2018.000000</td>
      <td>3.000000</td>
      <td>2018.000000</td>
      <td>4.000000</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>NaN</td>
      <td>0.666667</td>
      <td>10.000000</td>
      <td>3.000000</td>
      <td>27.266667</td>
      <td>0.060000</td>
      <td>0.183333</td>
      <td>15.766667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.966667</td>
      <td>0.866667</td>
      <td>0.080000</td>
      <td>-0.366667</td>
      <td>-0.366667</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>58.566667</td>
      <td>0.000000</td>
      <td>0.866667</td>
      <td>-0.266667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.666667</td>
      <td>11.666667</td>
      <td>33.333333</td>
      <td>20.000000</td>
      <td>3.000000</td>
      <td>34.466667</td>
      <td>34.500000</td>
      <td>6.000000</td>
      <td>46.800000</td>
      <td>40.966667</td>
      <td>6.666667</td>
      <td>0.333333</td>
      <td>3.033333</td>
      <td>0.333333</td>
      <td>12.300000</td>
      <td>305.000000</td>
      <td>411.666667</td>
      <td>73.033333</td>
      <td>6110.666667</td>
      <td>2265.000000</td>
      <td>123.333333</td>
      <td>145.000000</td>
      <td>84.366667</td>
      <td>121.333333</td>
      <td>149.333333</td>
      <td>80.600000</td>
      <td>48.000000</td>
      <td>91.333333</td>
      <td>50.400000</td>
      <td>0.333333</td>
      <td>0.633333</td>
      <td>7.000000</td>
      <td>22.333333</td>
      <td>6.000000</td>
      <td>1.333333</td>
      <td>25.333333</td>
      <td>411.666667</td>
      <td>362.333333</td>
      <td>44.333333</td>
      <td>10.000000</td>
      <td>0.333333</td>
      <td>60.666667</td>
      <td>11.333333</td>
      <td>9.666667</td>
      <td>4.000000</td>
      <td>1.333333</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>235.000000</td>
      <td>57.333333</td>
      <td>91.000000</td>
      <td>105.333333</td>
      <td>230.666667</td>
      <td>17.000000</td>
      <td>18.666667</td>
      <td>5.333333</td>
      <td>305.000000</td>
      <td>1.000000</td>
      <td>7.333333</td>
      <td>8.000000</td>
      <td>10.333333</td>
      <td>15.333333</td>
      <td>10.333333</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.333333</td>
      <td>9.333333</td>
      <td>7.000000</td>
      <td>5.333333</td>
      <td>1.333333</td>
      <td>4.666667</td>
      <td>13.666667</td>
      <td>30.533333</td>
      <td>8.333333</td>
      <td>131.000000</td>
      <td>38.333333</td>
      <td>27.066667</td>
      <td>41.333333</td>
      <td>56.000000</td>
      <td>27.000000</td>
      <td>13.333333</td>
      <td>2.666667</td>
      <td>0.000000</td>
      <td>10.000000</td>
      <td>8.333333</td>
      <td>19.333333</td>
      <td>0.000000</td>
      <td>43.333333</td>
      <td>535.666667</td>
      <td>57.000000</td>
      <td>178.000000</td>
      <td>238.000000</td>
      <td>132.000000</td>
      <td>18.333333</td>
      <td>489.000000</td>
      <td>7.333333</td>
      <td>13.666667</td>
      <td>52.466667</td>
      <td>8.333333</td>
      <td>0.333333</td>
      <td>303.000000</td>
      <td>1534.333333</td>
      <td>796.666667</td>
      <td>30.333333</td>
      <td>9.666667</td>
      <td>2.666667</td>
      <td>10.333333</td>
      <td>10.000000</td>
      <td>379.666667</td>
      <td>305.000000</td>
      <td>79.166667</td>
      <td>27.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.666667</td>
      <td>10.333333</td>
      <td>1.333333</td>
      <td>9.666667</td>
      <td>8.333333</td>
      <td>9.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>82.333333</td>
      <td>15.000000</td>
      <td>15.000000</td>
      <td>45.833333</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1898.500000</td>
      <td>19.500000</td>
      <td>16.000000</td>
      <td>1.000000</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>NaN</td>
      <td>1.333333</td>
      <td>11.666667</td>
      <td>3.666667</td>
      <td>33.333333</td>
      <td>0.096667</td>
      <td>0.276667</td>
      <td>16.966667</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.200000</td>
      <td>1.133333</td>
      <td>0.096667</td>
      <td>-0.033333</td>
      <td>-0.033333</td>
      <td>4.000000</td>
      <td>2.666667</td>
      <td>71.133333</td>
      <td>0.333333</td>
      <td>1.266667</td>
      <td>0.033333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.666667</td>
      <td>17.666667</td>
      <td>39.766667</td>
      <td>23.666667</td>
      <td>4.000000</td>
      <td>51.300000</td>
      <td>42.100000</td>
      <td>7.666667</td>
      <td>70.933333</td>
      <td>53.866667</td>
      <td>8.666667</td>
      <td>0.666667</td>
      <td>6.466667</td>
      <td>0.666667</td>
      <td>14.133333</td>
      <td>366.666667</td>
      <td>472.666667</td>
      <td>77.433333</td>
      <td>7265.333333</td>
      <td>2498.333333</td>
      <td>150.000000</td>
      <td>172.666667</td>
      <td>87.000000</td>
      <td>154.000000</td>
      <td>182.333333</td>
      <td>84.700000</td>
      <td>56.000000</td>
      <td>100.000000</td>
      <td>56.366667</td>
      <td>0.666667</td>
      <td>0.833333</td>
      <td>8.333333</td>
      <td>26.666667</td>
      <td>7.333333</td>
      <td>1.666667</td>
      <td>30.333333</td>
      <td>472.666667</td>
      <td>423.000000</td>
      <td>47.666667</td>
      <td>11.666667</td>
      <td>0.666667</td>
      <td>71.333333</td>
      <td>14.000000</td>
      <td>11.333333</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>1.666667</td>
      <td>0.333333</td>
      <td>300.000000</td>
      <td>66.333333</td>
      <td>102.333333</td>
      <td>126.000000</td>
      <td>282.000000</td>
      <td>20.000000</td>
      <td>20.666667</td>
      <td>6.333333</td>
      <td>366.666667</td>
      <td>1.666667</td>
      <td>9.000000</td>
      <td>11.333333</td>
      <td>12.000000</td>
      <td>18.333333</td>
      <td>12.666667</td>
      <td>1.666667</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.333333</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>17.666667</td>
      <td>10.666667</td>
      <td>9.000000</td>
      <td>6.666667</td>
      <td>2.000000</td>
      <td>6.000000</td>
      <td>16.000000</td>
      <td>36.333333</td>
      <td>10.333333</td>
      <td>148.666667</td>
      <td>43.333333</td>
      <td>29.433333</td>
      <td>51.666667</td>
      <td>64.000000</td>
      <td>32.000000</td>
      <td>16.000000</td>
      <td>3.666667</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>12.333333</td>
      <td>24.666667</td>
      <td>0.333333</td>
      <td>49.333333</td>
      <td>596.333333</td>
      <td>65.666667</td>
      <td>199.333333</td>
      <td>278.333333</td>
      <td>150.000000</td>
      <td>22.333333</td>
      <td>547.666667</td>
      <td>9.333333</td>
      <td>16.333333</td>
      <td>58.300000</td>
      <td>10.333333</td>
      <td>0.666667</td>
      <td>361.666667</td>
      <td>1874.000000</td>
      <td>995.666667</td>
      <td>39.000000</td>
      <td>12.000000</td>
      <td>3.666667</td>
      <td>12.000000</td>
      <td>11.666667</td>
      <td>444.000000</td>
      <td>366.666667</td>
      <td>82.866667</td>
      <td>32.333333</td>
      <td>1.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>12.333333</td>
      <td>11.666667</td>
      <td>1.666667</td>
      <td>11.333333</td>
      <td>12.333333</td>
      <td>10.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>89.333333</td>
      <td>18.666667</td>
      <td>18.666667</td>
      <td>49.966667</td>
      <td>NaN</td>
      <td>2019.000000</td>
      <td>7.000000</td>
      <td>2019.000000</td>
      <td>5.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>NaN</td>
      <td>1.333333</td>
      <td>12.333333</td>
      <td>4.000000</td>
      <td>33.233333</td>
      <td>0.096667</td>
      <td>0.280000</td>
      <td>16.933333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.266667</td>
      <td>1.166667</td>
      <td>0.096667</td>
      <td>-0.033333</td>
      <td>-0.033333</td>
      <td>4.000000</td>
      <td>2.666667</td>
      <td>70.000000</td>
      <td>0.333333</td>
      <td>1.266667</td>
      <td>0.033333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.333333</td>
      <td>17.333333</td>
      <td>40.400000</td>
      <td>23.666667</td>
      <td>4.000000</td>
      <td>51.200000</td>
      <td>41.866667</td>
      <td>7.333333</td>
      <td>71.166667</td>
      <td>54.000000</td>
      <td>8.333333</td>
      <td>0.666667</td>
      <td>6.533333</td>
      <td>0.666667</td>
      <td>14.266667</td>
      <td>372.333333</td>
      <td>478.666667</td>
      <td>77.666667</td>
      <td>7365.333333</td>
      <td>2526.333333</td>
      <td>151.666667</td>
      <td>174.333333</td>
      <td>87.100000</td>
      <td>157.000000</td>
      <td>184.000000</td>
      <td>84.800000</td>
      <td>57.000000</td>
      <td>100.333333</td>
      <td>56.766667</td>
      <td>1.000000</td>
      <td>0.833333</td>
      <td>8.666667</td>
      <td>27.333333</td>
      <td>7.666667</td>
      <td>2.000000</td>
      <td>31.000000</td>
      <td>478.666667</td>
      <td>429.333333</td>
      <td>48.000000</td>
      <td>11.666667</td>
      <td>0.666667</td>
      <td>72.000000</td>
      <td>14.000000</td>
      <td>12.000000</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>1.666667</td>
      <td>0.333333</td>
      <td>306.000000</td>
      <td>67.000000</td>
      <td>102.333333</td>
      <td>127.000000</td>
      <td>284.000000</td>
      <td>20.333333</td>
      <td>21.000000</td>
      <td>6.333333</td>
      <td>372.333333</td>
      <td>1.666667</td>
      <td>8.666667</td>
      <td>11.666667</td>
      <td>12.000000</td>
      <td>19.000000</td>
      <td>13.333333</td>
      <td>1.666667</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.333333</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>17.666667</td>
      <td>10.666667</td>
      <td>8.666667</td>
      <td>6.666667</td>
      <td>2.000000</td>
      <td>6.000000</td>
      <td>16.000000</td>
      <td>36.366667</td>
      <td>10.333333</td>
      <td>148.666667</td>
      <td>43.333333</td>
      <td>29.533333</td>
      <td>51.000000</td>
      <td>64.000000</td>
      <td>32.666667</td>
      <td>15.666667</td>
      <td>3.666667</td>
      <td>0.000000</td>
      <td>12.000000</td>
      <td>12.333333</td>
      <td>24.333333</td>
      <td>0.333333</td>
      <td>49.666667</td>
      <td>599.666667</td>
      <td>64.333333</td>
      <td>195.666667</td>
      <td>279.666667</td>
      <td>155.333333</td>
      <td>23.000000</td>
      <td>551.666667</td>
      <td>9.333333</td>
      <td>16.333333</td>
      <td>58.266667</td>
      <td>10.333333</td>
      <td>0.666667</td>
      <td>369.333333</td>
      <td>1916.666667</td>
      <td>1013.666667</td>
      <td>40.000000</td>
      <td>12.000000</td>
      <td>4.000000</td>
      <td>12.333333</td>
      <td>11.666667</td>
      <td>448.666667</td>
      <td>372.333333</td>
      <td>83.133333</td>
      <td>33.666667</td>
      <td>1.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>12.333333</td>
      <td>12.000000</td>
      <td>1.666667</td>
      <td>12.000000</td>
      <td>12.333333</td>
      <td>10.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>90.000000</td>
      <td>18.666667</td>
      <td>18.666667</td>
      <td>49.800000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2853.500000</td>
      <td>29.000000</td>
      <td>23.000000</td>
      <td>1.333333</td>
      <td>1.666667</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>1.666667</td>
      <td>14.333333</td>
      <td>5.000000</td>
      <td>40.300000</td>
      <td>0.140000</td>
      <td>0.400000</td>
      <td>18.233333</td>
      <td>0.666667</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>1.633333</td>
      <td>1.466667</td>
      <td>0.116667</td>
      <td>0.366667</td>
      <td>0.333333</td>
      <td>5.000000</td>
      <td>3.666667</td>
      <td>80.966667</td>
      <td>0.333333</td>
      <td>1.733333</td>
      <td>0.300000</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.666667</td>
      <td>22.666667</td>
      <td>47.883333</td>
      <td>27.666667</td>
      <td>5.000000</td>
      <td>66.800000</td>
      <td>50.016667</td>
      <td>9.000000</td>
      <td>88.900000</td>
      <td>63.683333</td>
      <td>10.666667</td>
      <td>1.000000</td>
      <td>11.100000</td>
      <td>1.000000</td>
      <td>16.100000</td>
      <td>461.250000</td>
      <td>566.166667</td>
      <td>81.783333</td>
      <td>8979.000000</td>
      <td>2816.833333</td>
      <td>186.000000</td>
      <td>210.000000</td>
      <td>89.250000</td>
      <td>202.666667</td>
      <td>230.500000</td>
      <td>88.016667</td>
      <td>67.000000</td>
      <td>109.333333</td>
      <td>63.116667</td>
      <td>1.333333</td>
      <td>1.100000</td>
      <td>10.666667</td>
      <td>33.666667</td>
      <td>10.000000</td>
      <td>2.666667</td>
      <td>37.500000</td>
      <td>566.166667</td>
      <td>517.500000</td>
      <td>51.333333</td>
      <td>13.333333</td>
      <td>1.333333</td>
      <td>85.000000</td>
      <td>17.000000</td>
      <td>14.000000</td>
      <td>6.000000</td>
      <td>3.000000</td>
      <td>2.333333</td>
      <td>0.666667</td>
      <td>396.000000</td>
      <td>76.666667</td>
      <td>115.333333</td>
      <td>155.500000</td>
      <td>350.500000</td>
      <td>23.666667</td>
      <td>23.333333</td>
      <td>7.666667</td>
      <td>461.250000</td>
      <td>2.000000</td>
      <td>10.333333</td>
      <td>15.000000</td>
      <td>13.666667</td>
      <td>22.666667</td>
      <td>16.666667</td>
      <td>2.333333</td>
      <td>1.666667</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>20.000000</td>
      <td>12.333333</td>
      <td>10.666667</td>
      <td>7.666667</td>
      <td>2.666667</td>
      <td>7.333333</td>
      <td>18.666667</td>
      <td>42.083333</td>
      <td>12.333333</td>
      <td>168.333333</td>
      <td>49.000000</td>
      <td>32.100000</td>
      <td>62.000000</td>
      <td>73.666667</td>
      <td>38.000000</td>
      <td>18.000000</td>
      <td>5.000000</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>15.833333</td>
      <td>30.000000</td>
      <td>0.333333</td>
      <td>56.333333</td>
      <td>683.666667</td>
      <td>73.666667</td>
      <td>220.000000</td>
      <td>328.333333</td>
      <td>182.333333</td>
      <td>28.000000</td>
      <td>637.666667</td>
      <td>11.333333</td>
      <td>19.000000</td>
      <td>64.150000</td>
      <td>12.333333</td>
      <td>1.000000</td>
      <td>448.833333</td>
      <td>2302.166667</td>
      <td>1252.000000</td>
      <td>51.666667</td>
      <td>15.333333</td>
      <td>5.333333</td>
      <td>13.666667</td>
      <td>13.333333</td>
      <td>537.333333</td>
      <td>461.250000</td>
      <td>86.233333</td>
      <td>40.333333</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>13.666667</td>
      <td>2.333333</td>
      <td>14.000000</td>
      <td>15.833333</td>
      <td>12.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>97.333333</td>
      <td>22.666667</td>
      <td>23.000000</td>
      <td>54.050000</td>
      <td>NaN</td>
      <td>2020.000000</td>
      <td>11.000000</td>
      <td>2021.000000</td>
      <td>6.000000</td>
      <td>NaN</td>
      <td>1.333333</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>1.666667</td>
      <td>14.666667</td>
      <td>5.333333</td>
      <td>39.433333</td>
      <td>0.136667</td>
      <td>0.396667</td>
      <td>18.166667</td>
      <td>0.666667</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>1.633333</td>
      <td>1.500000</td>
      <td>0.116667</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>5.000000</td>
      <td>3.666667</td>
      <td>80.566667</td>
      <td>0.333333</td>
      <td>1.700000</td>
      <td>0.266667</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.666667</td>
      <td>22.333333</td>
      <td>48.200000</td>
      <td>27.333333</td>
      <td>5.000000</td>
      <td>66.400000</td>
      <td>49.666667</td>
      <td>8.666667</td>
      <td>88.900000</td>
      <td>63.933333</td>
      <td>10.333333</td>
      <td>1.000000</td>
      <td>11.100000</td>
      <td>1.000000</td>
      <td>16.333333</td>
      <td>465.666667</td>
      <td>566.666667</td>
      <td>82.000000</td>
      <td>8991.000000</td>
      <td>2841.666667</td>
      <td>190.000000</td>
      <td>213.666667</td>
      <td>89.366667</td>
      <td>203.666667</td>
      <td>229.666667</td>
      <td>88.066667</td>
      <td>68.000000</td>
      <td>109.333333</td>
      <td>63.766667</td>
      <td>1.333333</td>
      <td>1.133333</td>
      <td>11.000000</td>
      <td>34.333333</td>
      <td>10.333333</td>
      <td>2.666667</td>
      <td>38.000000</td>
      <td>566.666667</td>
      <td>519.666667</td>
      <td>51.333333</td>
      <td>13.000000</td>
      <td>1.333333</td>
      <td>85.000000</td>
      <td>17.333333</td>
      <td>14.333333</td>
      <td>6.333333</td>
      <td>3.000000</td>
      <td>2.333333</td>
      <td>0.666667</td>
      <td>397.666667</td>
      <td>77.333333</td>
      <td>115.666667</td>
      <td>156.000000</td>
      <td>355.000000</td>
      <td>23.666667</td>
      <td>23.666667</td>
      <td>7.666667</td>
      <td>465.666667</td>
      <td>2.333333</td>
      <td>10.333333</td>
      <td>15.000000</td>
      <td>13.666667</td>
      <td>23.333333</td>
      <td>17.333333</td>
      <td>2.333333</td>
      <td>1.666667</td>
      <td>1.333333</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>20.000000</td>
      <td>12.333333</td>
      <td>10.666667</td>
      <td>8.000000</td>
      <td>3.000000</td>
      <td>7.000000</td>
      <td>18.666667</td>
      <td>42.133333</td>
      <td>12.000000</td>
      <td>167.666667</td>
      <td>49.000000</td>
      <td>32.266667</td>
      <td>60.666667</td>
      <td>74.000000</td>
      <td>39.333333</td>
      <td>18.000000</td>
      <td>4.666667</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>15.666667</td>
      <td>29.333333</td>
      <td>0.333333</td>
      <td>56.666667</td>
      <td>686.000000</td>
      <td>72.000000</td>
      <td>217.333333</td>
      <td>334.000000</td>
      <td>187.666667</td>
      <td>28.666667</td>
      <td>639.333333</td>
      <td>11.333333</td>
      <td>19.000000</td>
      <td>64.300000</td>
      <td>12.333333</td>
      <td>1.000000</td>
      <td>452.333333</td>
      <td>2354.000000</td>
      <td>1290.000000</td>
      <td>53.000000</td>
      <td>15.666667</td>
      <td>5.333333</td>
      <td>13.666667</td>
      <td>13.666667</td>
      <td>539.000000</td>
      <td>465.666667</td>
      <td>86.433333</td>
      <td>41.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.000000</td>
      <td>13.666667</td>
      <td>2.333333</td>
      <td>14.333333</td>
      <td>15.666667</td>
      <td>12.333333</td>
      <td>0.333333</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>98.000000</td>
      <td>23.000000</td>
      <td>23.000000</td>
      <td>53.933333</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3799.000000</td>
      <td>38.000000</td>
      <td>31.000000</td>
      <td>2.000000</td>
      <td>4.666667</td>
      <td>5.666667</td>
      <td>NaN</td>
      <td>4.666667</td>
      <td>28.000000</td>
      <td>10.000000</td>
      <td>66.966667</td>
      <td>0.500000</td>
      <td>1.000000</td>
      <td>25.600000</td>
      <td>2.333333</td>
      <td>1.666667</td>
      <td>1.666667</td>
      <td>3.833333</td>
      <td>3.733333</td>
      <td>0.233333</td>
      <td>2.400000</td>
      <td>2.400000</td>
      <td>13.000000</td>
      <td>8.000000</td>
      <td>100.000000</td>
      <td>1.000000</td>
      <td>3.933333</td>
      <td>1.600000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>17.666667</td>
      <td>37.333333</td>
      <td>90.000000</td>
      <td>47.333333</td>
      <td>10.666667</td>
      <td>98.933333</td>
      <td>71.100000</td>
      <td>22.000000</td>
      <td>100.000000</td>
      <td>85.850000</td>
      <td>19.666667</td>
      <td>3.333333</td>
      <td>44.766667</td>
      <td>3.666667</td>
      <td>40.666667</td>
      <td>841.666667</td>
      <td>927.333333</td>
      <td>90.833333</td>
      <td>15066.666667</td>
      <td>4280.333333</td>
      <td>392.666667</td>
      <td>416.000000</td>
      <td>94.600000</td>
      <td>366.666667</td>
      <td>397.000000</td>
      <td>94.266667</td>
      <td>117.666667</td>
      <td>164.000000</td>
      <td>83.633333</td>
      <td>4.333333</td>
      <td>2.833333</td>
      <td>22.000000</td>
      <td>71.000000</td>
      <td>24.333333</td>
      <td>8.000000</td>
      <td>76.666667</td>
      <td>927.333333</td>
      <td>884.000000</td>
      <td>67.000000</td>
      <td>20.000000</td>
      <td>5.333333</td>
      <td>171.333333</td>
      <td>31.000000</td>
      <td>26.666667</td>
      <td>14.000000</td>
      <td>8.000000</td>
      <td>8.000000</td>
      <td>5.000000</td>
      <td>786.000000</td>
      <td>141.333333</td>
      <td>169.000000</td>
      <td>400.333333</td>
      <td>609.333333</td>
      <td>42.333333</td>
      <td>36.333333</td>
      <td>14.333333</td>
      <td>841.666667</td>
      <td>7.000000</td>
      <td>16.333333</td>
      <td>32.666667</td>
      <td>22.333333</td>
      <td>45.000000</td>
      <td>38.000000</td>
      <td>5.000000</td>
      <td>5.666667</td>
      <td>5.666667</td>
      <td>3.666667</td>
      <td>2.000000</td>
      <td>8.666667</td>
      <td>8.000000</td>
      <td>1.333333</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>1.666667</td>
      <td>1.000000</td>
      <td>32.000000</td>
      <td>18.666667</td>
      <td>21.000000</td>
      <td>14.000000</td>
      <td>6.666667</td>
      <td>17.666667</td>
      <td>36.333333</td>
      <td>66.700000</td>
      <td>24.000000</td>
      <td>268.333333</td>
      <td>83.000000</td>
      <td>43.100000</td>
      <td>122.666667</td>
      <td>122.000000</td>
      <td>76.666667</td>
      <td>30.666667</td>
      <td>14.666667</td>
      <td>1.000000</td>
      <td>22.666667</td>
      <td>31.666667</td>
      <td>62.666667</td>
      <td>2.666667</td>
      <td>77.666667</td>
      <td>1023.666667</td>
      <td>141.000000</td>
      <td>363.000000</td>
      <td>598.333333</td>
      <td>367.666667</td>
      <td>63.333333</td>
      <td>981.333333</td>
      <td>24.333333</td>
      <td>36.333333</td>
      <td>90.000000</td>
      <td>25.666667</td>
      <td>4.666667</td>
      <td>746.333333</td>
      <td>3773.333333</td>
      <td>2269.666667</td>
      <td>109.666667</td>
      <td>35.666667</td>
      <td>14.333333</td>
      <td>23.000000</td>
      <td>23.000000</td>
      <td>912.000000</td>
      <td>841.666667</td>
      <td>94.300000</td>
      <td>76.666667</td>
      <td>4.333333</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>21.000000</td>
      <td>22.000000</td>
      <td>7.000000</td>
      <td>26.666667</td>
      <td>31.666667</td>
      <td>18.666667</td>
      <td>1.666667</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>126.000000</td>
      <td>50.333333</td>
      <td>43.000000</td>
      <td>75.766667</td>
      <td>NaN</td>
      <td>2021.000000</td>
      <td>12.000000</td>
      <td>2022.000000</td>
      <td>6.000000</td>
      <td>NaN</td>
      <td>2.000000</td>
      <td>5.666667</td>
      <td>4.666667</td>
      <td>NaN</td>
      <td>5.666667</td>
      <td>27.666667</td>
      <td>11.666667</td>
      <td>75.000000</td>
      <td>0.426667</td>
      <td>1.000000</td>
      <td>25.033333</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>3.666667</td>
      <td>3.300000</td>
      <td>0.240000</td>
      <td>2.366667</td>
      <td>2.366667</td>
      <td>10.333333</td>
      <td>8.000000</td>
      <td>100.000000</td>
      <td>1.333333</td>
      <td>3.766667</td>
      <td>1.500000</td>
      <td>1.500000</td>
      <td>1.500000</td>
      <td>1.000000</td>
      <td>0.666667</td>
      <td>16.333333</td>
      <td>42.000000</td>
      <td>95.233333</td>
      <td>50.333333</td>
      <td>10.333333</td>
      <td>100.000000</td>
      <td>71.666667</td>
      <td>16.000000</td>
      <td>100.000000</td>
      <td>81.833333</td>
      <td>21.333333</td>
      <td>3.666667</td>
      <td>42.933333</td>
      <td>3.333333</td>
      <td>40.266667</td>
      <td>846.333333</td>
      <td>930.666667</td>
      <td>91.066667</td>
      <td>14734.333333</td>
      <td>4056.666667</td>
      <td>406.333333</td>
      <td>429.333333</td>
      <td>95.100000</td>
      <td>356.666667</td>
      <td>385.000000</td>
      <td>94.633333</td>
      <td>114.666667</td>
      <td>164.000000</td>
      <td>80.666667</td>
      <td>5.000000</td>
      <td>2.700000</td>
      <td>25.000000</td>
      <td>79.333333</td>
      <td>25.333333</td>
      <td>6.333333</td>
      <td>76.333333</td>
      <td>930.666667</td>
      <td>890.666667</td>
      <td>66.333333</td>
      <td>20.500000</td>
      <td>5.333333</td>
      <td>162.333333</td>
      <td>35.000000</td>
      <td>25.666667</td>
      <td>12.666667</td>
      <td>7.000000</td>
      <td>9.333333</td>
      <td>3.666667</td>
      <td>772.666667</td>
      <td>126.000000</td>
      <td>165.666667</td>
      <td>362.000000</td>
      <td>620.000000</td>
      <td>40.000000</td>
      <td>33.666667</td>
      <td>14.666667</td>
      <td>846.333333</td>
      <td>6.000000</td>
      <td>16.666667</td>
      <td>32.666667</td>
      <td>21.333333</td>
      <td>50.000000</td>
      <td>39.000000</td>
      <td>5.333333</td>
      <td>5.000000</td>
      <td>5.666667</td>
      <td>3.333333</td>
      <td>2.333333</td>
      <td>10.666667</td>
      <td>8.666667</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>1.333333</td>
      <td>0.666667</td>
      <td>31.333333</td>
      <td>19.666667</td>
      <td>17.666667</td>
      <td>16.000000</td>
      <td>6.000000</td>
      <td>15.000000</td>
      <td>39.000000</td>
      <td>71.400000</td>
      <td>27.000000</td>
      <td>259.333333</td>
      <td>79.333333</td>
      <td>45.566667</td>
      <td>125.000000</td>
      <td>123.666667</td>
      <td>75.666667</td>
      <td>29.333333</td>
      <td>11.666667</td>
      <td>1.333333</td>
      <td>21.000000</td>
      <td>31.666667</td>
      <td>57.666667</td>
      <td>2.333333</td>
      <td>78.333333</td>
      <td>1024.000000</td>
      <td>114.666667</td>
      <td>311.333333</td>
      <td>651.666667</td>
      <td>382.333333</td>
      <td>67.000000</td>
      <td>984.666667</td>
      <td>26.000000</td>
      <td>39.000000</td>
      <td>84.433333</td>
      <td>27.000000</td>
      <td>4.000000</td>
      <td>737.666667</td>
      <td>4209.000000</td>
      <td>2418.333333</td>
      <td>116.000000</td>
      <td>37.000000</td>
      <td>14.666667</td>
      <td>23.000000</td>
      <td>25.333333</td>
      <td>914.666667</td>
      <td>846.333333</td>
      <td>93.333333</td>
      <td>78.333333</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>22.333333</td>
      <td>22.000000</td>
      <td>6.666667</td>
      <td>25.666667</td>
      <td>31.666667</td>
      <td>19.666667</td>
      <td>1.000000</td>
      <td>1.500000</td>
      <td>1.000000</td>
      <td>126.666667</td>
      <td>43.000000</td>
      <td>45.333333</td>
      <td>72.166667</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="452">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dtreeviz.trees <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.api.types <span class="im">import</span> is_string_dtype, is_numeric_dtype, is_categorical_dtype</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.experimental <span class="im">import</span> enable_halving_search_cv  <span class="co"># noqa</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> HalvingRandomSearchCV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="train-valid-split" class="level4">
<h4 class="anchored" data-anchor-id="train-valid-split">Train / Valid split</h4>
<p>In this case valid is actually test as train will be split by fits into train and valid</p>
<div class="cell" data-execution_count="453">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>copy.copy(dfAll)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>sza<span class="op">=</span>np.shape(df)[<span class="dv">0</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>randAr<span class="op">=</span>np.random.randint(<span class="dv">0</span>,<span class="dv">100</span>, size<span class="op">=</span>sza)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> randAr<span class="op">&gt;=</span><span class="dv">15</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> df.season<span class="op">&lt;</span><span class="dv">2021</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>train_idx <span class="op">=</span> np.where( cond)[<span class="dv">0</span>]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>valid_idx <span class="op">=</span> np.where(<span class="op">~</span>cond)[<span class="dv">0</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> (<span class="bu">list</span>(train_idx),<span class="bu">list</span>(valid_idx))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>valid_idx.shape[<span class="dv">0</span>]<span class="op">/</span><span class="bu">len</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="453">
<pre><code>0.2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="454">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>want_binary<span class="op">=</span><span class="dv">0</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> want_binary<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">'Win_x'</span>]<span class="op">==</span><span class="st">'D'</span>,<span class="st">'Win_x'</span>]<span class="op">=</span><span class="st">'L'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-tabular-pandas-x-and-y-values" class="level4">
<h4 class="anchored" data-anchor-id="create-tabular-pandas-x-and-y-values">Create tabular pandas &amp; x and y values</h4>
<div class="cell" data-execution_count="455">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dep_var<span class="op">=</span><span class="st">'Win_x'</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cont,cat <span class="op">=</span> cont_cat_split(df, <span class="dv">1</span>, dep_var<span class="op">=</span>dep_var)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="455">
<pre><code>['opponent_x', 'team_x', 'opponent_y', 'team_y']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="456">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>procs <span class="op">=</span> [Categorify, FillMissing]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> TabularPandas(df, procs, cat, cont, y_names<span class="op">=</span>dep_var, splits<span class="op">=</span>splits)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>xs,y <span class="op">=</span> to.train.xs,to.train.y</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>valid_xs,valid_y <span class="op">=</span> to.valid.xs,to.valid.y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fit-the-data" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-data">Fit the data</h2>
<div class="cell" data-execution_count="457">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>clf<span class="op">=</span>RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>clf.fit(xs,y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="457">
<pre><code>RandomForestClassifier(random_state=42)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="458">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>clf.score(xs,y),clf.score(valid_xs,valid_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="458">
<pre><code>(1.0, 0.4921052631578947)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="459">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>clf.get_params()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="459">
<pre><code>{'bootstrap': True,
 'ccp_alpha': 0.0,
 'class_weight': None,
 'criterion': 'gini',
 'max_depth': None,
 'max_features': 'auto',
 'max_leaf_nodes': None,
 'max_samples': None,
 'min_impurity_decrease': 0.0,
 'min_samples_leaf': 1,
 'min_samples_split': 2,
 'min_weight_fraction_leaf': 0.0,
 'n_estimators': 100,
 'n_jobs': None,
 'oob_score': False,
 'random_state': 42,
 'verbose': 0,
 'warm_start': False}</code></pre>
</div>
</div>
<section id="improve-hyperparameters" class="level3">
<h3 class="anchored" data-anchor-id="improve-hyperparameters">Improve hyperparameters</h3>
<p><code>HalvingRandomSearchCV</code>, <code>RandomizedSearchCV</code> and <code>GridSearchCV</code> can be used to search for the best hyperparameters.</p>
<p>The random ones don’t go through all the options, but pick combinations randomly. So they will be quicker but may not get the best result. You may want to do the random ones to get a rough idea of parameters followed by grid search on a reduced range.</p>
<p>The most important arguments are - <code>cv</code> which is the number of folds to use for cross validation (we use the default values for <code>cv</code> of 5). - <code>factor</code> the halving parameter (2 is used) - (or <code>n_iter</code> for RandomizedSearchCV, which controls the number of different combinations to try)</p>
<p>More iterations or lower factor will cover a wider search space and more cv folds reduces the chances of overfitting, but raising each will increase the run time.</p>
<div class="cell" data-execution_count="460">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of trees in random forest</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n_estimators<span class="op">=</span>[<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">150</span>,<span class="dv">400</span>,<span class="dv">700</span>]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of features to consider at every split</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>max_features <span class="op">=</span> [<span class="st">'log2'</span>,<span class="st">'sqrt'</span>,<span class="va">None</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum number of levels in tree</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>max_depth<span class="op">=</span>[<span class="dv">10</span>,  <span class="dv">30</span>,  <span class="dv">70</span>,  <span class="dv">200</span>, <span class="va">None</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum number of samples required to split a node</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>min_samples_split <span class="op">=</span> [<span class="fl">1.</span>,<span class="dv">2</span>, <span class="dv">10</span>,<span class="dv">50</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum number of samples required at each leaf node</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>min_samples_leaf <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>,<span class="dv">10</span>]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Method of selecting samples for training each tree</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Weights associated with classes </span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>class_weight<span class="op">=</span>[<span class="st">"balanced"</span>, <span class="st">"balanced_subsample"</span>,<span class="va">None</span>]</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Complexity parameter used for Minimal Cost-Complexity Pruning.</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>ccp_alpha<span class="op">=</span>[<span class="fl">0.</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>]</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>random_grid <span class="op">=</span> {<span class="st">'n_estimators'</span>: n_estimators,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">'max_features'</span>: max_features,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">'max_depth'</span>: max_depth,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">'min_samples_split'</span>: min_samples_split,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">'min_samples_leaf'</span>: min_samples_leaf,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>               <span class="st">'bootstrap'</span>: bootstrap,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>               <span class="st">'class_weight'</span>:class_weight,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>               <span class="st">'ccp_alpha'</span> : ccp_alpha</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>rsh <span class="op">=</span> HalvingRandomSearchCV(estimator <span class="op">=</span> clf, param_distributions <span class="op">=</span> random_grid, <span class="op">\</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>                              random_state<span class="op">=</span><span class="dv">42</span>, factor <span class="op">=</span> <span class="dv">6</span>)<span class="co"># Fit the random search model</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>rsh.fit(xs, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="460">
<pre><code>HalvingRandomSearchCV(estimator=RandomForestClassifier(random_state=42),
                      factor=6,
                      param_distributions={'bootstrap': [True, False],
                                           'ccp_alpha': [0.0, 0.1, 0.5],
                                           'class_weight': ['balanced',
                                                            'balanced_subsample',
                                                            None],
                                           'max_depth': [10, 30, 70, 200, None],
                                           'max_features': ['log2', 'sqrt',
                                                            None],
                                           'min_samples_leaf': [1, 2, 4, 10],
                                           'min_samples_split': [1.0, 2, 10,
                                                                 50],
                                           'n_estimators': [20, 50, 150, 400,
                                                            700]},
                      random_state=42)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="461">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame(rsh.cv_results_)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>results[<span class="st">"params_str"</span>] <span class="op">=</span> results.params.<span class="bu">apply</span>(<span class="bu">str</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>results.drop_duplicates(subset<span class="op">=</span>(<span class="st">"params_str"</span>, <span class="st">"iter"</span>), inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>mean_scores <span class="op">=</span> results.pivot(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">"iter"</span>, columns<span class="op">=</span><span class="st">"params_str"</span>, values<span class="op">=</span><span class="st">"mean_test_score"</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> mean_scores.plot(legend<span class="op">=</span><span class="va">False</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"iter=</span><span class="sc">{</span>i<span class="sc">}</span><span class="ch">\n</span><span class="ss">n_samples=</span><span class="sc">{</span>rsh<span class="sc">.</span>n_resources_[i]<span class="sc">}</span><span class="ch">\n</span><span class="ss">n_candidates=</span><span class="sc">{</span>rsh<span class="sc">.</span>n_candidates_[i]<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rsh.n_iterations_)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(<span class="bu">range</span>(rsh.n_iterations_))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(labels, rotation<span class="op">=</span><span class="dv">45</span>, multialignment<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Scores of candidates over iterations"</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"mean test score"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"iterations"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-Copy2_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="466">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rsh.best_params_)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate(model, test_features, test_labels):</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    predictions <span class="op">=</span> model.predict(test_features)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    errors <span class="op">=</span> <span class="bu">abs</span>(predictions <span class="op">-</span> test_labels)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    mape <span class="op">=</span> <span class="dv">100</span> <span class="op">*</span> np.mean(errors <span class="op">/</span> test_labels)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> <span class="dv">100</span> <span class="op">-</span> mape</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Model Performance'</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Average Error: </span><span class="sc">{:0.4f}</span><span class="st"> degrees.'</span>.<span class="bu">format</span>(np.mean(errors)))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Accuracy = </span><span class="sc">{:0.2f}</span><span class="st">%.'</span>.<span class="bu">format</span>(accuracy))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> accuracy</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>best_random <span class="op">=</span> rsh.best_estimator_</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>mm <span class="op">=</span> best_random.predict(valid_xs)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(best_random.get_params())</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">The score for predictions on the 2021 season (not shown to training data) is:</span><span class="ch">\n\</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="st">      </span><span class="sc">{:.3f}</span><span class="ch">\n\</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="ch">\n</span><span class="st">The predictions for the training data is:</span><span class="ch">\n\</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="st">      </span><span class="sc">{:.3f}</span><span class="st">"</span>.<span class="bu">format</span>(best_random.score(valid_xs, valid_y),best_random.score(xs, y)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'n_estimators': 50, 'min_samples_split': 50, 'min_samples_leaf': 2, 'max_features': None, 'max_depth': None, 'class_weight': None, 'ccp_alpha': 0.0, 'bootstrap': True}
{'bootstrap': True, 'ccp_alpha': 0.0, 'class_weight': None, 'criterion': 'gini', 'max_depth': None, 'max_features': None, 'max_leaf_nodes': None, 'max_samples': None, 'min_impurity_decrease': 0.0, 'min_samples_leaf': 2, 'min_samples_split': 50, 'min_weight_fraction_leaf': 0.0, 'n_estimators': 50, 'n_jobs': None, 'oob_score': False, 'random_state': 42, 'verbose': 0, 'warm_start': False}

The score for predictions on the 2021 season (not shown to training data) is:
      0.532

The predictions for the training data is:
      0.853</code></pre>
</div>
</div>
</section>
</section>
<section id="look-at-the-predictions" class="level2">
<h2 class="anchored" data-anchor-id="look-at-the-predictions">Look at the predictions</h2>
<div class="cell" data-execution_count="467">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#clf rsh</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>pred<span class="op">=</span>clf.predict(xs)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pred_valid<span class="op">=</span>clf.predict(valid_xs)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># [(y[i],df['Win_x'].iloc[i]) for i in range(5)]</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>[(y[i],df[<span class="st">'Win_x'</span>].iloc[i],pred[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="467">
<pre><code>[(2, 'W', 2), (1, 'L', 1), (2, 'W', 2), (2, 'W', 2), (1, 'L', 1)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="468">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>plt.hist(pred[y<span class="op">==</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>,width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'left'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'-.'</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'b'</span>)<span class="co">#loss</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>plt.hist(pred[y<span class="op">==</span><span class="dv">0</span>],width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'mid'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'-'</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'r'</span>)<span class="co">#draw</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.hist(pred[y<span class="op">==</span><span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span>,width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'left'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'k'</span>)<span class="co">#win</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw=0</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Win=2</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loss=1</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Loss'</span>,<span class="st">'Draw'</span>,<span class="st">'Win'</span>])</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>pc_loss<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(y[y<span class="op">==</span><span class="dv">1</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>pc_win<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(y[y<span class="op">==</span><span class="dv">2</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>pc_draw<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(y[y<span class="op">==</span><span class="dv">0</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>pc_lossP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred[pred<span class="op">==</span><span class="dv">1</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>pc_winP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred[pred<span class="op">==</span><span class="dv">2</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>pc_drawP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred[pred<span class="op">==</span><span class="dv">0</span>])<span class="op">/</span><span class="bu">len</span>(pred))</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'win PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="ch">\n\</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="st">loss PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="ch">\n\</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="st">draw PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(pc_loss,pc_lossP,pc_win,pc_winP,pc_draw,pc_drawP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>win PC actual 33 pred 33
loss PC actual 44 pred 44
draw PC actual 22 pred 22</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-Copy2_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="469">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plt.hist(pred_valid[valid_y<span class="op">==</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span>,width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'left'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'-.'</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'b'</span>)<span class="co">#loss</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.hist(pred_valid[valid_y<span class="op">==</span><span class="dv">0</span>],width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'mid'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'-'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'r'</span>)<span class="co">#draw</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.hist(pred_valid[valid_y<span class="op">==</span><span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span>,width<span class="op">=</span><span class="fl">.1</span>,align<span class="op">=</span><span class="st">'left'</span>,linewidth<span class="op">=</span><span class="dv">2</span>,linestyle<span class="op">=</span><span class="st">'--'</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>         facecolor<span class="op">=</span><span class="st">'none'</span>,edgecolor<span class="op">=</span><span class="st">'k'</span>)<span class="co">#win</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw=0</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Win=2</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Loss=1</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Loss'</span>,<span class="st">'Draw'</span>,<span class="st">'Win'</span>])</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>pc_loss<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(valid_y[valid_y<span class="op">==</span><span class="dv">1</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>pc_win<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(valid_y[valid_y<span class="op">==</span><span class="dv">2</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>pc_draw<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(valid_y[valid_y<span class="op">==</span><span class="dv">0</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>pc_lossP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred_valid[pred_valid<span class="op">==</span><span class="dv">1</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>pc_winP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred_valid[pred_valid<span class="op">==</span><span class="dv">2</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>pc_drawP<span class="op">=</span><span class="bu">int</span>(<span class="dv">100</span><span class="op">*</span><span class="bu">len</span>(pred_valid[pred_valid<span class="op">==</span><span class="dv">0</span>])<span class="op">/</span><span class="bu">len</span>(pred_valid))</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'win PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="ch">\n\</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">loss PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="ch">\n\</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">draw PC actual </span><span class="sc">{}</span><span class="st"> pred </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(pc_loss,pc_lossP,pc_win,pc_winP,pc_draw,pc_drawP))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>win PC actual 33 pred 35
loss PC actual 42 pred 61
draw PC actual 23 pred 3</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-Copy2_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Model seems poor at predicting draws- none are predicted</p>
<p>And poor at losses- 50:50 on those</p>
<p>Because of this lets change the question to a binary one</p>
</section>
<section id="try-with-a-binary-question-does-the-team-win" class="level2">
<h2 class="anchored" data-anchor-id="try-with-a-binary-question-does-the-team-win">Try with a binary question: Does the team win?</h2>
<div class="cell" data-execution_count="470">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBClassifier</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="471">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>copy.copy(dfAll)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>df.drop(columns<span class="op">=</span>[<span class="st">'Unnamed: 0'</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.rename(columns<span class="op">=</span>{<span class="st">'Win_x'</span>:<span class="st">'Win'</span>})</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>colsextraX<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> df.columns <span class="cf">if</span>  x[<span class="op">-</span><span class="dv">2</span>:]<span class="op">!=</span><span class="st">'_y'</span>]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>colsextraY<span class="op">=</span>[x <span class="cf">for</span> x <span class="kw">in</span> df.columns <span class="cf">if</span>  x[<span class="op">-</span><span class="dv">2</span>:]<span class="op">!=</span><span class="st">'_x'</span>]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-hide</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>copy.copy(dfAll)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>df.drop(columns<span class="op">=</span>[<span class="st">'Unnamed: 0'</span>])</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.rename(columns<span class="op">=</span>{<span class="st">'Win_x'</span>:<span class="st">'Win'</span>})</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.loc[( ((df[<span class="st">'round'</span>]<span class="op">&gt;</span><span class="dv">1</span>) <span class="op">&amp;</span> (df[<span class="st">'season'</span>]<span class="op">==</span><span class="dv">2017</span>)) <span class="op">|</span> (df[<span class="st">'season'</span>]<span class="op">&gt;</span><span class="dv">2017</span>)  ) ]</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     df=df.loc[:,colsextra]</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>sza<span class="op">=</span>np.shape(df)[<span class="dv">0</span>]</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>randAr<span class="op">=</span>np.random.randint(<span class="dv">0</span>,<span class="dv">100</span>, size<span class="op">=</span>sza)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> randAr<span class="op">&gt;=</span><span class="dv">15</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> df.season<span class="op">&lt;</span><span class="dv">2021</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>train_idx <span class="op">=</span> np.where( cond)[<span class="dv">0</span>]</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>valid_idx <span class="op">=</span> np.where(<span class="op">~</span>cond)[<span class="dv">0</span>]</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> (<span class="bu">list</span>(train_idx),<span class="bu">list</span>(valid_idx))</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="co">#############</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>want_binary<span class="op">=</span><span class="dv">1</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> want_binary<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    df.loc[df[<span class="st">'Win'</span>]<span class="op">==</span><span class="st">'D'</span>,<span class="st">'Win'</span>]<span class="op">=</span><span class="st">'L'</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="co">##############</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>dep_var<span class="op">=</span><span class="st">'Win'</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>cont,cat <span class="op">=</span> cont_cat_split(df, <span class="dv">1</span>, dep_var<span class="op">=</span>dep_var)</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co">###############</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>procs <span class="op">=</span> [Categorify, FillMissing]</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> TabularPandas(df, procs, cat, cont, y_names<span class="op">=</span>dep_var, splits<span class="op">=</span>splits)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>xs,y <span class="op">=</span> to.train.xs,to.train.y</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>valid_xs,valid_y <span class="op">=</span> to.valid.xs,to.valid.y</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="475">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_RF():</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">##############</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    clf<span class="op">=</span>RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    clf.fit(xs,y)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># clf.score(xs,y),clf.score(valid_xs,valid_y)</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    pred_valid<span class="op">=</span>clf.predict(valid_xs)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    pred<span class="op">=</span>clf.predict(xs)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    ppred_valid<span class="op">=</span>clf.predict_proba(valid_xs)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    ppred<span class="op">=</span>clf.predict_proba(xs)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred,pred_valid,ppred,ppred_valid</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_XGB(n_estimators<span class="op">=</span><span class="dv">1000</span>, learning_rate<span class="op">=</span><span class="fl">0.0001</span>, n_jobs<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># !pip install xgboost</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the model</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    my_model_2 <span class="op">=</span> XGBClassifier(n_estimators<span class="op">=</span><span class="dv">1000</span>, learning_rate<span class="op">=</span><span class="fl">0.01</span>) <span class="co"># Your code here</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    my_model_2.fit(xs, y) </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get predictions</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    ppred <span class="op">=</span> my_model_2.predict_proba(xs)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    ppred_valid <span class="op">=</span> my_model_2.predict_proba(valid_xs)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> my_model_2.predict(xs)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    pred_valid <span class="op">=</span> my_model_2.predict(valid_xs)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred,pred_valid,ppred,ppred_valid </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_ridge():</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    my_model_2 <span class="op">=</span> Ridge(alpha<span class="op">=</span><span class="dv">21</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    my_model_2.fit(xs, y)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get predictions</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    ppred <span class="op">=</span> my_model_2.predict(xs)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    ppred_valid <span class="op">=</span> my_model_2.predict(valid_xs)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> my_model_2.predict(xs)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    pred_valid <span class="op">=</span> my_model_2.predict(valid_xs)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    pred[pred<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    pred[pred<span class="op">&lt;=</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    pred_valid[pred_valid<span class="op">&gt;</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    pred_valid[pred_valid<span class="op">&lt;=</span><span class="fl">0.5</span>]<span class="op">=</span><span class="dv">0</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred,pred_valid , ppred,ppred_valid</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>pred_RF,pred_valid_RF, ppred_RF,ppred_valid_RF  <span class="op">=</span> do_RF()</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>pred_XGB,pred_valid_XGB,ppred_XGB,ppred_valid_XGB <span class="op">=</span> do_XGB()</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>pred_rdg,pred_valid_rdg,ppred_rdg,ppred_valid_rdg <span class="op">=</span> do_ridge()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\44781\anaconda3\lib\site-packages\sklearn\linear_model\_ridge.py:157: LinAlgWarning: Ill-conditioned matrix (rcond=3.35191e-10): result may not be accurate.
  return linalg.solve(A, Xy, sym_pos=True, overwrite_a=True).T</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>10      0
11      0
12      1
13      0
14      1
       ..
1515    1
1516    1
1517    0
1518    0
1519    1
Name: Win, Length: 1510, dtype: int8</code></pre>
</div>
</div>
<div class="cell" data-execution_count="476">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pred_combo<span class="op">=</span>(ppred_valid_RF[:,<span class="dv">1</span>]<span class="op">+</span>ppred_valid_XGB[:,<span class="dv">1</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pred_combo[pred_combo<span class="op">&gt;=</span><span class="dv">1</span>]<span class="op">=</span><span class="dv">1</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>pred_combo[pred_combo<span class="op">&lt;</span><span class="dv">1</span>] <span class="op">=</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="477">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_scores(nom,predd, yy):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    prec<span class="op">=</span>precision_score(predd, np.array(yy)) </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    acc<span class="op">=</span>accuracy_score(predd, np.array(yy))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st">: accuracy = </span><span class="sc">{:.2f}</span><span class="st"> and precision = </span><span class="sc">{:.2f}</span><span class="st">"</span>.<span class="bu">format</span>(nom,acc,prec))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'RF train'</span>,pred_RF, y)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'RF valid'</span>,pred_valid_RF, valid_y)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-----'</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'XGB train'</span>,pred_XGB, y)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'XGB valid'</span>,pred_valid_XGB, valid_y)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-----'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'Ridge train'</span>,pred_rdg, y)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'Ridge valid'</span>,pred_valid_rdg, valid_y)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'-----'</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>get_scores(<span class="st">'Combined valid'</span>,pred_combo, valid_y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RF train: accuracy = 1.00 and precision = 1.00
RF valid: accuracy = 0.62 and precision = 0.40
-----
XGB train: accuracy = 1.00 and precision = 1.00
XGB valid: accuracy = 0.61 and precision = 0.36
-----
Ridge train: accuracy = 0.74 and precision = 0.68
Ridge valid: accuracy = 0.59 and precision = 0.44
-----
Combined valid: accuracy = 0.59 and precision = 0.33</code></pre>
</div>
</div>
</section>
<section id="try-reducing-the-predictors" class="level2">
<h2 class="anchored" data-anchor-id="try-reducing-the-predictors">Try reducing the predictors</h2>
<p>There is a lot of variance, do we need all the columns and what accuracy do we get with just a few basic ones?</p>
<div class="cell" data-execution_count="599">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">##hide</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021.csv'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>df_.iloc[<span class="dv">10</span>:,:]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>predictors<span class="op">=</span>[<span class="st">'day'</span>,<span class="st">'opponent_x'</span>,<span class="st">'team_x'</span>,<span class="st">'weekday'</span>]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">"opponent_x"</span>] <span class="op">=</span> df_[<span class="st">"opponent_x"</span>].astype(<span class="st">"category"</span>).cat.codes</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">"team_x"</span>] <span class="op">=</span> df_[<span class="st">"team_x"</span>].astype(<span class="st">"category"</span>).cat.codes</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dowin(string):</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> string<span class="op">==</span><span class="st">'W'</span>:</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">'Win_x'</span>]<span class="op">=</span>df_[<span class="st">'Win_x'</span>].<span class="bu">apply</span>(dowin)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>predictors.append(<span class="st">'Win_x'</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>predictors.append(<span class="st">'season'</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df_.copy()</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.loc[:,predictors]</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.dropna()</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> df.loc[df[<span class="st">"season"</span>] <span class="op">&lt;=</span> <span class="dv">2020</span>,:]</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> df.loc[df[<span class="st">"season"</span>] <span class="op">&gt;</span> <span class="dv">2020</span>,:]</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Length of training and test data: '</span>,<span class="bu">len</span>(train) , <span class="bu">len</span>(test))</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co"># RandomForestClassifie</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier()<span class="co">#n_estimators = 40, min_samples_split =10, random_state = 1)</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The predictors '</span>, predictors[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>predictors<span class="op">=</span>predictors[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>rf.fit(train[predictors], train[<span class="st">'Win_x'</span>])</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> rf.predict(test[predictors])</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> rf.predict(train[predictors])</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the training data"</span>.<span class="bu">format</span>(accuracy_score(train[<span class="st">'Win_x'</span>], pred_train),precision_score(train[<span class="st">'Win_x'</span>], pred_train) ) )</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="bu">format</span>(accuracy_score(test[<span class="st">'Win_x'</span>], pred),precision_score(test[<span class="st">'Win_x'</span>], pred) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Length of training and test data:  1510 380
The predictors  ['day', 'opponent_x', 'team_x', 'weekday']
The accuracy 0.996 and precision 0.997 of the training data
The accuracy 0.621 and precision 0.565 of the test data</code></pre>
</div>
</div>
<div class="cell" data-execution_count="489">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>matchesC<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscore.csv'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>matchesC.corr()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span>[ i <span class="cf">for</span> i,x <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns) <span class="cf">if</span> x<span class="op">==</span><span class="st">'NetScore_x'</span>][<span class="dv">0</span>]</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>corrnetscore<span class="op">=</span>X.iloc[:,val:val<span class="op">+</span><span class="dv">1</span>].sort_values(by<span class="op">=</span><span class="st">"NetScore_x"</span>).reset_index()</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>corrnetscore<span class="op">=</span>corrnetscore.rename(columns<span class="op">=</span>{<span class="st">'index'</span>:<span class="st">'category'</span>})</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>corrnetscore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="489">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>category</th>
      <th>NetScore_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NetScore_y</td>
      <td>-1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ground_y</td>
      <td>-0.264919</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cmp_passing.2_y</td>
      <td>-0.264773</td>
    </tr>
    <tr>
      <th>3</th>
      <td>cmp_passing_y</td>
      <td>-0.263268</td>
    </tr>
    <tr>
      <th>4</th>
      <td>rec_y</td>
      <td>-0.263268</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>336</th>
      <td>att_passing_x</td>
      <td>0.307719</td>
    </tr>
    <tr>
      <th>337</th>
      <td>carries_x</td>
      <td>0.307754</td>
    </tr>
    <tr>
      <th>338</th>
      <td>live_passing_types_x</td>
      <td>0.307866</td>
    </tr>
    <tr>
      <th>339</th>
      <td>mid 3rd_possession_x</td>
      <td>0.309859</td>
    </tr>
    <tr>
      <th>340</th>
      <td>NetScore_x</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>341 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="724">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Xuse<span class="op">=</span>corrnetscore.loc[[x   <span class="cf">for</span> x <span class="kw">in</span> corrnetscore.index <span class="cf">if</span> ( (corrnetscore.loc[x,<span class="st">'category'</span>][<span class="op">-</span><span class="dv">1</span>]<span class="op">==</span><span class="st">'x'</span>) <span class="op">&amp;</span> ( <span class="bu">abs</span>(corrnetscore.loc[x,<span class="st">'NetScore_x'</span>])<span class="op">&gt;</span><span class="fl">0.26</span>) )]]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Xuse<span class="op">=</span>corrnetscore.loc[[x   <span class="cf">for</span> x <span class="kw">in</span> corrnetscore.index <span class="cf">if</span> ( (corrnetscore.loc[x,<span class="st">'category'</span>][<span class="op">-</span><span class="dv">1</span>]<span class="op">==</span><span class="st">'y'</span>) <span class="op">&amp;</span> ( <span class="bu">abs</span>(corrnetscore.loc[x,<span class="st">'NetScore_x'</span>])<span class="op">&gt;</span><span class="fl">0.24</span>) )]]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Xuse<span class="op">=</span>corrnetscore.loc[[x   <span class="cf">for</span> x <span class="kw">in</span> corrnetscore.index <span class="cf">if</span> (  ( <span class="bu">abs</span>(corrnetscore.loc[x,<span class="st">'NetScore_x'</span>])<span class="op">&gt;</span><span class="fl">0.27</span>) )]]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Xuse<span class="op">=</span><span class="bu">list</span>(Xuse[<span class="op">-</span><span class="dv">20</span>:<span class="op">-</span><span class="dv">1</span>].category.values)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>Xuse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="724">
<pre><code>['att_passing.1_x',
 '1/3_passing_x',
 'prgdist_possession_x',
 'ground_x',
 'cmp_passing.2_x',
 'att_passing.2_x',
 'totdist_passing_x',
 'touches_x',
 'cmp_passing_types_x',
 'cmp_passing_x',
 'rec_x',
 'targ_x',
 'live_possession_x',
 'prog_possession_x',
 'att_passing_types_x',
 'att_passing_x',
 'carries_x',
 'live_passing_types_x',
 'mid 3rd_possession_x']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="848">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">##hide</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscore_both-HA.csv'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>df_.iloc[<span class="dv">10</span>:,:]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>predictors_<span class="op">=</span>[<span class="st">'round'</span>,<span class="st">'opponent_x'</span>,<span class="st">'team_x'</span>,<span class="st">'weekday'</span>]</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">"opponent_x"</span>] <span class="op">=</span> df_[<span class="st">"opponent_x"</span>].astype(<span class="st">"category"</span>).cat.codes</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">"team_x"</span>] <span class="op">=</span> df_[<span class="st">"team_x"</span>].astype(<span class="st">"category"</span>).cat.codes</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>df_[df_[<span class="st">'Win_x'</span>]<span class="op">!=</span><span class="st">'D'</span>]</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dowin(string):</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> string<span class="op">==</span><span class="st">'W'</span>:</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>df_[<span class="st">'Win_x'</span>]<span class="op">=</span>df_[<span class="st">'Win_x'</span>].<span class="bu">apply</span>(dowin)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>predictors<span class="op">=</span>Xuse.copy()</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>[predictors.append(x) <span class="cf">for</span> x <span class="kw">in</span> predictors_]</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>predictors.append(<span class="st">'season'</span>)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>predictors.append(<span class="st">'Win_x'</span>)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df_.copy()</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.loc[:,predictors]</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.dropna()</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> df.loc[df[<span class="st">"season"</span>] <span class="op">&lt;=</span> <span class="dv">2020</span>,:]</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> df.loc[df[<span class="st">"season"</span>] <span class="op">&gt;</span> <span class="dv">2020</span>,:]</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Length of training and test data: '</span>,<span class="bu">len</span>(train) , <span class="bu">len</span>(test))</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="co"># RandomForestClassifie</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier(n_estimators <span class="op">=</span> <span class="dv">200</span>, min_samples_split <span class="op">=</span><span class="dv">4</span>, random_state <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The predictors '</span>, predictors[<span class="dv">0</span>:<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>predictors<span class="op">=</span>predictors[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>rf.fit(train[predictors], train[<span class="st">'Win_x'</span>])</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> rf.predict(test[predictors])</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>pred_train <span class="op">=</span> rf.predict(train[predictors])</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the training data"</span>.<span class="op">\</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span>(accuracy_score(train[<span class="st">'Win_x'</span>], pred_train),precision_score(train[<span class="st">'Win_x'</span>], pred_train) ) )</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="op">\</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span>(accuracy_score(test[<span class="st">'Win_x'</span>], pred),precision_score(test[<span class="st">'Win_x'</span>], pred) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Length of training and test data:  2329 583
The predictors  ['att_passing.1_x', '1/3_passing_x', 'prgdist_possession_x', 'ground_x', 'cmp_passing.2_x', 'att_passing.2_x', 'totdist_passing_x', 'touches_x', 'cmp_passing_types_x', 'cmp_passing_x', 'rec_x', 'targ_x', 'live_possession_x', 'prog_possession_x', 'att_passing_types_x', 'att_passing_x', 'carries_x', 'live_passing_types_x', 'mid 3rd_possession_x', 'round', 'opponent_x', 'team_x', 'weekday']
The accuracy 1.000 and precision 1.000 of the training data
The accuracy 0.633 and precision 0.651 of the test data</code></pre>
</div>
</div>
<div class="cell" data-execution_count="708">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>combined <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(actual <span class="op">=</span> test[<span class="st">'Win_x'</span>], prediction <span class="op">=</span> pred ))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>crosstab<span class="op">=</span>pd.crosstab(index <span class="op">=</span> combined[<span class="st">"actual"</span>], columns <span class="op">=</span> combined[<span class="st">'prediction'</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>crosstab</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crosstab=np.array(crosstab)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # sum(crosstab.diagonal())/</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># crosstab,np.sum(crosstab),np.sum(crosstab, axis=1)</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # crosstab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="708">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>prediction</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>actual</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>180</td>
      <td>111</td>
    </tr>
    <tr>
      <th>1</th>
      <td>88</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="856">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df.groupby(columns=['season','round',])</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>dfnew<span class="op">=</span>df.copy()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>dfnew <span class="op">=</span> dfnew.loc[df[<span class="st">"season"</span>] <span class="op">&gt;</span> <span class="dv">2020</span>,:]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> team_combo_unq(inta1,inta2):</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    a2<span class="op">=</span>np.array([inta1,inta2])</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    a<span class="op">=</span>np.sort(a2)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    stra <span class="op">=</span> <span class="bu">str</span>(<span class="bu">int</span>(a[<span class="dv">0</span>]))<span class="op">+</span><span class="st">' '</span><span class="op">+</span> <span class="bu">str</span>(<span class="bu">int</span>(a[<span class="dv">1</span>]))</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stra </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> team_combo2(inta1,inta2):</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    a2<span class="op">=</span>np.array([inta1,inta2])</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    a<span class="op">=</span>np.sort(a2)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    stra <span class="op">=</span> <span class="bu">str</span>(<span class="bu">int</span>(a[<span class="dv">0</span>]))<span class="op">+</span><span class="st">' '</span><span class="op">+</span> <span class="bu">str</span>(<span class="bu">int</span>(a[<span class="dv">1</span>]))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> np.array_equal(a,a2):</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>  <span class="st">'te'</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>  <span class="st">'op'</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>team_combo_unq(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>dfnew[<span class="st">'team_unq'</span>]<span class="op">=</span>dfnew.<span class="bu">apply</span>(<span class="kw">lambda</span> x: team_combo_unq(x[<span class="st">'team_x'</span>],x[<span class="st">'opponent_x'</span>]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>dfnew[<span class="st">'team_opp'</span>]<span class="op">=</span>dfnew.<span class="bu">apply</span>(<span class="kw">lambda</span> x: team_combo2(x[<span class="st">'team_x'</span>],x[<span class="st">'opponent_x'</span>]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>pred__<span class="op">=</span>rf.predict_proba(dfnew[predictors])</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>pred__2<span class="op">=</span>rf.predict(dfnew[predictors])</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>dfnew[<span class="st">'pred'</span>]<span class="op">=</span> pred__[:,<span class="dv">1</span>]</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>dfnew[<span class="st">'predAct'</span>]<span class="op">=</span> pred__2</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'pred'</span>]<span class="op">=</span><span class="dv">1</span><span class="op">-</span>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'pred'</span>]</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'predAct'</span>]<span class="op">=</span><span class="dv">1</span><span class="op">-</span>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'predAct'</span>]</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'Win_x'</span>]<span class="op">=</span><span class="dv">1</span><span class="op">-</span>dfnew.loc[dfnew.team_opp<span class="op">==</span><span class="st">'op'</span>,<span class="st">'Win_x'</span>]</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="co"># a=np.array([1 ,3])</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="co"># a</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="857">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>dfnew[<span class="st">'Win_x'</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>dfnew[[<span class="st">'predAct'</span>]]</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="op">\</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span>(accuracy_score(A, B),precision_score(A, B) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The accuracy 0.633 and precision 0.647 of the test data</code></pre>
</div>
</div>
<div class="cell" data-execution_count="858">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>pred_df<span class="op">=</span>dfnew.loc[:,[<span class="st">'Win_x'</span>,<span class="st">'team_x'</span>,<span class="st">'season'</span>,<span class="st">'opponent_x'</span>,<span class="st">'round'</span>,<span class="st">'team_unq'</span>,<span class="st">'pred'</span>,<span class="st">'team_opp'</span>,<span class="st">'predAct'</span>]].groupby(by<span class="op">=</span>[<span class="st">'season'</span>,<span class="st">'round'</span>,<span class="st">'team_unq'</span>]).mean()</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bina(numa):</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> numa<span class="op">&lt;</span><span class="fl">0.5</span>:</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>pred_df[<span class="st">'pred_bin'</span>]<span class="op">=</span>pred_df[<span class="st">'pred'</span>].<span class="bu">apply</span>(bina)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>pred_df[<span class="st">'predAct'</span>]<span class="op">=</span>pred_df[<span class="st">'predAct'</span>].<span class="bu">apply</span>(bina)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.array(pred_df[<span class="st">'Win_x'</span>])</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>pred_df[<span class="st">'pred_bin'</span>]</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="op">\</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span>(accuracy_score(A, B),precision_score(A, B) ) )</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>pred_df[<span class="st">'Win_x'</span>]</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>np.array(pred_df[[<span class="st">'predAct'</span>]])</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="op">\</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="bu">format</span>(accuracy_score(A, B),precision_score(A, B) ) )</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>pred_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The accuracy 0.647 and precision 0.671 of the test data
The accuracy 0.651 and precision 0.619 of the test data</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="858">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>Win_x</th>
      <th>team_x</th>
      <th>opponent_x</th>
      <th>pred</th>
      <th>predAct</th>
      <th>pred_bin</th>
    </tr>
    <tr>
      <th>season</th>
      <th>round</th>
      <th>team_unq</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="11" valign="top">2021</th>
      <th rowspan="5" valign="top">1</th>
      <th>0 3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.614917</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1 24</th>
      <td>0.0</td>
      <td>12.5</td>
      <td>12.5</td>
      <td>0.483089</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12 16</th>
      <td>0.0</td>
      <td>14.0</td>
      <td>14.0</td>
      <td>0.364101</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13 27</th>
      <td>1.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>0.492810</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14 18</th>
      <td>1.0</td>
      <td>16.0</td>
      <td>16.0</td>
      <td>0.712417</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">38</th>
      <th>3 12</th>
      <td>0.0</td>
      <td>7.5</td>
      <td>7.5</td>
      <td>0.535958</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4 26</th>
      <td>1.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>0.490208</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5 17</th>
      <td>0.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>0.536071</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7 24</th>
      <td>1.0</td>
      <td>15.5</td>
      <td>15.5</td>
      <td>0.604250</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8 16</th>
      <td>1.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>0.431250</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>292 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="833">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dfnew[['Win_x','team_x','season','opponent_x','round','team_unq','pred','team_opp','predAct']]</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>accuracy_score(np.array(dfnew[[<span class="st">'predAct'</span>]]), dfnew[[<span class="st">'Win_x'</span>]] ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="833">
<pre><code>0.501717032967033</code></pre>
</div>
</div>
<div class="cell" data-execution_count="669">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscore_both-HA.csv'</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_<span class="op">=</span>df_.iloc[<span class="dv">10</span>:,:]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(df_.loc[df_.Win_x<span class="op">==</span><span class="st">'W'</span>]),<span class="bu">len</span>(df_.loc[df_.Win_x<span class="op">==</span><span class="st">'L'</span>]) )</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>df_[[<span class="st">'team_x'</span>,<span class="st">'team_y'</span>,<span class="st">'round'</span>,<span class="st">'Win_x'</span>]].iloc[<span class="dv">0</span>:<span class="dv">11</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1461 1464</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="669">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>team_x</th>
      <th>team_y</th>
      <th>round</th>
      <th>Win_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Crystal Palace</td>
      <td>Huddersfield Town</td>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Bournemouth</td>
      <td>West Bromwich Albion</td>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>12</th>
      <td>West Ham United</td>
      <td>Manchester United</td>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Watford</td>
      <td>Liverpool</td>
      <td>1</td>
      <td>D</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Brighton and Hove Albion</td>
      <td>Manchester City</td>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Huddersfield Town</td>
      <td>Crystal Palace</td>
      <td>1</td>
      <td>W</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Southampton</td>
      <td>Swansea City</td>
      <td>1</td>
      <td>D</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Swansea City</td>
      <td>Southampton</td>
      <td>1</td>
      <td>D</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Stoke City</td>
      <td>Everton</td>
      <td>1</td>
      <td>L</td>
    </tr>
    <tr>
      <th>19</th>
      <td>West Bromwich Albion</td>
      <td>Bournemouth</td>
      <td>1</td>
      <td>W</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Manchester City</td>
      <td>Everton</td>
      <td>2</td>
      <td>D</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="706">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_feat_importance(m, df):</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">'cols'</span>:df.columns, <span class="st">'imp'</span>:m.feature_importances_}</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                       ).sort_values(<span class="st">'imp'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pred=rf.predict(train)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_valid=best_random.predict(valid_xs)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>fi <span class="op">=</span> rf_feat_importance(rf, train[predictors])</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_fi(fi):</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fi.plot(<span class="st">'cols'</span>, <span class="st">'imp'</span>, <span class="st">'barh'</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">25</span>), legend<span class="op">=</span><span class="va">False</span>,fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>plot_fi(fi[:<span class="dv">50</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-Copy2_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="548">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#collapse-output</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>predictors2<span class="op">=</span>predictors.copy()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>predictors2.append(<span class="st">'season'</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>predictors2.append(<span class="st">'Win_x'</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>dfAll<span class="op">=</span>pd.read_csv(folda<span class="op">+</span><span class="st">'epl2017-2021_wivnetscore.csv'</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>dfAll<span class="op">=</span>dfAll.loc[<span class="dv">10</span>:,predictors2]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>dfAll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="548">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>att_passing.2_x</th>
      <th>totdist_passing_x</th>
      <th>touches_x</th>
      <th>cmp_passing_types_x</th>
      <th>cmp_passing_x</th>
      <th>rec_x</th>
      <th>targ_x</th>
      <th>live_possession_x</th>
      <th>prog_possession_x</th>
      <th>att_passing_types_x</th>
      <th>att_passing_x</th>
      <th>carries_x</th>
      <th>live_passing_types_x</th>
      <th>mid 3rd_possession_x</th>
      <th>day</th>
      <th>opponent_x</th>
      <th>team_x</th>
      <th>weekday</th>
      <th>season</th>
      <th>Win_x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>346.000000</td>
      <td>13422.000000</td>
      <td>902.000000</td>
      <td>712.000000</td>
      <td>712.000000</td>
      <td>712.000000</td>
      <td>794.000000</td>
      <td>858.000000</td>
      <td>91.000000</td>
      <td>808.000000</td>
      <td>808.000000</td>
      <td>646.000000</td>
      <td>766.000000</td>
      <td>484.000000</td>
      <td>21</td>
      <td>Everton</td>
      <td>Manchester City</td>
      <td>0</td>
      <td>2017</td>
      <td>D</td>
    </tr>
    <tr>
      <th>11</th>
      <td>330.000000</td>
      <td>12334.000000</td>
      <td>870.000000</td>
      <td>665.000000</td>
      <td>665.000000</td>
      <td>665.000000</td>
      <td>747.000000</td>
      <td>823.000000</td>
      <td>72.000000</td>
      <td>757.000000</td>
      <td>757.000000</td>
      <td>598.000000</td>
      <td>710.000000</td>
      <td>420.000000</td>
      <td>20</td>
      <td>Chelsea</td>
      <td>Tottenham Hotspur</td>
      <td>6</td>
      <td>2017</td>
      <td>L</td>
    </tr>
    <tr>
      <th>12</th>
      <td>218.000000</td>
      <td>8070.000000</td>
      <td>658.000000</td>
      <td>388.000000</td>
      <td>388.000000</td>
      <td>388.000000</td>
      <td>505.000000</td>
      <td>603.000000</td>
      <td>35.000000</td>
      <td>515.000000</td>
      <td>515.000000</td>
      <td>349.000000</td>
      <td>458.000000</td>
      <td>323.000000</td>
      <td>19</td>
      <td>Crystal Palace</td>
      <td>Liverpool</td>
      <td>5</td>
      <td>2017</td>
      <td>W</td>
    </tr>
    <tr>
      <th>13</th>
      <td>135.000000</td>
      <td>6011.000000</td>
      <td>469.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>251.000000</td>
      <td>322.000000</td>
      <td>428.000000</td>
      <td>16.000000</td>
      <td>331.000000</td>
      <td>331.000000</td>
      <td>259.000000</td>
      <td>289.000000</td>
      <td>232.000000</td>
      <td>19</td>
      <td>West Bromwich Albion</td>
      <td>Burnley</td>
      <td>5</td>
      <td>2017</td>
      <td>L</td>
    </tr>
    <tr>
      <th>14</th>
      <td>79.000000</td>
      <td>4126.000000</td>
      <td>435.000000</td>
      <td>181.000000</td>
      <td>181.000000</td>
      <td>181.000000</td>
      <td>284.000000</td>
      <td>370.000000</td>
      <td>22.000000</td>
      <td>299.000000</td>
      <td>299.000000</td>
      <td>202.000000</td>
      <td>232.000000</td>
      <td>169.000000</td>
      <td>19</td>
      <td>Brighton and Hove Albion</td>
      <td>Leicester City</td>
      <td>5</td>
      <td>2017</td>
      <td>W</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1895</th>
      <td>167.000000</td>
      <td>7080.666667</td>
      <td>572.666667</td>
      <td>353.666667</td>
      <td>353.666667</td>
      <td>353.666667</td>
      <td>428.333333</td>
      <td>529.666667</td>
      <td>42.000000</td>
      <td>453.000000</td>
      <td>453.000000</td>
      <td>327.333333</td>
      <td>410.000000</td>
      <td>236.000000</td>
      <td>22</td>
      <td>West Ham United</td>
      <td>Brighton and Hove Albion</td>
      <td>6</td>
      <td>2021</td>
      <td>W</td>
    </tr>
    <tr>
      <th>1896</th>
      <td>233.000000</td>
      <td>9669.333333</td>
      <td>672.000000</td>
      <td>457.666667</td>
      <td>457.666667</td>
      <td>457.666667</td>
      <td>512.333333</td>
      <td>622.666667</td>
      <td>36.333333</td>
      <td>556.000000</td>
      <td>556.000000</td>
      <td>462.666667</td>
      <td>505.000000</td>
      <td>295.333333</td>
      <td>22</td>
      <td>Manchester United</td>
      <td>Crystal Palace</td>
      <td>6</td>
      <td>2021</td>
      <td>W</td>
    </tr>
    <tr>
      <th>1897</th>
      <td>171.000000</td>
      <td>7650.000000</td>
      <td>552.666667</td>
      <td>359.000000</td>
      <td>359.000000</td>
      <td>359.000000</td>
      <td>413.666667</td>
      <td>510.333333</td>
      <td>39.666667</td>
      <td>457.000000</td>
      <td>457.000000</td>
      <td>333.666667</td>
      <td>415.000000</td>
      <td>220.666667</td>
      <td>22</td>
      <td>Leeds United</td>
      <td>Brentford</td>
      <td>6</td>
      <td>2021</td>
      <td>L</td>
    </tr>
    <tr>
      <th>1898</th>
      <td>148.666667</td>
      <td>6493.333333</td>
      <td>524.333333</td>
      <td>295.666667</td>
      <td>295.666667</td>
      <td>295.666667</td>
      <td>362.333333</td>
      <td>478.333333</td>
      <td>30.333333</td>
      <td>407.333333</td>
      <td>407.333333</td>
      <td>310.333333</td>
      <td>360.000000</td>
      <td>259.333333</td>
      <td>22</td>
      <td>Newcastle United</td>
      <td>Burnley</td>
      <td>6</td>
      <td>2021</td>
      <td>L</td>
    </tr>
    <tr>
      <th>1899</th>
      <td>165.666667</td>
      <td>6556.000000</td>
      <td>534.333333</td>
      <td>344.666667</td>
      <td>344.666667</td>
      <td>344.666667</td>
      <td>401.000000</td>
      <td>487.333333</td>
      <td>37.333333</td>
      <td>429.666667</td>
      <td>429.666667</td>
      <td>316.000000</td>
      <td>381.333333</td>
      <td>214.666667</td>
      <td>22</td>
      <td>Tottenham Hotspur</td>
      <td>Norwich City</td>
      <td>6</td>
      <td>2021</td>
      <td>L</td>
    </tr>
  </tbody>
</table>
<p>1890 rows × 20 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="581">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>copy.copy(dfAll)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    df<span class="op">=</span>df.drop(columns<span class="op">=</span>[<span class="st">'Unnamed: 0'</span>])</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.rename(columns<span class="op">=</span>{<span class="st">'Win_x'</span>:<span class="st">'Win'</span>})</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dowin(string):</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> string<span class="op">==</span><span class="st">'W'</span>:</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Win'</span>]<span class="op">=</span>df[<span class="st">'Win'</span>].<span class="bu">apply</span>(dowin)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>sza<span class="op">=</span>np.shape(df)[<span class="dv">0</span>]</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>randAr<span class="op">=</span>np.random.randint(<span class="dv">0</span>,<span class="dv">100</span>, size<span class="op">=</span>sza)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> randAr<span class="op">&gt;=</span><span class="dv">15</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> df.season<span class="op">&lt;</span><span class="dv">2021</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>train_idx <span class="op">=</span> np.where( cond)[<span class="dv">0</span>]</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>valid_idx <span class="op">=</span> np.where(<span class="op">~</span>cond)[<span class="dv">0</span>]</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>splits <span class="op">=</span> (<span class="bu">list</span>(train_idx),<span class="bu">list</span>(valid_idx))</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co">##############</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>dep_var<span class="op">=</span><span class="st">'Win'</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>cont,cat <span class="op">=</span> cont_cat_split(df, <span class="dv">1</span>, dep_var<span class="op">=</span>dep_var)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="co">###############</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>procs <span class="op">=</span> [Categorify, FillMissing]</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> TabularPandas(df, procs, cat, cont, y_names<span class="op">=</span>dep_var, splits<span class="op">=</span>splits)</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>xs,y <span class="op">=</span> to.train.xs,to.train.y</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>valid_xs,valid_y <span class="op">=</span> to.valid.xs,to.valid.y</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="536">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestRegressor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="592">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> do_RF(xs,y,valid_xs):</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">##############</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    clf<span class="op">=</span>RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    clf.fit(xs,y)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># clf.score(xs,y),clf.score(valid_xs,valid_y)</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    pred_valid<span class="op">=</span>clf.predict(valid_xs)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    pred<span class="op">=</span>clf.predict(xs)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     ppred_valid=clf.predict_proba(valid_xs)</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     ppred=clf.predict_proba(xs)</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred,pred_valid,clf<span class="co">#,ppred,ppred_valid</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>pred,pred_val,clf<span class="op">=</span>do_RF(xs,y,valid_xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="595">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># new_preds,new_y=get_reg_scores(valid_y,pred_val,.5)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the train data"</span>.<span class="bu">format</span>(<span class="op">\</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  accuracy_score(y, pred),precision_score(y, pred) ) )</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The accuracy </span><span class="sc">{:.3f}</span><span class="st"> and precision </span><span class="sc">{:.3f}</span><span class="st"> of the test data"</span>.<span class="bu">format</span>(<span class="op">\</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  accuracy_score(valid_y, pred_val),precision_score(valid_y, pred_val) ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The accuracy 1.000 and precision 1.000 of the train data
The accuracy 0.637 and precision 0.662 of the test data</code></pre>
</div>
</div>
<div class="cell" data-execution_count="598">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>combined <span class="op">=</span> pd.DataFrame(<span class="bu">dict</span>(actual <span class="op">=</span> valid_y, prediction <span class="op">=</span> pred_val ))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>crosstab<span class="op">=</span>pd.crosstab(index <span class="op">=</span> combined[<span class="st">"actual"</span>], columns <span class="op">=</span> combined[<span class="st">'prediction'</span>])</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>crosstab</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crosstab=np.array(crosstab)</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sum(crosstab.diagonal())/sum(sum(crosstab))</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # crosstab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="598">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>prediction</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>actual</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>191</td>
      <td>26</td>
    </tr>
    <tr>
      <th>1</th>
      <td>112</td>
      <td>51</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="556">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rf_feat_importance(m, df):</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">'cols'</span>:df.columns, <span class="st">'imp'</span>:m.feature_importances_}</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                       ).sort_values(<span class="st">'imp'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pred=rf.predict(train)</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_valid=best_random.predict(valid_xs)</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>fi <span class="op">=</span> rf_feat_importance(clf, xs)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_fi(fi):</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fi.plot(<span class="st">'cols'</span>, <span class="st">'imp'</span>, <span class="st">'barh'</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">25</span>), legend<span class="op">=</span><span class="va">False</span>,fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>plot_fi(fi[:<span class="dv">50</span>])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-11-PredictingPremierLeagueMatches-Copy2_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>