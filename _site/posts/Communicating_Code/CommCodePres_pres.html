<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas H. Simm">

<title>ThomasHSimm - Communicating code: Presentations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//posts/Picture3.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ThomasHSimm</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ThomasHSimm"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?hl=en&amp;user=HdPDn1sAAAAJ"><i class="bi bi-mortarboard-fill" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#content" id="toc-content" class="nav-link active" data-scroll-target="#content">Content</a></li>
  <li><a href="#quarto-presentations" id="toc-quarto-presentations" class="nav-link" data-scroll-target="#quarto-presentations">Quarto Presentations</a></li>
  <li><a href="#quarto-powerpoint-overview" id="toc-quarto-powerpoint-overview" class="nav-link" data-scroll-target="#quarto-powerpoint-overview">Quarto PowerPoint overview</a>
  <ul class="collapse">
  <li><a href="#creating-the-template" id="toc-creating-the-template" class="nav-link" data-scroll-target="#creating-the-template">Creating the template</a></li>
  <li><a href="#load-the-template" id="toc-load-the-template" class="nav-link" data-scroll-target="#load-the-template">Load the template</a></li>
  <li><a href="#check-the-slides" id="toc-check-the-slides" class="nav-link" data-scroll-target="#check-the-slides">Check the slides</a></li>
  </ul></li>
  <li><a href="#quarto-html-overview" id="toc-quarto-html-overview" class="nav-link" data-scroll-target="#quarto-html-overview">Quarto HTML overview</a>
  <ul class="collapse">
  <li><a href="#adding-style-to-revealjs" id="toc-adding-style-to-revealjs" class="nav-link" data-scroll-target="#adding-style-to-revealjs">Adding style to revealjs</a></li>
  <li><a href="#what-the-revealjs-file-looks-like" id="toc-what-the-revealjs-file-looks-like" class="nav-link" data-scroll-target="#what-the-revealjs-file-looks-like">What the revealjs file looks like</a></li>
  </ul></li>
  <li><a href="#streamlit-presentations" id="toc-streamlit-presentations" class="nav-link" data-scroll-target="#streamlit-presentations">Streamlit Presentations</a>
  <ul class="collapse">
  <li><a href="#streamlit-functionality-overview" id="toc-streamlit-functionality-overview" class="nav-link" data-scroll-target="#streamlit-functionality-overview">Streamlit Functionality: overview</a></li>
  <li><a href="#streamlit-functionality-streamlit_layout" id="toc-streamlit-functionality-streamlit_layout" class="nav-link" data-scroll-target="#streamlit-functionality-streamlit_layout">Streamlit Functionality: streamlit_layout</a></li>
  <li><a href="#streamlit-functionality-columns-and-sidebar" id="toc-streamlit-functionality-columns-and-sidebar" class="nav-link" data-scroll-target="#streamlit-functionality-columns-and-sidebar">Streamlit Functionality: columns and sidebar</a></li>
  <li><a href="#streamlit-functionality-html" id="toc-streamlit-functionality-html" class="nav-link" data-scroll-target="#streamlit-functionality-html">Streamlit Functionality: html</a></li>
  <li><a href="#streamlit-functionality-html-examples" id="toc-streamlit-functionality-html-examples" class="nav-link" data-scroll-target="#streamlit-functionality-html-examples">Streamlit Functionality: html examples</a></li>
  <li><a href="#streamlit-functionality-echo" id="toc-streamlit-functionality-echo" class="nav-link" data-scroll-target="#streamlit-functionality-echo">Streamlit Functionality: echo</a></li>
  <li><a href="#streamlit-functionality-pages" id="toc-streamlit-functionality-pages" class="nav-link" data-scroll-target="#streamlit-functionality-pages">Streamlit Functionality: pages</a></li>
  <li><a href="#example-streamlit-presentation" id="toc-example-streamlit-presentation" class="nav-link" data-scroll-target="#example-streamlit-presentation">Example Streamlit Presentation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Communicating code: Presentations</h1>
<p class="subtitle lead">Using notebooks and streamlit for presentations</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas H. Simm </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>
<p><img src="../../posts/header2.png" height="200"></p>
<section id="content" class="level2">
<h2 class="anchored" data-anchor-id="content">Content</h2>
<ul>
<li>Quarto
<ul>
<li>powerpoint <a href="https://quarto.org/docs/presentations/">https://quarto.org/docs/presentations/</a></li>
<li>html</li>
</ul></li>
<li>Jupyter books</li>
<li>Streamlit</li>
</ul>
</section>
<section id="quarto-presentations" class="level1">
<h1>Quarto Presentations</h1>
<p>Quarto supports a variety of formats for creating presentations, including:</p>
<pre><code>revealjs — reveal.js (HTML)

pptx — PowerPoint (MS Office)

beamer — Beamer (LaTeX/PDF)</code></pre>
<p>I’ll consider the first two</p>
</section>
<section id="quarto-powerpoint-overview" class="level1">
<h1>Quarto PowerPoint overview</h1>
<p>The steps to make a PowerPoint presentation from a notebook:</p>
<ol type="1">
<li>Create the inbuilt template.pptx file</li>
<li>Adjust it to match your own template</li>
<li>At the top of the notebook insert <code>format</code> for <code>pptx</code> including the template file</li>
<li>Choose how you will define a new page</li>
<li>You will probably need to manually check the slides and adjust as required
<ul>
<li>especially for interactive content and code</li>
</ul></li>
</ol>
<section id="creating-the-template" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-template">Creating the template</h2>
<p><em>(Office info correct for Office 365 Feb 2023, Version 2301 Build 16.0.16026.20002)</em></p>
<p>If your workplace has a custom template or you have one you always use, you can incorporate this into quarto.</p>
<p>However, quarto is quite specific on the form this template takes, and requires the following elements - Title Slide - Title and Content - Section Header - Two Content - Comparison - Content with Caption - Blank</p>
<p>By selecting Layout from the Home tab in powerpoint the different layouts can be seen</p>
<p><img src="ghtop_images/ppt_layout.png" class="img-fluid"></p>
<p>They can then be modified by going to View tab - Slide Master.</p>
<p>If using your own template you will need to match the names of the slides given above. These can be found by hovering over the slides on the left or right clicking on one and selecting “Rename Layout”</p>
<p><img src="ghtop_images/ppt_master.png" class="img-fluid"></p>
<p>Alternatively, create a custom template using quarto and then modify this. The following command creates the template:</p>
<p><code>quarto pandoc -o template.pptx --print-default-data-file reference.pptx</code></p>
<p>Then go to View tab - Slide Master and modify each slide layout.</p>
<p>Note if you are trying to match a template, some tips: - go to Design -&gt; Slide Size and match this to your template - when View tab - Slide Master is selected go to first tab (see above it will be left indented) on one you are copying from and select all on this then paste to the new template - these will be background images and other things that want to be passed to all slides - Check other slides for images and font-styles etc to match to the new template</p>
</section>
<section id="load-the-template" class="level2">
<h2 class="anchored" data-anchor-id="load-the-template">Load the template</h2>
<p>To load the template the first cell in the notebook needs to be modified as follows to reference the <code>template.pptx</code> file.</p>
<pre><code>format:
  pptx:
    reference-doc: template.pptx
    slide-level: 2</code></pre>
<p>In addition, we can also specify here the rule by which a new slide is defined. If <code>slide-level: 2</code> is used a new slide is defined by “##’ and a new section header by ‘#’. So if we used ‘###’ this would be a heading within the slide.</p>
<p>If <code>slide-level: 1</code> is used a new slide is defined by “#’ and ‘##’ this would be a heading within the slide (this is normally the default).</p>
</section>
<section id="check-the-slides" class="level2">
<h2 class="anchored" data-anchor-id="check-the-slides">Check the slides</h2>
<p>I have found creation of slides to powerpoint more prone to strange results than if .doc/.pdf/.html are used.</p>
<p>So check the slides, see if interactive content or code has been included (probably not) and if the slide content goes outside the slide.</p>
<p><img src="ghtop_images/ppt_eg.png" class="img-fluid"></p>
<p>In the example above - There is overlap of text on a slide - Strange ouput of a slide - Code output not displayed</p>
</section>
</section>
<section id="quarto-html-overview" class="level1">
<h1>Quarto HTML overview</h1>
<p>With quarto two different html formats can be produced by using either <code>html</code> or <code>revealjs</code>.</p>
<p>Whereas, <code>html</code> produces the standard html format <code>revealjs</code> produces an interactive presentation format. <a href="https://quarto.org/docs/presentations/revealjs/">https://quarto.org/docs/presentations/revealjs/</a></p>
<p><code>revealjs</code> does pretty much the same as a powerpoint file but is more robust - interactive content is included - less issues with getting format to fit within the slide</p>
<p>But - Can’t use the ppt template - And maybe(?) there are issues with sharing this format? - Interactive elements not as well implemeneted as within <em>pure</em> html</p>
<section id="adding-style-to-revealjs" class="level2">
<h2 class="anchored" data-anchor-id="adding-style-to-revealjs">Adding style to revealjs</h2>
<p>A simple way to add template like details to a <code>revealjs</code> file is to add a style.css sheet.</p>
<p>In the example below, the style sheet adds logo.png to the bottom right of each sheet</p>
<p>The file <code>style.css</code> looks like this:</p>
<pre><code>.reveal .slide-logo {
  display: block;
  position: fixed;
  top: unset !important;
  left: unset !important;
  bottom: 50px;
  right: 12px;
  height: 100px !important;
  width: 100x !important;
  max-width: unset !important;
  max-height: unset !important;
}</code></pre>
<p>And the <code>revealjs</code> part at the top of the jupyter notebook looks like this</p>
<pre><code>revealjs:
    slide-number: true
    height: 1080
    width: 1920
    logo: logo.png
    css: style.css</code></pre>
<p>So this would then look like the following, with the logo (<code>logo.png</code>) in the bottom right, and size and positioning given by the css file</p>
<p><img src="ghtop_images/ppt_revealstyle.png" class="img-fluid"></p>
</section>
<section id="what-the-revealjs-file-looks-like" class="level2">
<h2 class="anchored" data-anchor-id="what-the-revealjs-file-looks-like">What the revealjs file looks like</h2>
<p><video src="ghtop_images/revealjs.mp4" class="img-fluid" controls=""><a href="ghtop_images/revealjs.mp4">Video</a></video></p>
</section>
</section>
<section id="streamlit-presentations" class="level1">
<h1>Streamlit Presentations</h1>
<blockquote class="blockquote">
<p>Streamlit is an open-source Python library that makes it easy to create and share beautiful, custom web apps for machine learning and data science. In just a few minutes you can build and deploy powerful data apps. So let’s get started!</p>
</blockquote>
<p>Principally used to create apps, but some of the functionality works well for code/data presentations</p>
<section id="streamlit-functionality-overview" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-overview">Streamlit Functionality: overview</h2>
<p>Streamlit allows various <a href="https://docs.streamlit.io/library/api-reference">functionality</a>:</p>
<ul>
<li>textbox</li>
<li>images/videos</li>
<li>charts/tables</li>
<li>menus/buttons</li>
<li>etc</li>
</ul>
<p><img src="ghtop_images/streamlit_API.png" class="img-fluid"></p>
</section>
<section id="streamlit-functionality-streamlit_layout" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-streamlit_layout">Streamlit Functionality: streamlit_layout</h2>
<p>But unlike some apps (am thinking MATLAB GUIs) you can’t create the look and functionality separately. So if you want something in a certain position it can be tricky. HTML can be used with <code>st.markdown</code> to give more control but it isn’t recommended to use by streamlit.</p>
<p>Instead, to create the layout as you would like they have the following features:</p>
<p><img src="ghtop_images/streamlit_layout.png" class="img-fluid"></p>
</section>
<section id="streamlit-functionality-columns-and-sidebar" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-columns-and-sidebar">Streamlit Functionality: columns and sidebar</h2>
<p>The most useable are the first two: columns and sidebar</p>
<p>Columns allows us to split the app vertically. The code is fairly simple:</p>
<p>Either <code>colL, colM, colR = st.columns(3)</code> for 3 equal columns or to split columns with different sizes:</p>
<pre><code>colL, _, colR = st.columns((10, 5, 20))
with colL:
    st.write('On the left')
with colR:
    st.write('On the right twice as big as left')</code></pre>
<p><code>st.sidebar</code> just adds a sidebar to the app that can be hidden or shown.</p>
<p>Anything in the sidebar is just prefixed by <code>st.sidebar</code> so:</p>
<pre><code>st.sidebar.write('I am in the sidebar')
st.write('I am in the main app')
st.sidebar.write('I am back in the sidebar')</code></pre>
</section>
<section id="streamlit-functionality-html" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-html">Streamlit Functionality: html</h2>
<p>It is possible to add various additional personalisations using html. BUT it does come with security risks and so is [not recommended]](https://github.com/streamlit/streamlit/issues/152)</p>
<p><img src="ghtop_images/streamlit_html.png" class="img-fluid"></p>
<p>But it does allow much more control over the layout of the app that can be useful for a presentation: - Can add a background image - Can add background color to a textbox - Control over positioning of widgets - lots more</p>
<p>HTML is implementated using <code>st.markdown</code> with <code>unsafe_allow_html=True</code> inside the former</p>
</section>
<section id="streamlit-functionality-html-examples" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-html-examples">Streamlit Functionality: html examples</h2>
<p>add background to a text box</p>
<pre><code>text = "Code Examples"
        st.markdown(f'&lt;center&gt;&lt;p style=font-family:"Calibri";background-color:#FFFFFF;color:#000000;font-size:42px;border-radius:10%&gt;&lt;b&gt;{text}&lt;/b&gt;&lt;/p&gt;&lt;/center&gt;', unsafe_allow_html=True)
</code></pre>
<p>Or to add a background image</p>
<pre><code>import streamlit as st
import base64

@st.cache(allow_output_mutation=True)
def get_base64_of_bin_file(bin_file):
    with open(bin_file, 'rb') as f:
        data = f.read()
    return base64.b64encode(data).decode()

def set_png_as_page_bg(png_file):
    bin_str = get_base64_of_bin_file(png_file) 
    page_bg_img = '''
    &lt;style&gt;
    .stApp {
    background-image: url("data:image/png;base64,%s");
    background-size: contain;
    background-repeat: no-repeat;
    background-attachment: scroll; # doesn't work
    }
    &lt;/style&gt;
    ''' % bin_str
    st.markdown(page_bg_img, unsafe_allow_html=True)
    return</code></pre>
</section>
<section id="streamlit-functionality-echo" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-echo">Streamlit Functionality: echo</h2>
<blockquote class="blockquote">
<p>Sometimes you want your Streamlit app to contain both your usual Streamlit graphic elements and the code that generated those elements. That’s where st.echo() comes in</p>
</blockquote>
<p>Easier to display this by an example:</p>
<p><img src="ghtop_images/streamlit_echo.png" class="img-fluid"></p>
<p>In the example above the right of the image is given below (st.columns is used, where the input for the function is found from the left column).</p>
<ul>
<li><code>st.echo</code> is used with the <code>with</code> statement.</li>
<li>everything within the <code>with</code> is printed to the screen and executed</li>
</ul>
<pre><code>with st.echo():
    # Everything inside this block will be both printed to the screen
    # and executed.

    def do_pd_replace(text, text_search, text_sub):
        col_name = "Start string"
        df = pd.DataFrame(data=[text], columns=[col_name])

        df["Final String"] = df[col_name].replace(
            text_search, text_sub, regex=True
        )

        st.dataframe(df)
        st.write(f"text_search = '{text_search}' and text_sub = '{text_sub}'")
        st.write(f"Input string = '{text}'")
        st.write(f"Output string = '{df['Final String'].values[0]}'")

    do_pd_replace(text, text_search, text_sub)
</code></pre>
</section>
<section id="streamlit-functionality-pages" class="level2">
<h2 class="anchored" data-anchor-id="streamlit-functionality-pages">Streamlit Functionality: pages</h2>
<p>By simply creating a folder called <code>pages</code> and putting other streamlit .py files in the folder they can then be accessed in the sidebar.</p>
<ul>
<li>A main file needs to be outside the pages folder</li>
<li>The .py files in pages behave as if they were outside the folder (i.e.&nbsp;when loading files/functions)</li>
</ul>
<p><img src="ghtop_images/streamlit_pages.png" class="img-fluid"></p>
</section>
<section id="example-streamlit-presentation" class="level2">
<h2 class="anchored" data-anchor-id="example-streamlit-presentation">Example Streamlit Presentation</h2>
<p><video src="ghtop_images/streamlit_present.webm" class="img-fluid" controls=""><a href="ghtop_images/streamlit_present.webm">Video</a></video></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>